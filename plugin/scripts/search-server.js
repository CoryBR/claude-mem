#!/usr/bin/env node
var xl=Object.create;var Ia=Object.defineProperty;var Rl=Object.getOwnPropertyDescriptor;var Pl=Object.getOwnPropertyNames;var Tl=Object.getPrototypeOf,Ol=Object.prototype.hasOwnProperty;var X=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),wl=(a,e)=>{for(var t in e)Ia(a,t,{get:e[t],enumerable:!0})},Il=(a,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Pl(e))!Ol.call(a,r)&&r!==t&&Ia(a,r,{get:()=>e[r],enumerable:!(s=Rl(e,r))||s.enumerable});return a};var Al=(a,e,t)=>(t=a!=null?xl(Tl(a)):{},Il(e||!a||!a.__esModule?Ia(t,"default",{value:a,enumerable:!0}):t,a));var yn=X((Gt,gn)=>{(function(a,e){typeof Gt=="object"&&typeof gn<"u"?e(Gt):typeof define=="function"&&define.amd?define(["exports"],e):e(a.URI=a.URI||{})})(Gt,function(a){"use strict";function e(){for(var h=arguments.length,f=Array(h),y=0;y<h;y++)f[y]=arguments[y];if(f.length>1){f[0]=f[0].slice(0,-1);for(var b=f.length-1,x=1;x<b;++x)f[x]=f[x].slice(1,-1);return f[b]=f[b].slice(1),f.join("")}else return f[0]}function t(h){return"(?:"+h+")"}function s(h){return h===void 0?"undefined":h===null?"null":Object.prototype.toString.call(h).split(" ").pop().split("]").shift().toLowerCase()}function r(h){return h.toUpperCase()}function n(h){return h!=null?h instanceof Array?h:typeof h.length!="number"||h.split||h.setInterval||h.call?[h]:Array.prototype.slice.call(h):[]}function o(h,f){var y=h;if(f)for(var b in f)y[b]=f[b];return y}function l(h){var f="[A-Za-z]",y="[\\x0D]",b="[0-9]",x="[\\x22]",L=e(b,"[A-Fa-f]"),G="[\\x0A]",ae="[\\x20]",ie=t(t("%[EFef]"+L+"%"+L+L+"%"+L+L)+"|"+t("%[89A-Fa-f]"+L+"%"+L+L)+"|"+t("%"+L+L)),Ee="[\\:\\/\\?\\#\\[\\]\\@]",te="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",pe=e(Ee,te),be=h?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",de=h?"[\\uE000-\\uF8FF]":"[]",ne=e(f,b,"[\\-\\.\\_\\~]",be),he=t(f+e(f,b,"[\\+\\-\\.]")+"*"),ce=t(t(ie+"|"+e(ne,te,"[\\:]"))+"*"),Ir=t(t("25[0-5]")+"|"+t("2[0-4]"+b)+"|"+t("1"+b+b)+"|"+t("[1-9]"+b)+"|"+b),je=t(t("25[0-5]")+"|"+t("2[0-4]"+b)+"|"+t("1"+b+b)+"|"+t("0?[1-9]"+b)+"|0?0?"+b),qe=t(je+"\\."+je+"\\."+je+"\\."+je),ue=t(L+"{1,4}"),Fe=t(t(ue+"\\:"+ue)+"|"+qe),Ue=t(t(ue+"\\:")+"{6}"+Fe),tr=t("\\:\\:"+t(ue+"\\:")+"{5}"+Fe),Ar=t(t(ue)+"?\\:\\:"+t(ue+"\\:")+"{4}"+Fe),ur=t(t(t(ue+"\\:")+"{0,1}"+ue)+"?\\:\\:"+t(ue+"\\:")+"{3}"+Fe),mt=t(t(t(ue+"\\:")+"{0,2}"+ue)+"?\\:\\:"+t(ue+"\\:")+"{2}"+Fe),Dt=t(t(t(ue+"\\:")+"{0,3}"+ue)+"?\\:\\:"+ue+"\\:"+Fe),$t=t(t(t(ue+"\\:")+"{0,4}"+ue)+"?\\:\\:"+Fe),Jr=t(t(t(ue+"\\:")+"{0,5}"+ue)+"?\\:\\:"+ue),Yr=t(t(t(ue+"\\:")+"{0,6}"+ue)+"?\\:\\:"),dr=t([Ue,tr,Ar,ur,mt,Dt,$t,Jr,Yr].join("|")),et=t(t(ne+"|"+ie)+"+"),Oa=t(dr+"\\%25"+et),Nr=t(dr+t("\\%25|\\%(?!"+L+"{2})")+et),vl=t("[vV]"+L+"+\\."+e(ne,te,"[\\:]")+"+"),gl=t("\\["+t(Nr+"|"+dr+"|"+vl)+"\\]"),Ls=t(t(ie+"|"+e(ne,te))+"*"),vt=t(gl+"|"+qe+"(?!"+Ls+")|"+Ls),gt=t(b+"*"),js=t(t(ce+"@")+"?"+vt+t("\\:"+gt)+"?"),yt=t(ie+"|"+e(ne,te,"[\\:\\@]")),yl=t(yt+"*"),Fs=t(yt+"+"),_l=t(t(ie+"|"+e(ne,te,"[\\@]"))+"+"),fr=t(t("\\/"+yl)+"*"),rt=t("\\/"+t(Fs+fr)+"?"),wa=t(_l+fr),Ct=t(Fs+fr),tt="(?!"+yt+")",$f=t(fr+"|"+rt+"|"+wa+"|"+Ct+"|"+tt),at=t(t(yt+"|"+e("[\\/\\?]",de))+"*"),_t=t(t(yt+"|[\\/\\?]")+"*"),Ms=t(t("\\/\\/"+js+fr)+"|"+rt+"|"+Ct+"|"+tt),El=t(he+"\\:"+Ms+t("\\?"+at)+"?"+t("\\#"+_t)+"?"),bl=t(t("\\/\\/"+js+fr)+"|"+rt+"|"+wa+"|"+tt),Sl=t(bl+t("\\?"+at)+"?"+t("\\#"+_t)+"?"),Cf=t(El+"|"+Sl),kf=t(he+"\\:"+Ms+t("\\?"+at)+"?"),Lf="^("+he+")\\:"+t(t("\\/\\/("+t("("+ce+")@")+"?("+vt+")"+t("\\:("+gt+")")+"?)")+"?("+fr+"|"+rt+"|"+Ct+"|"+tt+")")+t("\\?("+at+")")+"?"+t("\\#("+_t+")")+"?$",jf="^(){0}"+t(t("\\/\\/("+t("("+ce+")@")+"?("+vt+")"+t("\\:("+gt+")")+"?)")+"?("+fr+"|"+rt+"|"+wa+"|"+tt+")")+t("\\?("+at+")")+"?"+t("\\#("+_t+")")+"?$",Ff="^("+he+")\\:"+t(t("\\/\\/("+t("("+ce+")@")+"?("+vt+")"+t("\\:("+gt+")")+"?)")+"?("+fr+"|"+rt+"|"+Ct+"|"+tt+")")+t("\\?("+at+")")+"?$",Mf="^"+t("\\#("+_t+")")+"?$",qf="^"+t("("+ce+")@")+"?("+vt+")"+t("\\:("+gt+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",f,b,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",ne,te),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",ne,te),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",ne,te),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",ne,te),"g"),NOT_QUERY:new RegExp(e("[^\\%]",ne,te,"[\\:\\@\\/\\?]",de),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",ne,te,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",ne,te),"g"),UNRESERVED:new RegExp(ne,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",ne,pe),"g"),PCT_ENCODED:new RegExp(ie,"g"),IPV4ADDRESS:new RegExp("^("+qe+")$"),IPV6ADDRESS:new RegExp("^\\[?("+dr+")"+t(t("\\%25|\\%(?!"+L+"{2})")+"("+et+")")+"?\\]?$")}}var c=l(!1),u=l(!0),p=function(){function h(f,y){var b=[],x=!0,L=!1,G=void 0;try{for(var ae=f[Symbol.iterator](),ie;!(x=(ie=ae.next()).done)&&(b.push(ie.value),!(y&&b.length===y));x=!0);}catch(Ee){L=!0,G=Ee}finally{try{!x&&ae.return&&ae.return()}finally{if(L)throw G}}return b}return function(f,y){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return h(f,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(h){if(Array.isArray(h)){for(var f=0,y=Array(h.length);f<h.length;f++)y[f]=h[f];return y}else return Array.from(h)},E=2147483647,d=36,g=1,_=26,v=38,S=700,O=72,R=128,T="-",A=/^xn--/,N=/[^\0-\x7E]/,V=/[\x2E\u3002\uFF0E\uFF61]/g,q={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},D=d-g,U=Math.floor,M=String.fromCharCode;function j(h){throw new RangeError(q[h])}function I(h,f){for(var y=[],b=h.length;b--;)y[b]=f(h[b]);return y}function $(h,f){var y=h.split("@"),b="";y.length>1&&(b=y[0]+"@",h=y[1]),h=h.replace(V,".");var x=h.split("."),L=I(x,f).join(".");return b+L}function F(h){for(var f=[],y=0,b=h.length;y<b;){var x=h.charCodeAt(y++);if(x>=55296&&x<=56319&&y<b){var L=h.charCodeAt(y++);(L&64512)==56320?f.push(((x&1023)<<10)+(L&1023)+65536):(f.push(x),y--)}else f.push(x)}return f}var le=function(f){return String.fromCodePoint.apply(String,m(f))},J=function(f){return f-48<10?f-22:f-65<26?f-65:f-97<26?f-97:d},re=function(f,y){return f+22+75*(f<26)-((y!=0)<<5)},K=function(f,y,b){var x=0;for(f=b?U(f/S):f>>1,f+=U(f/y);f>D*_>>1;x+=d)f=U(f/D);return U(x+(D+1)*f/(f+v))},H=function(f){var y=[],b=f.length,x=0,L=R,G=O,ae=f.lastIndexOf(T);ae<0&&(ae=0);for(var ie=0;ie<ae;++ie)f.charCodeAt(ie)>=128&&j("not-basic"),y.push(f.charCodeAt(ie));for(var Ee=ae>0?ae+1:0;Ee<b;){for(var te=x,pe=1,be=d;;be+=d){Ee>=b&&j("invalid-input");var de=J(f.charCodeAt(Ee++));(de>=d||de>U((E-x)/pe))&&j("overflow"),x+=de*pe;var ne=be<=G?g:be>=G+_?_:be-G;if(de<ne)break;var he=d-ne;pe>U(E/he)&&j("overflow"),pe*=he}var ce=y.length+1;G=K(x-te,ce,te==0),U(x/ce)>E-L&&j("overflow"),L+=U(x/ce),x%=ce,y.splice(x++,0,L)}return String.fromCodePoint.apply(String,y)},me=function(f){var y=[];f=F(f);var b=f.length,x=R,L=0,G=O,ae=!0,ie=!1,Ee=void 0;try{for(var te=f[Symbol.iterator](),pe;!(ae=(pe=te.next()).done);ae=!0){var be=pe.value;be<128&&y.push(M(be))}}catch(Nr){ie=!0,Ee=Nr}finally{try{!ae&&te.return&&te.return()}finally{if(ie)throw Ee}}var de=y.length,ne=de;for(de&&y.push(T);ne<b;){var he=E,ce=!0,Ir=!1,je=void 0;try{for(var qe=f[Symbol.iterator](),ue;!(ce=(ue=qe.next()).done);ce=!0){var Fe=ue.value;Fe>=x&&Fe<he&&(he=Fe)}}catch(Nr){Ir=!0,je=Nr}finally{try{!ce&&qe.return&&qe.return()}finally{if(Ir)throw je}}var Ue=ne+1;he-x>U((E-L)/Ue)&&j("overflow"),L+=(he-x)*Ue,x=he;var tr=!0,Ar=!1,ur=void 0;try{for(var mt=f[Symbol.iterator](),Dt;!(tr=(Dt=mt.next()).done);tr=!0){var $t=Dt.value;if($t<x&&++L>E&&j("overflow"),$t==x){for(var Jr=L,Yr=d;;Yr+=d){var dr=Yr<=G?g:Yr>=G+_?_:Yr-G;if(Jr<dr)break;var et=Jr-dr,Oa=d-dr;y.push(M(re(dr+et%Oa,0))),Jr=U(et/Oa)}y.push(M(re(Jr,0))),G=K(L,Ue,ne==de),L=0,++ne}}}catch(Nr){Ar=!0,ur=Nr}finally{try{!tr&&mt.return&&mt.return()}finally{if(Ar)throw ur}}++L,++x}return y.join("")},Pe=function(f){return $(f,function(y){return A.test(y)?H(y.slice(4).toLowerCase()):y})},we=function(f){return $(f,function(y){return N.test(y)?"xn--"+me(y):y})},se={version:"2.1.0",ucs2:{decode:F,encode:le},decode:H,encode:me,toASCII:we,toUnicode:Pe},ye={};function Se(h){var f=h.charCodeAt(0),y=void 0;return f<16?y="%0"+f.toString(16).toUpperCase():f<128?y="%"+f.toString(16).toUpperCase():f<2048?y="%"+(f>>6|192).toString(16).toUpperCase()+"%"+(f&63|128).toString(16).toUpperCase():y="%"+(f>>12|224).toString(16).toUpperCase()+"%"+(f>>6&63|128).toString(16).toUpperCase()+"%"+(f&63|128).toString(16).toUpperCase(),y}function Ie(h){for(var f="",y=0,b=h.length;y<b;){var x=parseInt(h.substr(y+1,2),16);if(x<128)f+=String.fromCharCode(x),y+=3;else if(x>=194&&x<224){if(b-y>=6){var L=parseInt(h.substr(y+4,2),16);f+=String.fromCharCode((x&31)<<6|L&63)}else f+=h.substr(y,6);y+=6}else if(x>=224){if(b-y>=9){var G=parseInt(h.substr(y+4,2),16),ae=parseInt(h.substr(y+7,2),16);f+=String.fromCharCode((x&15)<<12|(G&63)<<6|ae&63)}else f+=h.substr(y,9);y+=9}else f+=h.substr(y,3),y+=3}return f}function gr(h,f){function y(b){var x=Ie(b);return x.match(f.UNRESERVED)?x:b}return h.scheme&&(h.scheme=String(h.scheme).replace(f.PCT_ENCODED,y).toLowerCase().replace(f.NOT_SCHEME,"")),h.userinfo!==void 0&&(h.userinfo=String(h.userinfo).replace(f.PCT_ENCODED,y).replace(f.NOT_USERINFO,Se).replace(f.PCT_ENCODED,r)),h.host!==void 0&&(h.host=String(h.host).replace(f.PCT_ENCODED,y).toLowerCase().replace(f.NOT_HOST,Se).replace(f.PCT_ENCODED,r)),h.path!==void 0&&(h.path=String(h.path).replace(f.PCT_ENCODED,y).replace(h.scheme?f.NOT_PATH:f.NOT_PATH_NOSCHEME,Se).replace(f.PCT_ENCODED,r)),h.query!==void 0&&(h.query=String(h.query).replace(f.PCT_ENCODED,y).replace(f.NOT_QUERY,Se).replace(f.PCT_ENCODED,r)),h.fragment!==void 0&&(h.fragment=String(h.fragment).replace(f.PCT_ENCODED,y).replace(f.NOT_FRAGMENT,Se).replace(f.PCT_ENCODED,r)),h}function lr(h){return h.replace(/^0*(.*)/,"$1")||"0"}function _e(h,f){var y=h.match(f.IPV4ADDRESS)||[],b=p(y,2),x=b[1];return x?x.split(".").map(lr).join("."):h}function ve(h,f){var y=h.match(f.IPV6ADDRESS)||[],b=p(y,3),x=b[1],L=b[2];if(x){for(var G=x.toLowerCase().split("::").reverse(),ae=p(G,2),ie=ae[0],Ee=ae[1],te=Ee?Ee.split(":").map(lr):[],pe=ie.split(":").map(lr),be=f.IPV4ADDRESS.test(pe[pe.length-1]),de=be?7:8,ne=pe.length-de,he=Array(de),ce=0;ce<de;++ce)he[ce]=te[ce]||pe[ne+ce]||"";be&&(he[de-1]=_e(he[de-1],f));var Ir=he.reduce(function(Ue,tr,Ar){if(!tr||tr==="0"){var ur=Ue[Ue.length-1];ur&&ur.index+ur.length===Ar?ur.length++:Ue.push({index:Ar,length:1})}return Ue},[]),je=Ir.sort(function(Ue,tr){return tr.length-Ue.length})[0],qe=void 0;if(je&&je.length>1){var ue=he.slice(0,je.index),Fe=he.slice(je.index+je.length);qe=ue.join(":")+"::"+Fe.join(":")}else qe=he.join(":");return L&&(qe+="%"+L),qe}else return h}var Tr=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Te="".match(/(){0}/)[1]===void 0;function oe(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y={},b=f.iri!==!1?u:c;f.reference==="suffix"&&(h=(f.scheme?f.scheme+":":"")+"//"+h);var x=h.match(Tr);if(x){Te?(y.scheme=x[1],y.userinfo=x[3],y.host=x[4],y.port=parseInt(x[5],10),y.path=x[6]||"",y.query=x[7],y.fragment=x[8],isNaN(y.port)&&(y.port=x[5])):(y.scheme=x[1]||void 0,y.userinfo=h.indexOf("@")!==-1?x[3]:void 0,y.host=h.indexOf("//")!==-1?x[4]:void 0,y.port=parseInt(x[5],10),y.path=x[6]||"",y.query=h.indexOf("?")!==-1?x[7]:void 0,y.fragment=h.indexOf("#")!==-1?x[8]:void 0,isNaN(y.port)&&(y.port=h.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?x[4]:void 0)),y.host&&(y.host=ve(_e(y.host,b),b)),y.scheme===void 0&&y.userinfo===void 0&&y.host===void 0&&y.port===void 0&&!y.path&&y.query===void 0?y.reference="same-document":y.scheme===void 0?y.reference="relative":y.fragment===void 0?y.reference="absolute":y.reference="uri",f.reference&&f.reference!=="suffix"&&f.reference!==y.reference&&(y.error=y.error||"URI is not a "+f.reference+" reference.");var L=ye[(f.scheme||y.scheme||"").toLowerCase()];if(!f.unicodeSupport&&(!L||!L.unicodeSupport)){if(y.host&&(f.domainHost||L&&L.domainHost))try{y.host=se.toASCII(y.host.replace(b.PCT_ENCODED,Ie).toLowerCase())}catch(G){y.error=y.error||"Host's domain name can not be converted to ASCII via punycode: "+G}gr(y,c)}else gr(y,b);L&&L.parse&&L.parse(y,f)}else y.error=y.error||"URI can not be parsed.";return y}function yr(h,f){var y=f.iri!==!1?u:c,b=[];return h.userinfo!==void 0&&(b.push(h.userinfo),b.push("@")),h.host!==void 0&&b.push(ve(_e(String(h.host),y),y).replace(y.IPV6ADDRESS,function(x,L,G){return"["+L+(G?"%25"+G:"")+"]"})),(typeof h.port=="number"||typeof h.port=="string")&&(b.push(":"),b.push(String(h.port))),b.length?b.join(""):void 0}var cr=/^\.\.?\//,Or=/^\/\.(\/|$)/,wr=/^\/\.\.(\/|$)/,xe=/^\/?(?:.|\n)*?(?=\/|$)/;function Me(h){for(var f=[];h.length;)if(h.match(cr))h=h.replace(cr,"");else if(h.match(Or))h=h.replace(Or,"/");else if(h.match(wr))h=h.replace(wr,"/"),f.pop();else if(h==="."||h==="..")h="";else{var y=h.match(xe);if(y){var b=y[0];h=h.slice(b.length),f.push(b)}else throw new Error("Unexpected dot segment condition")}return f.join("")}function De(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=f.iri?u:c,b=[],x=ye[(f.scheme||h.scheme||"").toLowerCase()];if(x&&x.serialize&&x.serialize(h,f),h.host&&!y.IPV6ADDRESS.test(h.host)){if(f.domainHost||x&&x.domainHost)try{h.host=f.iri?se.toUnicode(h.host):se.toASCII(h.host.replace(y.PCT_ENCODED,Ie).toLowerCase())}catch(ae){h.error=h.error||"Host's domain name can not be converted to "+(f.iri?"Unicode":"ASCII")+" via punycode: "+ae}}gr(h,y),f.reference!=="suffix"&&h.scheme&&(b.push(h.scheme),b.push(":"));var L=yr(h,f);if(L!==void 0&&(f.reference!=="suffix"&&b.push("//"),b.push(L),h.path&&h.path.charAt(0)!=="/"&&b.push("/")),h.path!==void 0){var G=h.path;!f.absolutePath&&(!x||!x.absolutePath)&&(G=Me(G)),L===void 0&&(G=G.replace(/^\/\//,"/%2F")),b.push(G)}return h.query!==void 0&&(b.push("?"),b.push(h.query)),h.fragment!==void 0&&(b.push("#"),b.push(h.fragment)),b.join("")}function Ae(h,f){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments[3],x={};return b||(h=oe(De(h,y),y),f=oe(De(f,y),y)),y=y||{},!y.tolerant&&f.scheme?(x.scheme=f.scheme,x.userinfo=f.userinfo,x.host=f.host,x.port=f.port,x.path=Me(f.path||""),x.query=f.query):(f.userinfo!==void 0||f.host!==void 0||f.port!==void 0?(x.userinfo=f.userinfo,x.host=f.host,x.port=f.port,x.path=Me(f.path||""),x.query=f.query):(f.path?(f.path.charAt(0)==="/"?x.path=Me(f.path):((h.userinfo!==void 0||h.host!==void 0||h.port!==void 0)&&!h.path?x.path="/"+f.path:h.path?x.path=h.path.slice(0,h.path.lastIndexOf("/")+1)+f.path:x.path=f.path,x.path=Me(x.path)),x.query=f.query):(x.path=h.path,f.query!==void 0?x.query=f.query:x.query=h.query),x.userinfo=h.userinfo,x.host=h.host,x.port=h.port),x.scheme=h.scheme),x.fragment=f.fragment,x}function er(h,f,y){var b=o({scheme:"null"},y);return De(Ae(oe(h,b),oe(f,b),b,!0),b)}function Le(h,f){return typeof h=="string"?h=De(oe(h,f),f):s(h)==="object"&&(h=oe(De(h,f),f)),h}function Nt(h,f,y){return typeof h=="string"?h=De(oe(h,y),y):s(h)==="object"&&(h=De(h,y)),typeof f=="string"?f=De(oe(f,y),y):s(f)==="object"&&(f=De(f,y)),h===f}function Pa(h,f){return h&&h.toString().replace(!f||!f.iri?c.ESCAPE:u.ESCAPE,Se)}function Xe(h,f){return h&&h.toString().replace(!f||!f.iri?c.PCT_ENCODED:u.PCT_ENCODED,Ie)}var pt={scheme:"http",domainHost:!0,parse:function(f,y){return f.host||(f.error=f.error||"HTTP URIs must have a host."),f},serialize:function(f,y){var b=String(f.scheme).toLowerCase()==="https";return(f.port===(b?443:80)||f.port==="")&&(f.port=void 0),f.path||(f.path="/"),f}},ws={scheme:"https",domainHost:pt.domainHost,parse:pt.parse,serialize:pt.serialize};function Is(h){return typeof h.secure=="boolean"?h.secure:String(h.scheme).toLowerCase()==="wss"}var ht={scheme:"ws",domainHost:!0,parse:function(f,y){var b=f;return b.secure=Is(b),b.resourceName=(b.path||"/")+(b.query?"?"+b.query:""),b.path=void 0,b.query=void 0,b},serialize:function(f,y){if((f.port===(Is(f)?443:80)||f.port==="")&&(f.port=void 0),typeof f.secure=="boolean"&&(f.scheme=f.secure?"wss":"ws",f.secure=void 0),f.resourceName){var b=f.resourceName.split("?"),x=p(b,2),L=x[0],G=x[1];f.path=L&&L!=="/"?L:void 0,f.query=G,f.resourceName=void 0}return f.fragment=void 0,f}},As={scheme:"wss",domainHost:ht.domainHost,parse:ht.parse,serialize:ht.serialize},sl={},nl=!0,Ns="[A-Za-z0-9\\-\\.\\_\\~"+(nl?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",rr="[0-9A-Fa-f]",ol=t(t("%[EFef]"+rr+"%"+rr+rr+"%"+rr+rr)+"|"+t("%[89A-Fa-f]"+rr+"%"+rr+rr)+"|"+t("%"+rr+rr)),il="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",ll="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",cl=e(ll,'[\\"\\\\]'),ul="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",dl=new RegExp(Ns,"g"),Kr=new RegExp(ol,"g"),fl=new RegExp(e("[^]",il,"[\\.]",'[\\"]',cl),"g"),Ds=new RegExp(e("[^]",Ns,ul),"g"),pl=Ds;function Ta(h){var f=Ie(h);return f.match(dl)?f:h}var $s={scheme:"mailto",parse:function(f,y){var b=f,x=b.to=b.path?b.path.split(","):[];if(b.path=void 0,b.query){for(var L=!1,G={},ae=b.query.split("&"),ie=0,Ee=ae.length;ie<Ee;++ie){var te=ae[ie].split("=");switch(te[0]){case"to":for(var pe=te[1].split(","),be=0,de=pe.length;be<de;++be)x.push(pe[be]);break;case"subject":b.subject=Xe(te[1],y);break;case"body":b.body=Xe(te[1],y);break;default:L=!0,G[Xe(te[0],y)]=Xe(te[1],y);break}}L&&(b.headers=G)}b.query=void 0;for(var ne=0,he=x.length;ne<he;++ne){var ce=x[ne].split("@");if(ce[0]=Xe(ce[0]),y.unicodeSupport)ce[1]=Xe(ce[1],y).toLowerCase();else try{ce[1]=se.toASCII(Xe(ce[1],y).toLowerCase())}catch(Ir){b.error=b.error||"Email address's domain name can not be converted to ASCII via punycode: "+Ir}x[ne]=ce.join("@")}return b},serialize:function(f,y){var b=f,x=n(f.to);if(x){for(var L=0,G=x.length;L<G;++L){var ae=String(x[L]),ie=ae.lastIndexOf("@"),Ee=ae.slice(0,ie).replace(Kr,Ta).replace(Kr,r).replace(fl,Se),te=ae.slice(ie+1);try{te=y.iri?se.toUnicode(te):se.toASCII(Xe(te,y).toLowerCase())}catch(ne){b.error=b.error||"Email address's domain name can not be converted to "+(y.iri?"Unicode":"ASCII")+" via punycode: "+ne}x[L]=Ee+"@"+te}b.path=x.join(",")}var pe=f.headers=f.headers||{};f.subject&&(pe.subject=f.subject),f.body&&(pe.body=f.body);var be=[];for(var de in pe)pe[de]!==sl[de]&&be.push(de.replace(Kr,Ta).replace(Kr,r).replace(Ds,Se)+"="+pe[de].replace(Kr,Ta).replace(Kr,r).replace(pl,Se));return be.length&&(b.query=be.join("&")),b}},hl=/^([^\:]+)\:(.*)/,Cs={scheme:"urn",parse:function(f,y){var b=f.path&&f.path.match(hl),x=f;if(b){var L=y.scheme||x.scheme||"urn",G=b[1].toLowerCase(),ae=b[2],ie=L+":"+(y.nid||G),Ee=ye[ie];x.nid=G,x.nss=ae,x.path=void 0,Ee&&(x=Ee.parse(x,y))}else x.error=x.error||"URN can not be parsed.";return x},serialize:function(f,y){var b=y.scheme||f.scheme||"urn",x=f.nid,L=b+":"+(y.nid||x),G=ye[L];G&&(f=G.serialize(f,y));var ae=f,ie=f.nss;return ae.path=(x||y.nid)+":"+ie,ae}},ml=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ks={scheme:"urn:uuid",parse:function(f,y){var b=f;return b.uuid=b.nss,b.nss=void 0,!y.tolerant&&(!b.uuid||!b.uuid.match(ml))&&(b.error=b.error||"UUID is not valid."),b},serialize:function(f,y){var b=f;return b.nss=(f.uuid||"").toLowerCase(),b}};ye[pt.scheme]=pt,ye[ws.scheme]=ws,ye[ht.scheme]=ht,ye[As.scheme]=As,ye[$s.scheme]=$s,ye[Cs.scheme]=Cs,ye[ks.scheme]=ks,a.SCHEMES=ye,a.pctEncChar=Se,a.pctDecChars=Ie,a.parse=oe,a.removeDotSegments=Me,a.serialize=De,a.resolveComponents=Ae,a.resolve=er,a.normalize=Le,a.equal=Nt,a.escapeComponent=Pa,a.unescapeComponent=Xe,Object.defineProperty(a,"__esModule",{value:!0})})});var Wt=X((Pp,_n)=>{"use strict";_n.exports=function a(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var s,r,n;if(Array.isArray(e)){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!a(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(n=Object.keys(e),s=n.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(r=s;r--!==0;){var o=n[r];if(!a(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}});var bn=X((Tp,En)=>{"use strict";En.exports=function(e){for(var t=0,s=e.length,r=0,n;r<s;)t++,n=e.charCodeAt(r++),n>=55296&&n<=56319&&r<s&&(n=e.charCodeAt(r),(n&64512)==56320&&r++);return t}});var Qr=X((Op,Rn)=>{"use strict";Rn.exports={copy:ju,checkDataType:Xa,checkDataTypes:Fu,coerceToTypes:Mu,toHash:Ga,getProperty:Wa,escapeQuotes:Ka,equal:Wt(),ucs2length:bn(),varOccurences:zu,varReplace:Vu,schemaHasRules:Hu,schemaHasRulesExcept:Bu,schemaUnknownRules:Zu,toQuotedString:Qa,getPathExpr:Xu,getPath:Qu,getData:Ku,unescapeFragment:Ju,unescapeJsonPointer:Ya,escapeFragment:Yu,escapeJsonPointer:Ja};function ju(a,e){e=e||{};for(var t in a)e[t]=a[t];return e}function Xa(a,e,t,s){var r=s?" !== ":" === ",n=s?" || ":" && ",o=s?"!":"",l=s?"":"!";switch(a){case"null":return e+r+"null";case"array":return o+"Array.isArray("+e+")";case"object":return"("+o+e+n+"typeof "+e+r+'"object"'+n+l+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+r+'"number"'+n+l+"("+e+" % 1)"+n+e+r+e+(t?n+o+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+r+'"'+a+'"'+(t?n+o+"isFinite("+e+")":"")+")";default:return"typeof "+e+r+'"'+a+'"'}}function Fu(a,e,t){switch(a.length){case 1:return Xa(a[0],e,t,!0);default:var s="",r=Ga(a);r.array&&r.object&&(s=r.null?"(":"(!"+e+" || ",s+="typeof "+e+' !== "object")',delete r.null,delete r.array,delete r.object),r.number&&delete r.integer;for(var n in r)s+=(s?" && ":"")+Xa(n,e,t,!0);return s}}var Sn=Ga(["string","number","integer","boolean","null"]);function Mu(a,e){if(Array.isArray(e)){for(var t=[],s=0;s<e.length;s++){var r=e[s];(Sn[r]||a==="array"&&r==="array")&&(t[t.length]=r)}if(t.length)return t}else{if(Sn[e])return[e];if(a==="array"&&e==="array")return["array"]}}function Ga(a){for(var e={},t=0;t<a.length;t++)e[a[t]]=!0;return e}var qu=/^[a-z$_][a-z$_0-9]*$/i,Uu=/'|\\/g;function Wa(a){return typeof a=="number"?"["+a+"]":qu.test(a)?"."+a:"['"+Ka(a)+"']"}function Ka(a){return a.replace(Uu,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function zu(a,e){e+="[^0-9]";var t=a.match(new RegExp(e,"g"));return t?t.length:0}function Vu(a,e,t){return e+="([^0-9])",t=t.replace(/\$/g,"$$$$"),a.replace(new RegExp(e,"g"),t+"$1")}function Hu(a,e){if(typeof a=="boolean")return!a;for(var t in a)if(e[t])return!0}function Bu(a,e,t){if(typeof a=="boolean")return!a&&t!="not";for(var s in a)if(s!=t&&e[s])return!0}function Zu(a,e){if(typeof a!="boolean"){for(var t in a)if(!e[t])return t}}function Qa(a){return"'"+Ka(a)+"'"}function Xu(a,e,t,s){var r=t?"'/' + "+e+(s?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):s?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return xn(a,r)}function Qu(a,e,t){var s=Qa(t?"/"+Ja(e):Wa(e));return xn(a,s)}var Gu=/^\/(?:[^~]|~0|~1)*$/,Wu=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Ku(a,e,t){var s,r,n,o;if(a==="")return"rootData";if(a[0]=="/"){if(!Gu.test(a))throw new Error("Invalid JSON-pointer: "+a);r=a,n="rootData"}else{if(o=a.match(Wu),!o)throw new Error("Invalid JSON-pointer: "+a);if(s=+o[1],r=o[2],r=="#"){if(s>=e)throw new Error("Cannot access property/index "+s+" levels up, current level is "+e);return t[e-s]}if(s>e)throw new Error("Cannot access data "+s+" levels up, current level is "+e);if(n="data"+(e-s||""),!r)return n}for(var l=n,c=r.split("/"),u=0;u<c.length;u++){var p=c[u];p&&(n+=Wa(Ya(p)),l+=" && "+n)}return l}function xn(a,e){return a=='""'?e:(a+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function Ju(a){return Ya(decodeURIComponent(a))}function Yu(a){return encodeURIComponent(Ja(a))}function Ja(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}function Ya(a){return a.replace(/~1/g,"/").replace(/~0/g,"~")}});var es=X((wp,Pn)=>{"use strict";var ed=Qr();Pn.exports=rd;function rd(a){ed.copy(a,this)}});var On=X((Ip,Tn)=>{"use strict";var xr=Tn.exports=function(a,e,t){typeof e=="function"&&(t=e,e={}),t=e.cb||t;var s=typeof t=="function"?t:t.pre||function(){},r=t.post||function(){};Kt(e,s,r,a,"",a)};xr.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};xr.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};xr.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};xr.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Kt(a,e,t,s,r,n,o,l,c,u){if(s&&typeof s=="object"&&!Array.isArray(s)){e(s,r,n,o,l,c,u);for(var p in s){var m=s[p];if(Array.isArray(m)){if(p in xr.arrayKeywords)for(var E=0;E<m.length;E++)Kt(a,e,t,m[E],r+"/"+p+"/"+E,n,r,p,s,E)}else if(p in xr.propsKeywords){if(m&&typeof m=="object")for(var d in m)Kt(a,e,t,m[d],r+"/"+p+"/"+td(d),n,r,p,s,d)}else(p in xr.keywords||a.allKeys&&!(p in xr.skipKeywords))&&Kt(a,e,t,m,r+"/"+p,n,r,p,s)}t(s,r,n,o,l,c,u)}}function td(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}});var aa=X((Ap,Nn)=>{"use strict";var Ot=yn(),wn=Wt(),ra=Qr(),Jt=es(),ad=On();Nn.exports=Pr;Pr.normalizeId=Rr;Pr.fullPath=Yt;Pr.url=ea;Pr.ids=ld;Pr.inlineRef=rs;Pr.schema=ta;function Pr(a,e,t){var s=this._refs[t];if(typeof s=="string")if(this._refs[s])s=this._refs[s];else return Pr.call(this,a,e,s);if(s=s||this._schemas[t],s instanceof Jt)return rs(s.schema,this._opts.inlineRefs)?s.schema:s.validate||this._compile(s);var r=ta.call(this,e,t),n,o,l;return r&&(n=r.schema,e=r.root,l=r.baseId),n instanceof Jt?o=n.validate||a.call(this,n.schema,e,void 0,l):n!==void 0&&(o=rs(n,this._opts.inlineRefs)?n:a.call(this,n,e,void 0,l)),o}function ta(a,e){var t=Ot.parse(e),s=An(t),r=Yt(this._getId(a.schema));if(Object.keys(a.schema).length===0||s!==r){var n=Rr(s),o=this._refs[n];if(typeof o=="string")return sd.call(this,a,o,t);if(o instanceof Jt)o.validate||this._compile(o),a=o;else if(o=this._schemas[n],o instanceof Jt){if(o.validate||this._compile(o),n==Rr(e))return{schema:o,root:a,baseId:r};a=o}else return;if(!a.schema)return;r=Yt(this._getId(a.schema))}return In.call(this,t,r,a.schema,a)}function sd(a,e,t){var s=ta.call(this,a,e);if(s){var r=s.schema,n=s.baseId;a=s.root;var o=this._getId(r);return o&&(n=ea(n,o)),In.call(this,t,n,r,a)}}var nd=ra.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function In(a,e,t,s){if(a.fragment=a.fragment||"",a.fragment.slice(0,1)=="/"){for(var r=a.fragment.split("/"),n=1;n<r.length;n++){var o=r[n];if(o){if(o=ra.unescapeFragment(o),t=t[o],t===void 0)break;var l;if(!nd[o]&&(l=this._getId(t),l&&(e=ea(e,l)),t.$ref)){var c=ea(e,t.$ref),u=ta.call(this,s,c);u&&(t=u.schema,s=u.root,e=u.baseId)}}}if(t!==void 0&&t!==s.schema)return{schema:t,root:s,baseId:e}}}var od=ra.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function rs(a,e){if(e===!1)return!1;if(e===void 0||e===!0)return ts(a);if(e)return as(a)<=e}function ts(a){var e;if(Array.isArray(a)){for(var t=0;t<a.length;t++)if(e=a[t],typeof e=="object"&&!ts(e))return!1}else for(var s in a)if(s=="$ref"||(e=a[s],typeof e=="object"&&!ts(e)))return!1;return!0}function as(a){var e=0,t;if(Array.isArray(a)){for(var s=0;s<a.length;s++)if(t=a[s],typeof t=="object"&&(e+=as(t)),e==1/0)return 1/0}else for(var r in a){if(r=="$ref")return 1/0;if(od[r])e++;else if(t=a[r],typeof t=="object"&&(e+=as(t)+1),e==1/0)return 1/0}return e}function Yt(a,e){e!==!1&&(a=Rr(a));var t=Ot.parse(a);return An(t)}function An(a){return Ot.serialize(a).split("#")[0]+"#"}var id=/#\/?$/;function Rr(a){return a?a.replace(id,""):""}function ea(a,e){return e=Rr(e),Ot.resolve(a,e)}function ld(a){var e=Rr(this._getId(a)),t={"":e},s={"":Yt(e,!1)},r={},n=this;return ad(a,{allKeys:!0},function(o,l,c,u,p,m,E){if(l!==""){var d=n._getId(o),g=t[u],_=s[u]+"/"+p;if(E!==void 0&&(_+="/"+(typeof E=="number"?E:ra.escapeFragment(E))),typeof d=="string"){d=g=Rr(g?Ot.resolve(g,d):d);var v=n._refs[d];if(typeof v=="string"&&(v=n._refs[v]),v&&v.schema){if(!wn(o,v.schema))throw new Error('id "'+d+'" resolves to more than one schema')}else if(d!=Rr(_))if(d[0]=="#"){if(r[d]&&!wn(o,r[d]))throw new Error('id "'+d+'" resolves to more than one schema');r[d]=o}else n._refs[d]=_}t[l]=g,s[l]=_}}),r}});var sa=X((Np,$n)=>{"use strict";var ss=aa();$n.exports={Validation:Dn(cd),MissingRef:Dn(ns)};function cd(a){this.message="validation failed",this.errors=a,this.ajv=this.validation=!0}ns.message=function(a,e){return"can't resolve reference "+e+" from id "+a};function ns(a,e,t){this.message=t||ns.message(a,e),this.missingRef=ss.url(a,e),this.missingSchema=ss.normalizeId(ss.fullPath(this.missingRef))}function Dn(a){return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}});var os=X((Dp,Cn)=>{"use strict";Cn.exports=function(a,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var t=typeof e.cycles=="boolean"?e.cycles:!1,s=e.cmp&&function(n){return function(o){return function(l,c){var u={key:l,value:o[l]},p={key:c,value:o[c]};return n(u,p)}}}(e.cmp),r=[];return function n(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var l,c;if(Array.isArray(o)){for(c="[",l=0;l<o.length;l++)l&&(c+=","),c+=n(o[l])||"null";return c+"]"}if(o===null)return"null";if(r.indexOf(o)!==-1){if(t)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=r.push(o)-1,p=Object.keys(o).sort(s&&s(o));for(c="",l=0;l<p.length;l++){var m=p[l],E=n(o[m]);E&&(c&&(c+=","),c+=JSON.stringify(m)+":"+E)}return r.splice(u,1),"{"+c+"}"}}(a)}});var is=X(($p,kn)=>{"use strict";kn.exports=function(e,t,s){var r="",n=e.schema.$async===!0,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),l=e.self._getId(e.schema);if(e.opts.strictKeywords){var c=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(c){var u="unknown keyword: "+c;if(e.opts.strictKeywords==="log")e.logger.warn(u);else throw new Error(u)}}if(e.isTop&&(r+=" var validate = ",n&&(e.async=!0,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",l&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" "+("/*# sourceURL="+l+" */")+" ")),typeof e.schema=="boolean"||!(o||e.schema.$ref)){var t="false schema",p=e.level,m=e.dataLevel,E=e.schema[t],d=e.schemaPath+e.util.getProperty(t),g=e.errSchemaPath+"/"+t,A=!e.opts.allErrors,q,_="data"+(m||""),T="valid"+p;if(e.schema===!1){e.isTop?A=!0:r+=" var "+T+" = false; ";var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(q||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n?r+=" return data; ":r+=" validate.errors = null; return true; ":r+=" var "+T+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var O=e.isTop,p=e.level=0,m=e.dataLevel=0,_="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var R="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(R);else throw new Error(R)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{var p=e.level,m=e.dataLevel,_="data"+(m||"");if(l&&(e.baseId=e.resolve.url(e.baseId,l)),n&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+p+" = errors;"}var T="valid"+p,A=!e.opts.allErrors,N="",V="",q,D=e.schema.type,U=Array.isArray(D);if(D&&e.opts.nullable&&e.schema.nullable===!0&&(U?D.indexOf("null")==-1&&(D=D.concat("null")):D!="null"&&(D=[D,"null"],U=!0)),U&&D.length==1&&(D=D[0],U=!1),e.schema.$ref&&o){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),D){if(e.opts.coerceTypes)var M=e.util.coerceToTypes(e.opts.coerceTypes,D);var j=e.RULES.types[D];if(M||U||j===!0||j&&!xe(j)){var d=e.schemaPath+".type",g=e.errSchemaPath+"/type",d=e.schemaPath+".type",g=e.errSchemaPath+"/type",I=U?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[I](D,_,e.opts.strictNumbers,!0)+") { ",M){var $="dataType"+p,F="coerced"+p;r+=" var "+$+" = typeof "+_+"; var "+F+" = undefined; ",e.opts.coerceTypes=="array"&&(r+=" if ("+$+" == 'object' && Array.isArray("+_+") && "+_+".length == 1) { "+_+" = "+_+"[0]; "+$+" = typeof "+_+"; if ("+e.util.checkDataType(e.schema.type,_,e.opts.strictNumbers)+") "+F+" = "+_+"; } "),r+=" if ("+F+" !== undefined) ; ";var le=M;if(le)for(var J,re=-1,K=le.length-1;re<K;)J=le[re+=1],J=="string"?r+=" else if ("+$+" == 'number' || "+$+" == 'boolean') "+F+" = '' + "+_+"; else if ("+_+" === null) "+F+" = ''; ":J=="number"||J=="integer"?(r+=" else if ("+$+" == 'boolean' || "+_+" === null || ("+$+" == 'string' && "+_+" && "+_+" == +"+_+" ",J=="integer"&&(r+=" && !("+_+" % 1)"),r+=")) "+F+" = +"+_+"; "):J=="boolean"?r+=" else if ("+_+" === 'false' || "+_+" === 0 || "+_+" === null) "+F+" = false; else if ("+_+" === 'true' || "+_+" === 1) "+F+" = true; ":J=="null"?r+=" else if ("+_+" === '' || "+_+" === 0 || "+_+" === false) "+F+" = null; ":e.opts.coerceTypes=="array"&&J=="array"&&(r+=" else if ("+$+" == 'string' || "+$+" == 'number' || "+$+" == 'boolean' || "+_+" == null) "+F+" = ["+_+"]; ");r+=" else {   ";var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(q||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",U?r+=""+D.join(","):r+=""+D,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",U?r+=""+D.join(","):r+=""+D,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } if ("+F+" !== undefined) {  ";var H=m?"data"+(m-1||""):"parentData",me=m?e.dataPathArr[m]:"parentDataProperty";r+=" "+_+" = "+F+"; ",m||(r+="if ("+H+" !== undefined)"),r+=" "+H+"["+me+"] = "+F+"; } "}else{var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(q||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",U?r+=""+D.join(","):r+=""+D,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",U?r+=""+D.join(","):r+=""+D,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" } "}}if(e.schema.$ref&&!o)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",A&&(r+=" } if (errors === ",O?r+="0":r+="errs_"+p,r+=") { ",V+="}");else{var Pe=e.RULES;if(Pe){for(var j,we=-1,se=Pe.length-1;we<se;)if(j=Pe[we+=1],xe(j)){if(j.type&&(r+=" if ("+e.util.checkDataType(j.type,_,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(j.type=="object"&&e.schema.properties){var E=e.schema.properties,ye=Object.keys(E),Se=ye;if(Se)for(var Ie,gr=-1,lr=Se.length-1;gr<lr;){Ie=Se[gr+=1];var _e=E[Ie];if(_e.default!==void 0){var ve=_+e.util.getProperty(Ie);if(e.compositeRule){if(e.opts.strictDefaults){var R="default is ignored for: "+ve;if(e.opts.strictDefaults==="log")e.logger.warn(R);else throw new Error(R)}}else r+=" if ("+ve+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+ve+" === null || "+ve+" === '' "),r+=" ) "+ve+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(_e.default)+" ":r+=" "+JSON.stringify(_e.default)+" ",r+="; "}}}else if(j.type=="array"&&Array.isArray(e.schema.items)){var Tr=e.schema.items;if(Tr){for(var _e,re=-1,Te=Tr.length-1;re<Te;)if(_e=Tr[re+=1],_e.default!==void 0){var ve=_+"["+re+"]";if(e.compositeRule){if(e.opts.strictDefaults){var R="default is ignored for: "+ve;if(e.opts.strictDefaults==="log")e.logger.warn(R);else throw new Error(R)}}else r+=" if ("+ve+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+ve+" === null || "+ve+" === '' "),r+=" ) "+ve+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(_e.default)+" ":r+=" "+JSON.stringify(_e.default)+" ",r+="; "}}}}var oe=j.rules;if(oe){for(var yr,cr=-1,Or=oe.length-1;cr<Or;)if(yr=oe[cr+=1],Me(yr)){var wr=yr.code(e,yr.keyword,j.type);wr&&(r+=" "+wr+" ",A&&(N+="}"))}}if(A&&(r+=" "+N+" ",N=""),j.type&&(r+=" } ",D&&D===j.type&&!M)){r+=" else { ";var d=e.schemaPath+".type",g=e.errSchemaPath+"/type",v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(q||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",U?r+=""+D.join(","):r+=""+D,r+="' } ",e.opts.messages!==!1&&(r+=" , message: 'should be ",U?r+=""+D.join(","):r+=""+D,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&A?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}A&&(r+=" if (errors === ",O?r+="0":r+="errs_"+p,r+=") { ",V+="}")}}}A&&(r+=" "+V+" "),O?(n?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+T+" = errors === errs_"+p+";";function xe(Ae){for(var er=Ae.rules,Le=0;Le<er.length;Le++)if(Me(er[Le]))return!0}function Me(Ae){return e.schema[Ae.keyword]!==void 0||Ae.implements&&De(Ae)}function De(Ae){for(var er=Ae.implements,Le=0;Le<er.length;Le++)if(e.schema[er[Le]]!==void 0)return!0}return r}});var qn=X((Cp,Mn)=>{"use strict";var na=aa(),ia=Qr(),jn=sa(),ud=os(),Ln=is(),dd=ia.ucs2length,fd=Wt(),pd=jn.Validation;Mn.exports=ls;function ls(a,e,t,s){var r=this,n=this._opts,o=[void 0],l={},c=[],u={},p=[],m={},E=[];e=e||{schema:a,refVal:o,refs:l};var d=hd.call(this,a,e,s),g=this._compilations[d.index];if(d.compiling)return g.callValidate=R;var _=this._formats,v=this.RULES;try{var S=T(a,e,t,s);g.validate=S;var O=g.callValidate;return O&&(O.schema=S.schema,O.errors=null,O.refs=S.refs,O.refVal=S.refVal,O.root=S.root,O.$async=S.$async,n.sourceCode&&(O.source=S.source)),S}finally{md.call(this,a,e,s)}function R(){var I=g.validate,$=I.apply(this,arguments);return R.errors=I.errors,$}function T(I,$,F,le){var J=!$||$&&$.schema==I;if($.schema!=e.schema)return ls.call(r,I,$,F,le);var re=I.$async===!0,K=Ln({isTop:!0,schema:I,isRoot:J,baseId:le,root:$,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:jn.MissingRef,RULES:v,validate:Ln,util:ia,resolve:na,resolveRef:A,usePattern:U,useDefault:M,useCustomRule:j,opts:n,formats:_,logger:r.logger,self:r});K=oa(o,yd)+oa(c,vd)+oa(p,gd)+oa(E,_d)+K,n.processCode&&(K=n.processCode(K,I));var H;try{var me=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",K);H=me(r,v,_,e,o,p,E,fd,dd,pd),o[0]=H}catch(Pe){throw r.logger.error("Error compiling schema, function code:",K),Pe}return H.schema=I,H.errors=null,H.refs=l,H.refVal=o,H.root=J?H:$,re&&(H.$async=!0),n.sourceCode===!0&&(H.source={code:K,patterns:c,defaults:p}),H}function A(I,$,F){$=na.url(I,$);var le=l[$],J,re;if(le!==void 0)return J=o[le],re="refVal["+le+"]",D(J,re);if(!F&&e.refs){var K=e.refs[$];if(K!==void 0)return J=e.refVal[K],re=N($,J),D(J,re)}re=N($);var H=na.call(r,T,e,$);if(H===void 0){var me=t&&t[$];me&&(H=na.inlineRef(me,n.inlineRefs)?me:ls.call(r,me,e,t,I))}if(H===void 0)V($);else return q($,H),D(H,re)}function N(I,$){var F=o.length;return o[F]=$,l[I]=F,"refVal"+F}function V(I){delete l[I]}function q(I,$){var F=l[I];o[F]=$}function D(I,$){return typeof I=="object"||typeof I=="boolean"?{code:$,schema:I,inline:!0}:{code:$,$async:I&&!!I.$async}}function U(I){var $=u[I];return $===void 0&&($=u[I]=c.length,c[$]=I),"pattern"+$}function M(I){switch(typeof I){case"boolean":case"number":return""+I;case"string":return ia.toQuotedString(I);case"object":if(I===null)return"null";var $=ud(I),F=m[$];return F===void 0&&(F=m[$]=p.length,p[F]=I),"default"+F}}function j(I,$,F,le){if(r._opts.validateSchema!==!1){var J=I.definition.dependencies;if(J&&!J.every(function(Se){return Object.prototype.hasOwnProperty.call(F,Se)}))throw new Error("parent schema must have all required keywords: "+J.join(","));var re=I.definition.validateSchema;if(re){var K=re($);if(!K){var H="keyword schema is invalid: "+r.errorsText(re.errors);if(r._opts.validateSchema=="log")r.logger.error(H);else throw new Error(H)}}}var me=I.definition.compile,Pe=I.definition.inline,we=I.definition.macro,se;if(me)se=me.call(r,$,F,le);else if(we)se=we.call(r,$,F,le),n.validateSchema!==!1&&r.validateSchema(se,!0);else if(Pe)se=Pe.call(r,le,I.keyword,$,F);else if(se=I.definition.validate,!se)return;if(se===void 0)throw new Error('custom keyword "'+I.keyword+'"failed to compile');var ye=E.length;return E[ye]=se,{code:"customRule"+ye,validate:se}}}function hd(a,e,t){var s=Fn.call(this,a,e,t);return s>=0?{index:s,compiling:!0}:(s=this._compilations.length,this._compilations[s]={schema:a,root:e,baseId:t},{index:s,compiling:!1})}function md(a,e,t){var s=Fn.call(this,a,e,t);s>=0&&this._compilations.splice(s,1)}function Fn(a,e,t){for(var s=0;s<this._compilations.length;s++){var r=this._compilations[s];if(r.schema==a&&r.root==e&&r.baseId==t)return s}return-1}function vd(a,e){return"var pattern"+a+" = new RegExp("+ia.toQuotedString(e[a])+");"}function gd(a){return"var default"+a+" = defaults["+a+"];"}function yd(a,e){return e[a]===void 0?"":"var refVal"+a+" = refVal["+a+"];"}function _d(a){return"var customRule"+a+" = customRules["+a+"];"}function oa(a,e){if(!a.length)return"";for(var t="",s=0;s<a.length;s++)t+=e(s,a);return t}});var zn=X((kp,Un)=>{"use strict";var la=Un.exports=function(){this._cache={}};la.prototype.put=function(e,t){this._cache[e]=t};la.prototype.get=function(e){return this._cache[e]};la.prototype.del=function(e){delete this._cache[e]};la.prototype.clear=function(){this._cache={}}});var eo=X((Lp,Yn)=>{"use strict";var Ed=Qr(),bd=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Sd=[0,31,28,31,30,31,30,31,31,30,31,30,31],xd=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,Vn=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,Rd=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Pd=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Hn=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,Bn=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,Zn=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Xn=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Qn=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,Gn=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;Yn.exports=ca;function ca(a){return a=a=="full"?"full":"fast",Ed.copy(ca[a])}ca.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":Hn,url:Bn,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:Vn,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Jn,uuid:Zn,"json-pointer":Xn,"json-pointer-uri-fragment":Qn,"relative-json-pointer":Gn};ca.full={date:Wn,time:Kn,"date-time":wd,uri:Ad,"uri-reference":Pd,"uri-template":Hn,url:Bn,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:Vn,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:Jn,uuid:Zn,"json-pointer":Xn,"json-pointer-uri-fragment":Qn,"relative-json-pointer":Gn};function Td(a){return a%4===0&&(a%100!==0||a%400===0)}function Wn(a){var e=a.match(bd);if(!e)return!1;var t=+e[1],s=+e[2],r=+e[3];return s>=1&&s<=12&&r>=1&&r<=(s==2&&Td(t)?29:Sd[s])}function Kn(a,e){var t=a.match(xd);if(!t)return!1;var s=t[1],r=t[2],n=t[3],o=t[5];return(s<=23&&r<=59&&n<=59||s==23&&r==59&&n==60)&&(!e||o)}var Od=/t|\s/i;function wd(a){var e=a.split(Od);return e.length==2&&Wn(e[0])&&Kn(e[1],!0)}var Id=/\/|:/;function Ad(a){return Id.test(a)&&Rd.test(a)}var Nd=/[^\\]\\Z/;function Jn(a){if(Nd.test(a))return!1;try{return new RegExp(a),!0}catch{return!1}}});var to=X((jp,ro)=>{"use strict";ro.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,p="data"+(o||""),m="valid"+n,E,d;if(l=="#"||l=="#/")e.isRoot?(E=e.async,d="validate"):(E=e.root.schema.$async===!0,d="root.refVal[0]");else{var g=e.resolveRef(e.baseId,l,e.isRoot);if(g===void 0){var _=e.MissingRefError.message(e.baseId,l);if(e.opts.missingRefs=="fail"){e.logger.error(_);var v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",e.opts.messages!==!1&&(r+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(r+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&u?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(r+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(_),u&&(r+=" if (true) { ");else throw new e.MissingRefError(e.baseId,l,_)}else if(g.inline){var O=e.util.copy(e);O.level++;var R="valid"+O.level;O.schema=g.schema,O.schemaPath="",O.errSchemaPath=l;var T=e.validate(O).replace(/validate\.schema/g,g.code);r+=" "+T+" ",u&&(r+=" if ("+R+") { ")}else E=g.$async===!0||e.async&&g.$async!==!1,d=g.code}if(d){var v=v||[];v.push(r),r="",e.opts.passContext?r+=" "+d+".call(this, ":r+=" "+d+"( ",r+=" "+p+", (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var A=o?"data"+(o-1||""):"parentData",N=o?e.dataPathArr[o]:"parentDataProperty";r+=" , "+A+" , "+N+", rootData)  ";var V=r;if(r=v.pop(),E){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(r+=" var "+m+"; "),r+=" try { await "+V+"; ",u&&(r+=" "+m+" = true; "),r+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(r+=" "+m+" = false; "),r+=" } ",u&&(r+=" if ("+m+") { ")}else r+=" if (!"+V+") { if (vErrors === null) vErrors = "+d+".errors; else vErrors = vErrors.concat("+d+".errors); errors = vErrors.length; } ",u&&(r+=" else { ")}return r}});var so=X((Fp,ao)=>{"use strict";ao.exports=function(e,t,s){var r=" ",n=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u=e.util.copy(e),p="";u.level++;var m="valid"+u.level,E=u.baseId,d=!0,g=n;if(g)for(var _,v=-1,S=g.length-1;v<S;)_=g[v+=1],(e.opts.strictKeywords?typeof _=="object"&&Object.keys(_).length>0||_===!1:e.util.schemaHasRules(_,e.RULES.all))&&(d=!1,u.schema=_,u.schemaPath=o+"["+v+"]",u.errSchemaPath=l+"/"+v,r+="  "+e.validate(u)+" ",u.baseId=E,c&&(r+=" if ("+m+") { ",p+="}"));return c&&(d?r+=" if (true) { ":r+=" "+p.slice(0,-1)+" "),r}});var oo=X((Mp,no)=>{"use strict";no.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d="errs__"+n,g=e.util.copy(e),_="";g.level++;var v="valid"+g.level,S=l.every(function(q){return e.opts.strictKeywords?typeof q=="object"&&Object.keys(q).length>0||q===!1:e.util.schemaHasRules(q,e.RULES.all)});if(S){var O=g.baseId;r+=" var "+d+" = errors; var "+E+" = false;  ";var R=e.compositeRule;e.compositeRule=g.compositeRule=!0;var T=l;if(T)for(var A,N=-1,V=T.length-1;N<V;)A=T[N+=1],g.schema=A,g.schemaPath=c+"["+N+"]",g.errSchemaPath=u+"/"+N,r+="  "+e.validate(g)+" ",g.baseId=O,r+=" "+E+" = "+E+" || "+v+"; if (!"+E+") { ",_+="}";e.compositeRule=g.compositeRule=R,r+=" "+_+" if (!"+E+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&p&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else p&&(r+=" if (true) { ");return r}});var lo=X((qp,io)=>{"use strict";io.exports=function(e,t,s){var r=" ",n=e.schema[t],o=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,c=e.util.toQuotedString(n);return e.opts.$comment===!0?r+=" console.log("+c+");":typeof e.opts.$comment=="function"&&(r+=" self._opts.$comment("+c+", "+e.util.toQuotedString(o)+", validate.root.schema);"),r}});var uo=X((Up,co)=>{"use strict";co.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d=e.opts.$data&&l&&l.$data,g;d?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",g="schema"+n):g=l,d||(r+=" var schema"+n+" = validate.schema"+c+";"),r+="var "+E+" = equal("+m+", schema"+n+"); if (!"+E+") {   ";var _=_||[];_.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var v=r;return r=_.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",p&&(r+=" else { "),r}});var po=X((zp,fo)=>{"use strict";fo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d="errs__"+n,g=e.util.copy(e),_="";g.level++;var v="valid"+g.level,S="i"+n,O=g.dataLevel=e.dataLevel+1,R="data"+O,T=e.baseId,A=e.opts.strictKeywords?typeof l=="object"&&Object.keys(l).length>0||l===!1:e.util.schemaHasRules(l,e.RULES.all);if(r+="var "+d+" = errors;var "+E+";",A){var N=e.compositeRule;e.compositeRule=g.compositeRule=!0,g.schema=l,g.schemaPath=c,g.errSchemaPath=u,r+=" var "+v+" = false; for (var "+S+" = 0; "+S+" < "+m+".length; "+S+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,S,e.opts.jsonPointers,!0);var V=m+"["+S+"]";g.dataPathArr[O]=S;var q=e.validate(g);g.baseId=T,e.util.varOccurences(q,R)<2?r+=" "+e.util.varReplace(q,R,V)+" ":r+=" var "+R+" = "+V+"; "+q+" ",r+=" if ("+v+") break; }  ",e.compositeRule=g.compositeRule=N,r+=" "+_+" if (!"+v+") {"}else r+=" if ("+m+".length == 0) {";var D=D||[];D.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var U=r;return r=D.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+U+"]); ":r+=" validate.errors = ["+U+"]; return false; ":r+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",A&&(r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r}});var mo=X((Vp,ho)=>{"use strict";ho.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="errs__"+n,d=e.util.copy(e),g="";d.level++;var _="valid"+d.level,v={},S={},O=e.opts.ownProperties;for(N in l)if(N!="__proto__"){var R=l[N],T=Array.isArray(R)?S:v;T[N]=R}r+="var "+E+" = errors;";var A=e.errorPath;r+="var missing"+n+";";for(var N in S)if(T=S[N],T.length){if(r+=" if ( "+m+e.util.getProperty(N)+" !== undefined ",O&&(r+=" && Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(N)+"') "),p){r+=" && ( ";var V=T;if(V)for(var q,D=-1,U=V.length-1;D<U;){q=V[D+=1],D&&(r+=" || ");var M=e.util.getProperty(q),j=m+M;r+=" ( ( "+j+" === undefined ",O&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(q)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?q:M)+") ) "}r+=")) {  ";var I="missing"+n,$="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(A,I,!0):A+" + "+I);var F=F||[];F.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(N)+"', missingProperty: '"+$+"', depsCount: "+T.length+", deps: '"+e.util.escapeQuotes(T.length==1?T[0]:T.join(", "))+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should have ",T.length==1?r+="property "+e.util.escapeQuotes(T[0]):r+="properties "+e.util.escapeQuotes(T.join(", ")),r+=" when property "+e.util.escapeQuotes(N)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var le=r;r=F.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+le+"]); ":r+=" validate.errors = ["+le+"]; return false; ":r+=" var err = "+le+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var J=T;if(J)for(var q,re=-1,K=J.length-1;re<K;){q=J[re+=1];var M=e.util.getProperty(q),$=e.util.escapeQuotes(q),j=m+M;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(A,q,e.opts.jsonPointers)),r+=" if ( "+j+" === undefined ",O&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(q)+"') "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(N)+"', missingProperty: '"+$+"', depsCount: "+T.length+", deps: '"+e.util.escapeQuotes(T.length==1?T[0]:T.join(", "))+"' } ",e.opts.messages!==!1&&(r+=" , message: 'should have ",T.length==1?r+="property "+e.util.escapeQuotes(T[0]):r+="properties "+e.util.escapeQuotes(T.join(", ")),r+=" when property "+e.util.escapeQuotes(N)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",p&&(g+="}",r+=" else { ")}e.errorPath=A;var H=d.baseId;for(var N in v){var R=v[N];(e.opts.strictKeywords?typeof R=="object"&&Object.keys(R).length>0||R===!1:e.util.schemaHasRules(R,e.RULES.all))&&(r+=" "+_+" = true; if ( "+m+e.util.getProperty(N)+" !== undefined ",O&&(r+=" && Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(N)+"') "),r+=") { ",d.schema=R,d.schemaPath=c+e.util.getProperty(N),d.errSchemaPath=u+"/"+e.util.escapeFragment(N),r+="  "+e.validate(d)+" ",d.baseId=H,r+=" }  ",p&&(r+=" if ("+_+") { ",g+="}"))}return p&&(r+="   "+g+" if ("+E+" == errors) {"),r}});var go=X((Hp,vo)=>{"use strict";vo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d=e.opts.$data&&l&&l.$data,g;d?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",g="schema"+n):g=l;var _="i"+n,v="schema"+n;d||(r+=" var "+v+" = validate.schema"+c+";"),r+="var "+E+";",d&&(r+=" if (schema"+n+" === undefined) "+E+" = true; else if (!Array.isArray(schema"+n+")) "+E+" = false; else {"),r+=""+E+" = false;for (var "+_+"=0; "+_+"<"+v+".length; "+_+"++) if (equal("+m+", "+v+"["+_+"])) { "+E+" = true; break; }",d&&(r+="  }  "),r+=" if (!"+E+") {   ";var S=S||[];S.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var O=r;return r=S.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+O+"]); ":r+=" validate.errors = ["+O+"]; return false; ":r+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",p&&(r+=" else { "),r}});var _o=X((Bp,yo)=>{"use strict";yo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||"");if(e.opts.format===!1)return p&&(r+=" if (true) { "),r;var E=e.opts.$data&&l&&l.$data,d;E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l;var g=e.opts.unknownFormats,_=Array.isArray(g);if(E){var v="format"+n,S="isObject"+n,O="formatType"+n;r+=" var "+v+" = formats["+d+"]; var "+S+" = typeof "+v+" == 'object' && !("+v+" instanceof RegExp) && "+v+".validate; var "+O+" = "+S+" && "+v+".type || 'string'; if ("+S+") { ",e.async&&(r+=" var async"+n+" = "+v+".async; "),r+=" "+v+" = "+v+".validate; } if (  ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),r+=" (",g!="ignore"&&(r+=" ("+d+" && !"+v+" ",_&&(r+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),r+=") || "),r+=" ("+v+" && "+O+" == '"+s+"' && !(typeof "+v+" == 'function' ? ",e.async?r+=" (async"+n+" ? await "+v+"("+m+") : "+v+"("+m+")) ":r+=" "+v+"("+m+") ",r+=" : "+v+".test("+m+"))))) {"}else{var v=e.formats[l];if(!v){if(g=="ignore")return e.logger.warn('unknown format "'+l+'" ignored in schema at path "'+e.errSchemaPath+'"'),p&&(r+=" if (true) { "),r;if(_&&g.indexOf(l)>=0)return p&&(r+=" if (true) { "),r;throw new Error('unknown format "'+l+'" is used in schema at path "'+e.errSchemaPath+'"')}var S=typeof v=="object"&&!(v instanceof RegExp)&&v.validate,O=S&&v.type||"string";if(S){var R=v.async===!0;v=v.validate}if(O!=s)return p&&(r+=" if (true) { "),r;if(R){if(!e.async)throw new Error("async format in sync schema");var T="formats"+e.util.getProperty(l)+".validate";r+=" if (!(await "+T+"("+m+"))) { "}else{r+=" if (! ";var T="formats"+e.util.getProperty(l);S&&(T+=".validate"),typeof v=="function"?r+=" "+T+"("+m+") ":r+=" "+T+".test("+m+") ",r+=") { "}}var A=A||[];A.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",E?r+=""+d:r+=""+e.util.toQuotedString(l),r+="  } ",e.opts.messages!==!1&&(r+=` , message: 'should match format "`,E?r+="' + "+d+" + '":r+=""+e.util.escapeQuotes(l),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+e.util.toQuotedString(l),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var N=r;return r=A.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+N+"]); ":r+=" validate.errors = ["+N+"]; return false; ":r+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",p&&(r+=" else { "),r}});var bo=X((Zp,Eo)=>{"use strict";Eo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d="errs__"+n,g=e.util.copy(e);g.level++;var _="valid"+g.level,v=e.schema.then,S=e.schema.else,O=v!==void 0&&(e.opts.strictKeywords?typeof v=="object"&&Object.keys(v).length>0||v===!1:e.util.schemaHasRules(v,e.RULES.all)),R=S!==void 0&&(e.opts.strictKeywords?typeof S=="object"&&Object.keys(S).length>0||S===!1:e.util.schemaHasRules(S,e.RULES.all)),T=g.baseId;if(O||R){var A;g.createErrors=!1,g.schema=l,g.schemaPath=c,g.errSchemaPath=u,r+=" var "+d+" = errors; var "+E+" = true;  ";var N=e.compositeRule;e.compositeRule=g.compositeRule=!0,r+="  "+e.validate(g)+" ",g.baseId=T,g.createErrors=!0,r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=g.compositeRule=N,O?(r+=" if ("+_+") {  ",g.schema=e.schema.then,g.schemaPath=e.schemaPath+".then",g.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(g)+" ",g.baseId=T,r+=" "+E+" = "+_+"; ",O&&R?(A="ifClause"+n,r+=" var "+A+" = 'then'; "):A="'then'",r+=" } ",R&&(r+=" else { ")):r+=" if (!"+_+") { ",R&&(g.schema=e.schema.else,g.schemaPath=e.schemaPath+".else",g.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(g)+" ",g.baseId=T,r+=" "+E+" = "+_+"; ",O&&R?(A="ifClause"+n,r+=" var "+A+" = 'else'; "):A="'else'",r+=" } "),r+=" if (!"+E+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+A+" } ",e.opts.messages!==!1&&(r+=` , message: 'should match "' + `+A+` + '" schema' `),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&p&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",p&&(r+=" else { ")}else p&&(r+=" if (true) { ");return r}});var xo=X((Xp,So)=>{"use strict";So.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d="errs__"+n,g=e.util.copy(e),_="";g.level++;var v="valid"+g.level,S="i"+n,O=g.dataLevel=e.dataLevel+1,R="data"+O,T=e.baseId;if(r+="var "+d+" = errors;var "+E+";",Array.isArray(l)){var A=e.schema.additionalItems;if(A===!1){r+=" "+E+" = "+m+".length <= "+l.length+"; ";var N=u;u=e.errSchemaPath+"/additionalItems",r+="  if (!"+E+") {   ";var V=V||[];V.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+l.length+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have more than "+l.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var q=r;r=V.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+q+"]); ":r+=" validate.errors = ["+q+"]; return false; ":r+=" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",u=N,p&&(_+="}",r+=" else { ")}var D=l;if(D){for(var U,M=-1,j=D.length-1;M<j;)if(U=D[M+=1],e.opts.strictKeywords?typeof U=="object"&&Object.keys(U).length>0||U===!1:e.util.schemaHasRules(U,e.RULES.all)){r+=" "+v+" = true; if ("+m+".length > "+M+") { ";var I=m+"["+M+"]";g.schema=U,g.schemaPath=c+"["+M+"]",g.errSchemaPath=u+"/"+M,g.errorPath=e.util.getPathExpr(e.errorPath,M,e.opts.jsonPointers,!0),g.dataPathArr[O]=M;var $=e.validate(g);g.baseId=T,e.util.varOccurences($,R)<2?r+=" "+e.util.varReplace($,R,I)+" ":r+=" var "+R+" = "+I+"; "+$+" ",r+=" }  ",p&&(r+=" if ("+v+") { ",_+="}")}}if(typeof A=="object"&&(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))){g.schema=A,g.schemaPath=e.schemaPath+".additionalItems",g.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+v+" = true; if ("+m+".length > "+l.length+") {  for (var "+S+" = "+l.length+"; "+S+" < "+m+".length; "+S+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,S,e.opts.jsonPointers,!0);var I=m+"["+S+"]";g.dataPathArr[O]=S;var $=e.validate(g);g.baseId=T,e.util.varOccurences($,R)<2?r+=" "+e.util.varReplace($,R,I)+" ":r+=" var "+R+" = "+I+"; "+$+" ",p&&(r+=" if (!"+v+") break; "),r+=" } }  ",p&&(r+=" if ("+v+") { ",_+="}")}}else if(e.opts.strictKeywords?typeof l=="object"&&Object.keys(l).length>0||l===!1:e.util.schemaHasRules(l,e.RULES.all)){g.schema=l,g.schemaPath=c,g.errSchemaPath=u,r+="  for (var "+S+" = 0; "+S+" < "+m+".length; "+S+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,S,e.opts.jsonPointers,!0);var I=m+"["+S+"]";g.dataPathArr[O]=S;var $=e.validate(g);g.baseId=T,e.util.varOccurences($,R)<2?r+=" "+e.util.varReplace($,R,I)+" ":r+=" var "+R+" = "+I+"; "+$+" ",p&&(r+=" if (!"+v+") break; "),r+=" }"}return p&&(r+=" "+_+" if ("+d+" == errors) {"),r}});var cs=X((Qp,Ro)=>{"use strict";Ro.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,T,m="data"+(o||""),E=e.opts.$data&&l&&l.$data,d;E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l;var g=t=="maximum",_=g?"exclusiveMaximum":"exclusiveMinimum",v=e.schema[_],S=e.opts.$data&&v&&v.$data,O=g?"<":">",R=g?">":"<",T=void 0;if(!(E||typeof l=="number"||l===void 0))throw new Error(t+" must be number");if(!(S||v===void 0||typeof v=="number"||typeof v=="boolean"))throw new Error(_+" must be number or boolean");if(S){var A=e.util.getData(v.$data,o,e.dataPathArr),N="exclusive"+n,V="exclType"+n,q="exclIsNumber"+n,D="op"+n,U="' + "+D+" + '";r+=" var schemaExcl"+n+" = "+A+"; ",A="schemaExcl"+n,r+=" var "+N+"; var "+V+" = typeof "+A+"; if ("+V+" != 'boolean' && "+V+" != 'undefined' && "+V+" != 'number') { ";var T=_,M=M||[];M.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(T||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: '"+_+" should be boolean' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var j=r;r=M.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+j+"]); ":r+=" validate.errors = ["+j+"]; return false; ":r+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" "+V+" == 'number' ? ( ("+N+" = "+d+" === undefined || "+A+" "+O+"= "+d+") ? "+m+" "+R+"= "+A+" : "+m+" "+R+" "+d+" ) : ( ("+N+" = "+A+" === true) ? "+m+" "+R+"= "+d+" : "+m+" "+R+" "+d+" ) || "+m+" !== "+m+") { var op"+n+" = "+N+" ? '"+O+"' : '"+O+"='; ",l===void 0&&(T=_,u=e.errSchemaPath+"/"+_,d=A,E=S)}else{var q=typeof v=="number",U=O;if(q&&E){var D="'"+U+"'";r+=" if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" ( "+d+" === undefined || "+v+" "+O+"= "+d+" ? "+m+" "+R+"= "+v+" : "+m+" "+R+" "+d+" ) || "+m+" !== "+m+") { "}else{q&&l===void 0?(N=!0,T=_,u=e.errSchemaPath+"/"+_,d=v,R+="="):(q&&(d=Math[g?"min":"max"](v,l)),v===(q?d:!0)?(N=!0,T=_,u=e.errSchemaPath+"/"+_,R+="="):(N=!1,U+="="));var D="'"+U+"'";r+=" if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" "+m+" "+R+" "+d+" || "+m+" !== "+m+") { "}}T=T||t;var M=M||[];M.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(T||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+D+", limit: "+d+", exclusive: "+N+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be "+U+" ",E?r+="' + "+d:r+=""+d+"'"),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+l,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var j=r;return r=M.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+j+"]); ":r+=" validate.errors = ["+j+"]; return false; ":r+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",p&&(r+=" else { "),r}});var us=X((Gp,Po)=>{"use strict";Po.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,_,m="data"+(o||""),E=e.opts.$data&&l&&l.$data,d;if(E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l,!(E||typeof l=="number"))throw new Error(t+" must be number");var g=t=="maxItems"?">":"<";r+="if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" "+m+".length "+g+" "+d+") { ";var _=t,v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(_||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have ",t=="maxItems"?r+="more":r+="fewer",r+=" than ",E?r+="' + "+d+" + '":r+=""+l,r+=" items' "),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+l,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",p&&(r+=" else { "),r}});var ds=X((Wp,To)=>{"use strict";To.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,_,m="data"+(o||""),E=e.opts.$data&&l&&l.$data,d;if(E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l,!(E||typeof l=="number"))throw new Error(t+" must be number");var g=t=="maxLength"?">":"<";r+="if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),e.opts.unicode===!1?r+=" "+m+".length ":r+=" ucs2length("+m+") ",r+=" "+g+" "+d+") { ";var _=t,v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(_||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be ",t=="maxLength"?r+="longer":r+="shorter",r+=" than ",E?r+="' + "+d+" + '":r+=""+l,r+=" characters' "),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+l,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",p&&(r+=" else { "),r}});var fs=X((Kp,Oo)=>{"use strict";Oo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,_,m="data"+(o||""),E=e.opts.$data&&l&&l.$data,d;if(E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l,!(E||typeof l=="number"))throw new Error(t+" must be number");var g=t=="maxProperties"?">":"<";r+="if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'number') || "),r+=" Object.keys("+m+").length "+g+" "+d+") { ";var _=t,v=v||[];v.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(_||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have ",t=="maxProperties"?r+="more":r+="fewer",r+=" than ",E?r+="' + "+d+" + '":r+=""+l,r+=" properties' "),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+l,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",p&&(r+=" else { "),r}});var Io=X((Jp,wo)=>{"use strict";wo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E=e.opts.$data&&l&&l.$data,d;if(E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l,!(E||typeof l=="number"))throw new Error(t+" must be number");r+="var division"+n+";if (",E&&(r+=" "+d+" !== undefined && ( typeof "+d+" != 'number' || "),r+=" (division"+n+" = "+m+" / "+d+", ",e.opts.multipleOfPrecision?r+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":r+=" division"+n+" !== parseInt(division"+n+") ",r+=" ) ",E&&(r+="  )  "),r+=" ) {   ";var g=g||[];g.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+d+" } ",e.opts.messages!==!1&&(r+=" , message: 'should be multiple of ",E?r+="' + "+d:r+=""+d+"'"),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+l,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var _=r;return r=g.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",p&&(r+=" else { "),r}});var No=X((Yp,Ao)=>{"use strict";Ao.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="errs__"+n,d=e.util.copy(e);d.level++;var g="valid"+d.level;if(e.opts.strictKeywords?typeof l=="object"&&Object.keys(l).length>0||l===!1:e.util.schemaHasRules(l,e.RULES.all)){d.schema=l,d.schemaPath=c,d.errSchemaPath=u,r+=" var "+E+" = errors;  ";var _=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1;var v;d.opts.allErrors&&(v=d.opts.allErrors,d.opts.allErrors=!1),r+=" "+e.validate(d)+" ",d.createErrors=!0,v&&(d.opts.allErrors=v),e.compositeRule=d.compositeRule=_,r+=" if ("+g+") {   ";var S=S||[];S.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var O=r;r=S.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+O+"]); ":r+=" validate.errors = ["+O+"]; return false; ":r+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+E+"; if (vErrors !== null) { if ("+E+") vErrors.length = "+E+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",p&&(r+=" if (false) { ");return r}});var $o=X((eh,Do)=>{"use strict";Do.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d="errs__"+n,g=e.util.copy(e),_="";g.level++;var v="valid"+g.level,S=g.baseId,O="prevValid"+n,R="passingSchemas"+n;r+="var "+d+" = errors , "+O+" = false , "+E+" = false , "+R+" = null; ";var T=e.compositeRule;e.compositeRule=g.compositeRule=!0;var A=l;if(A)for(var N,V=-1,q=A.length-1;V<q;)N=A[V+=1],(e.opts.strictKeywords?typeof N=="object"&&Object.keys(N).length>0||N===!1:e.util.schemaHasRules(N,e.RULES.all))?(g.schema=N,g.schemaPath=c+"["+V+"]",g.errSchemaPath=u+"/"+V,r+="  "+e.validate(g)+" ",g.baseId=S):r+=" var "+v+" = true; ",V&&(r+=" if ("+v+" && "+O+") { "+E+" = false; "+R+" = ["+R+", "+V+"]; } else { ",_+="}"),r+=" if ("+v+") { "+E+" = "+O+" = true; "+R+" = "+V+"; }";return e.compositeRule=g.compositeRule=T,r+=""+_+"if (!"+E+") {   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+R+" } ",e.opts.messages!==!1&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&p&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}});var ko=X((rh,Co)=>{"use strict";Co.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E=e.opts.$data&&l&&l.$data,d;E?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=l;var g=E?"(new RegExp("+d+"))":e.usePattern(l);r+="if ( ",E&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),r+=" !"+g+".test("+m+") ) {   ";var _=_||[];_.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",E?r+=""+d:r+=""+e.util.toQuotedString(l),r+="  } ",e.opts.messages!==!1&&(r+=` , message: 'should match pattern "`,E?r+="' + "+d+" + '":r+=""+e.util.escapeQuotes(l),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",E?r+="validate.schema"+c:r+=""+e.util.toQuotedString(l),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var v=r;return r=_.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",p&&(r+=" else { "),r}});var jo=X((th,Lo)=>{"use strict";Lo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="errs__"+n,d=e.util.copy(e),g="";d.level++;var _="valid"+d.level,v="key"+n,S="idx"+n,O=d.dataLevel=e.dataLevel+1,R="data"+O,T="dataProperties"+n,A=Object.keys(l||{}).filter(re),N=e.schema.patternProperties||{},V=Object.keys(N).filter(re),q=e.schema.additionalProperties,D=A.length||V.length,U=q===!1,M=typeof q=="object"&&Object.keys(q).length,j=e.opts.removeAdditional,I=U||M||j,$=e.opts.ownProperties,F=e.baseId,le=e.schema.required;if(le&&!(e.opts.$data&&le.$data)&&le.length<e.opts.loopRequired)var J=e.util.toHash(le);function re(Xe){return Xe!=="__proto__"}if(r+="var "+E+" = errors;var "+_+" = true;",$&&(r+=" var "+T+" = undefined;"),I){if($?r+=" "+T+" = "+T+" || Object.keys("+m+"); for (var "+S+"=0; "+S+"<"+T+".length; "+S+"++) { var "+v+" = "+T+"["+S+"]; ":r+=" for (var "+v+" in "+m+") { ",D){if(r+=" var isAdditional"+n+" = !(false ",A.length)if(A.length>8)r+=" || validate.schema"+c+".hasOwnProperty("+v+") ";else{var K=A;if(K)for(var H,me=-1,Pe=K.length-1;me<Pe;)H=K[me+=1],r+=" || "+v+" == "+e.util.toQuotedString(H)+" "}if(V.length){var we=V;if(we)for(var se,ye=-1,Se=we.length-1;ye<Se;)se=we[ye+=1],r+=" || "+e.usePattern(se)+".test("+v+") "}r+=" ); if (isAdditional"+n+") { "}if(j=="all")r+=" delete "+m+"["+v+"]; ";else{var Ie=e.errorPath,gr="' + "+v+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers)),U)if(j)r+=" delete "+m+"["+v+"]; ";else{r+=" "+_+" = false; ";var lr=u;u=e.errSchemaPath+"/additionalProperties";var _e=_e||[];_e.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+gr+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var ve=r;r=_e.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+ve+"]); ":r+=" validate.errors = ["+ve+"]; return false; ":r+=" var err = "+ve+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=lr,p&&(r+=" break; ")}else if(M)if(j=="failing"){r+=" var "+E+" = errors;  ";var Tr=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=q,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Te=m+"["+v+"]";d.dataPathArr[O]=v;var oe=e.validate(d);d.baseId=F,e.util.varOccurences(oe,R)<2?r+=" "+e.util.varReplace(oe,R,Te)+" ":r+=" var "+R+" = "+Te+"; "+oe+" ",r+=" if (!"+_+") { errors = "+E+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+m+"["+v+"]; }  ",e.compositeRule=d.compositeRule=Tr}else{d.schema=q,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Te=m+"["+v+"]";d.dataPathArr[O]=v;var oe=e.validate(d);d.baseId=F,e.util.varOccurences(oe,R)<2?r+=" "+e.util.varReplace(oe,R,Te)+" ":r+=" var "+R+" = "+Te+"; "+oe+" ",p&&(r+=" if (!"+_+") break; ")}e.errorPath=Ie}D&&(r+=" } "),r+=" }  ",p&&(r+=" if ("+_+") { ",g+="}")}var yr=e.opts.useDefaults&&!e.compositeRule;if(A.length){var cr=A;if(cr)for(var H,Or=-1,wr=cr.length-1;Or<wr;){H=cr[Or+=1];var xe=l[H];if(e.opts.strictKeywords?typeof xe=="object"&&Object.keys(xe).length>0||xe===!1:e.util.schemaHasRules(xe,e.RULES.all)){var Me=e.util.getProperty(H),Te=m+Me,De=yr&&xe.default!==void 0;d.schema=xe,d.schemaPath=c+Me,d.errSchemaPath=u+"/"+e.util.escapeFragment(H),d.errorPath=e.util.getPath(e.errorPath,H,e.opts.jsonPointers),d.dataPathArr[O]=e.util.toQuotedString(H);var oe=e.validate(d);if(d.baseId=F,e.util.varOccurences(oe,R)<2){oe=e.util.varReplace(oe,R,Te);var Ae=Te}else{var Ae=R;r+=" var "+R+" = "+Te+"; "}if(De)r+=" "+oe+" ";else{if(J&&J[H]){r+=" if ( "+Ae+" === undefined ",$&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(H)+"') "),r+=") { "+_+" = false; ";var Ie=e.errorPath,lr=u,er=e.util.escapeQuotes(H);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(Ie,H,e.opts.jsonPointers)),u=e.errSchemaPath+"/required";var _e=_e||[];_e.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+er+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+er+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var ve=r;r=_e.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+ve+"]); ":r+=" validate.errors = ["+ve+"]; return false; ":r+=" var err = "+ve+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=lr,e.errorPath=Ie,r+=" } else { "}else p?(r+=" if ( "+Ae+" === undefined ",$&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(H)+"') "),r+=") { "+_+" = true; } else { "):(r+=" if ("+Ae+" !== undefined ",$&&(r+=" &&   Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(H)+"') "),r+=" ) { ");r+=" "+oe+" } "}}p&&(r+=" if ("+_+") { ",g+="}")}}if(V.length){var Le=V;if(Le)for(var se,Nt=-1,Pa=Le.length-1;Nt<Pa;){se=Le[Nt+=1];var xe=N[se];if(e.opts.strictKeywords?typeof xe=="object"&&Object.keys(xe).length>0||xe===!1:e.util.schemaHasRules(xe,e.RULES.all)){d.schema=xe,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(se),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(se),$?r+=" "+T+" = "+T+" || Object.keys("+m+"); for (var "+S+"=0; "+S+"<"+T+".length; "+S+"++) { var "+v+" = "+T+"["+S+"]; ":r+=" for (var "+v+" in "+m+") { ",r+=" if ("+e.usePattern(se)+".test("+v+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var Te=m+"["+v+"]";d.dataPathArr[O]=v;var oe=e.validate(d);d.baseId=F,e.util.varOccurences(oe,R)<2?r+=" "+e.util.varReplace(oe,R,Te)+" ":r+=" var "+R+" = "+Te+"; "+oe+" ",p&&(r+=" if (!"+_+") break; "),r+=" } ",p&&(r+=" else "+_+" = true; "),r+=" }  ",p&&(r+=" if ("+_+") { ",g+="}")}}}return p&&(r+=" "+g+" if ("+E+" == errors) {"),r}});var Mo=X((ah,Fo)=>{"use strict";Fo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="errs__"+n,d=e.util.copy(e),g="";d.level++;var _="valid"+d.level;if(r+="var "+E+" = errors;",e.opts.strictKeywords?typeof l=="object"&&Object.keys(l).length>0||l===!1:e.util.schemaHasRules(l,e.RULES.all)){d.schema=l,d.schemaPath=c,d.errSchemaPath=u;var v="key"+n,S="idx"+n,O="i"+n,R="' + "+v+" + '",T=d.dataLevel=e.dataLevel+1,A="data"+T,N="dataProperties"+n,V=e.opts.ownProperties,q=e.baseId;V&&(r+=" var "+N+" = undefined; "),V?r+=" "+N+" = "+N+" || Object.keys("+m+"); for (var "+S+"=0; "+S+"<"+N+".length; "+S+"++) { var "+v+" = "+N+"["+S+"]; ":r+=" for (var "+v+" in "+m+") { ",r+=" var startErrs"+n+" = errors; ";var D=v,U=e.compositeRule;e.compositeRule=d.compositeRule=!0;var M=e.validate(d);d.baseId=q,e.util.varOccurences(M,A)<2?r+=" "+e.util.varReplace(M,A,D)+" ":r+=" var "+A+" = "+D+"; "+M+" ",e.compositeRule=d.compositeRule=U,r+=" if (!"+_+") { for (var "+O+"=startErrs"+n+"; "+O+"<errors; "+O+"++) { vErrors["+O+"].propertyName = "+v+"; }   var err =   ",e.createErrors!==!1?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+R+"' } ",e.opts.messages!==!1&&(r+=" , message: 'property name \\'"+R+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&p&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),p&&(r+=" break; "),r+=" } }"}return p&&(r+=" "+g+" if ("+E+" == errors) {"),r}});var Uo=X((sh,qo)=>{"use strict";qo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d=e.opts.$data&&l&&l.$data,g;d?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",g="schema"+n):g=l;var _="schema"+n;if(!d)if(l.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var v=[],S=l;if(S)for(var O,R=-1,T=S.length-1;R<T;){O=S[R+=1];var A=e.schema.properties[O];A&&(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))||(v[v.length]=O)}}else var v=l;if(d||v.length){var N=e.errorPath,V=d||v.length>=e.opts.loopRequired,q=e.opts.ownProperties;if(p)if(r+=" var missing"+n+"; ",V){d||(r+=" var "+_+" = validate.schema"+c+"; ");var D="i"+n,U="schema"+n+"["+D+"]",M="' + "+U+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(N,U,e.opts.jsonPointers)),r+=" var "+E+" = true; ",d&&(r+=" if (schema"+n+" === undefined) "+E+" = true; else if (!Array.isArray(schema"+n+")) "+E+" = false; else {"),r+=" for (var "+D+" = 0; "+D+" < "+_+".length; "+D+"++) { "+E+" = "+m+"["+_+"["+D+"]] !== undefined ",q&&(r+=" &&   Object.prototype.hasOwnProperty.call("+m+", "+_+"["+D+"]) "),r+="; if (!"+E+") break; } ",d&&(r+="  }  "),r+="  if (!"+E+") {   ";var j=j||[];j.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+M+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var I=r;r=j.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+I+"]); ":r+=" validate.errors = ["+I+"]; return false; ":r+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var $=v;if($)for(var F,D=-1,le=$.length-1;D<le;){F=$[D+=1],D&&(r+=" || ");var J=e.util.getProperty(F),re=m+J;r+=" ( ( "+re+" === undefined ",q&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(F)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?F:J)+") ) "}r+=") {  ";var U="missing"+n,M="' + "+U+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(N,U,!0):N+" + "+U);var j=j||[];j.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+M+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var I=r;r=j.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+I+"]); ":r+=" validate.errors = ["+I+"]; return false; ":r+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(V){d||(r+=" var "+_+" = validate.schema"+c+"; ");var D="i"+n,U="schema"+n+"["+D+"]",M="' + "+U+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(N,U,e.opts.jsonPointers)),d&&(r+=" if ("+_+" && !Array.isArray("+_+")) {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+M+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+_+" !== undefined) { "),r+=" for (var "+D+" = 0; "+D+" < "+_+".length; "+D+"++) { if ("+m+"["+_+"["+D+"]] === undefined ",q&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", "+_+"["+D+"]) "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+M+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(r+="  }  ")}else{var K=v;if(K)for(var F,H=-1,me=K.length-1;H<me;){F=K[H+=1];var J=e.util.getProperty(F),M=e.util.escapeQuotes(F),re=m+J;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(N,F,e.opts.jsonPointers)),r+=" if ( "+re+" === undefined ",q&&(r+=" || ! Object.prototype.hasOwnProperty.call("+m+", '"+e.util.escapeQuotes(F)+"') "),r+=") {  var err =   ",e.createErrors!==!1?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+M+"' } ",e.opts.messages!==!1&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+M+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=N}else p&&(r+=" if (true) {");return r}});var Vo=X((nh,zo)=>{"use strict";zo.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m="data"+(o||""),E="valid"+n,d=e.opts.$data&&l&&l.$data,g;if(d?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",g="schema"+n):g=l,(l||d)&&e.opts.uniqueItems!==!1){d&&(r+=" var "+E+"; if ("+g+" === false || "+g+" === undefined) "+E+" = true; else if (typeof "+g+" != 'boolean') "+E+" = false; else { "),r+=" var i = "+m+".length , "+E+" = true , j; if (i > 1) { ";var _=e.schema.items&&e.schema.items.type,v=Array.isArray(_);if(!_||_=="object"||_=="array"||v&&(_.indexOf("object")>=0||_.indexOf("array")>=0))r+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+m+"[i], "+m+"[j])) { "+E+" = false; break outer; } } } ";else{r+=" var itemIndices = {}, item; for (;i--;) { var item = "+m+"[i]; ";var S="checkDataType"+(v?"s":"");r+=" if ("+e.util[S](_,"item",e.opts.strictNumbers,!0)+") continue; ",v&&(r+=` if (typeof item == 'string') item = '"' + item; `),r+=" if (typeof itemIndices[item] == 'number') { "+E+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}r+=" } ",d&&(r+="  }  "),r+=" if (!"+E+") {   ";var O=O||[];O.push(r),r="",e.createErrors!==!1?(r+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(r+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(r+=" , schema:  ",d?r+="validate.schema"+c:r+=""+l,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var R=r;r=O.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+R+"]); ":r+=" validate.errors = ["+R+"]; return false; ":r+=" var err = "+R+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",p&&(r+=" else { ")}else p&&(r+=" if (true) { ");return r}});var Bo=X((oh,Ho)=>{"use strict";Ho.exports={$ref:to(),allOf:so(),anyOf:oo(),$comment:lo(),const:uo(),contains:po(),dependencies:mo(),enum:go(),format:_o(),if:bo(),items:xo(),maximum:cs(),minimum:cs(),maxItems:us(),minItems:us(),maxLength:ds(),minLength:ds(),maxProperties:fs(),minProperties:fs(),multipleOf:Io(),not:No(),oneOf:$o(),pattern:ko(),properties:jo(),propertyNames:Mo(),required:Uo(),uniqueItems:Vo(),validate:is()}});var Qo=X((ih,Xo)=>{"use strict";var Zo=Bo(),ps=Qr().toHash;Xo.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"],s=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],r=["number","integer","string","array","object","boolean","null"];return e.all=ps(t),e.types=ps(r),e.forEach(function(n){n.rules=n.rules.map(function(o){var l;if(typeof o=="object"){var c=Object.keys(o)[0];l=o[c],o=c,l.forEach(function(p){t.push(p),e.all[p]=!0})}t.push(o);var u=e.all[o]={keyword:o,code:Zo[o],implements:l};return u}),e.all.$comment={keyword:"$comment",code:Zo.$comment},n.type&&(e.types[n.type]=n)}),e.keywords=ps(t.concat(s)),e.custom={},e}});var Ko=X((lh,Wo)=>{"use strict";var Go=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];Wo.exports=function(a,e){for(var t=0;t<e.length;t++){a=JSON.parse(JSON.stringify(a));var s=e[t].split("/"),r=a,n;for(n=1;n<s.length;n++)r=r[s[n]];for(n=0;n<Go.length;n++){var o=Go[n],l=r[o];l&&(r[o]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return a}});var ei=X((ch,Yo)=>{"use strict";var Dd=sa().MissingRef;Yo.exports=Jo;function Jo(a,e,t){var s=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(t=e,e=void 0);var r=n(a).then(function(){var l=s._addSchema(a,void 0,e);return l.validate||o(l)});return t&&r.then(function(l){t(null,l)},t),r;function n(l){var c=l.$schema;return c&&!s.getSchema(c)?Jo.call(s,{$ref:c},!0):Promise.resolve()}function o(l){try{return s._compile(l)}catch(u){if(u instanceof Dd)return c(u);throw u}function c(u){var p=u.missingSchema;if(d(p))throw new Error("Schema "+p+" is loaded but "+u.missingRef+" cannot be resolved");var m=s._loadingSchemas[p];return m||(m=s._loadingSchemas[p]=s._opts.loadSchema(p),m.then(E,E)),m.then(function(g){if(!d(p))return n(g).then(function(){d(p)||s.addSchema(g,p,void 0,e)})}).then(function(){return o(l)});function E(){delete s._loadingSchemas[p]}function d(g){return s._refs[g]||s._schemas[g]}}}}});var ti=X((uh,ri)=>{"use strict";ri.exports=function(e,t,s){var r=" ",n=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,m,E="data"+(o||""),d="valid"+n,g="errs__"+n,_=e.opts.$data&&l&&l.$data,v;_?(r+=" var schema"+n+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",v="schema"+n):v=l;var S=this,O="definition"+n,R=S.definition,T="",A,N,V,q,D;if(_&&R.$data){D="keywordValidate"+n;var U=R.validateSchema;r+=" var "+O+" = RULES.custom['"+t+"'].definition; var "+D+" = "+O+".validate;"}else{if(q=e.useCustomRule(S,l,e.schema,e),!q)return;v="validate.schema"+c,D=q.code,A=R.compile,N=R.inline,V=R.macro}var M=D+".errors",j="i"+n,I="ruleErr"+n,$=R.async;if($&&!e.async)throw new Error("async keyword in sync schema");if(N||V||(r+=""+M+" = null;"),r+="var "+g+" = errors;var "+d+";",_&&R.$data&&(T+="}",r+=" if ("+v+" === undefined) { "+d+" = true; } else { ",U&&(T+="}",r+=" "+d+" = "+O+".validateSchema("+v+"); if ("+d+") { ")),N)R.statements?r+=" "+q.validate+" ":r+=" "+d+" = "+q.validate+"; ";else if(V){var F=e.util.copy(e),T="";F.level++;var le="valid"+F.level;F.schema=q.validate,F.schemaPath="";var J=e.compositeRule;e.compositeRule=F.compositeRule=!0;var re=e.validate(F).replace(/validate\.schema/g,D);e.compositeRule=F.compositeRule=J,r+=" "+re}else{var K=K||[];K.push(r),r="",r+="  "+D+".call( ",e.opts.passContext?r+="this":r+="self",A||R.schema===!1?r+=" , "+E+" ":r+=" , "+v+" , "+E+" , validate.schema"+e.schemaPath+" ",r+=" , (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var H=o?"data"+(o-1||""):"parentData",me=o?e.dataPathArr[o]:"parentDataProperty";r+=" , "+H+" , "+me+" , rootData )  ";var Pe=r;r=K.pop(),R.errors===!1?(r+=" "+d+" = ",$&&(r+="await "),r+=""+Pe+"; "):$?(M="customErrors"+n,r+=" var "+M+" = null; try { "+d+" = await "+Pe+"; } catch (e) { "+d+" = false; if (e instanceof ValidationError) "+M+" = e.errors; else throw e; } "):r+=" "+M+" = null; "+d+" = "+Pe+"; "}if(R.modifying&&(r+=" if ("+H+") "+E+" = "+H+"["+me+"];"),r+=""+T,R.valid)p&&(r+=" if (true) { ");else{r+=" if ( ",R.valid===void 0?(r+=" !",V?r+=""+le:r+=""+d):r+=" "+!R.valid+" ",r+=") { ",m=S.keyword;var K=K||[];K.push(r),r="";var K=K||[];K.push(r),r="",e.createErrors!==!1?(r+=" { keyword: '"+(m||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+S.keyword+"' } ",e.opts.messages!==!1&&(r+=` , message: 'should pass "`+S.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+E+" "),r+=" } "):r+=" {} ";var we=r;r=K.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+we+"]); ":r+=" validate.errors = ["+we+"]; return false; ":r+=" var err = "+we+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var se=r;r=K.pop(),N?R.errors?R.errors!="full"&&(r+="  for (var "+j+"="+g+"; "+j+"<errors; "+j+"++) { var "+I+" = vErrors["+j+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(r+=" "+I+".schema = "+v+"; "+I+".data = "+E+"; "),r+=" } "):R.errors===!1?r+=" "+se+" ":(r+=" if ("+g+" == errors) { "+se+" } else {  for (var "+j+"="+g+"; "+j+"<errors; "+j+"++) { var "+I+" = vErrors["+j+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+I+".schemaPath === undefined) { "+I+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(r+=" "+I+".schema = "+v+"; "+I+".data = "+E+"; "),r+=" } } "):V?(r+="   var err =   ",e.createErrors!==!1?(r+=" { keyword: '"+(m||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+S.keyword+"' } ",e.opts.messages!==!1&&(r+=` , message: 'should pass "`+S.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+E+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&p&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; ")):R.errors===!1?r+=" "+se+" ":(r+=" if (Array.isArray("+M+")) { if (vErrors === null) vErrors = "+M+"; else vErrors = vErrors.concat("+M+"); errors = vErrors.length;  for (var "+j+"="+g+"; "+j+"<errors; "+j+"++) { var "+I+" = vErrors["+j+"]; if ("+I+".dataPath === undefined) "+I+".dataPath = (dataPath || '') + "+e.errorPath+";  "+I+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(r+=" "+I+".schema = "+v+"; "+I+".data = "+E+"; "),r+=" } } else { "+se+" } "),r+=" } ",p&&(r+=" else { ")}return r}});var hs=X((dh,$d)=>{$d.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var ni=X((fh,si)=>{"use strict";var ai=hs();si.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:ai.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:ai.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var ii=X((ph,oi)=>{"use strict";var Cd=/^[a-z_$][a-z0-9_$-]*$/i,kd=ti(),Ld=ni();oi.exports={add:jd,get:Fd,remove:Md,validate:ms};function jd(a,e){var t=this.RULES;if(t.keywords[a])throw new Error("Keyword "+a+" is already defined");if(!Cd.test(a))throw new Error("Keyword "+a+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var s=e.type;if(Array.isArray(s))for(var r=0;r<s.length;r++)o(a,s[r],e);else o(a,s,e);var n=e.metaSchema;n&&(e.$data&&this._opts.$data&&(n={anyOf:[n,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(n,!0))}t.keywords[a]=t.all[a]=!0;function o(l,c,u){for(var p,m=0;m<t.length;m++){var E=t[m];if(E.type==c){p=E;break}}p||(p={type:c,rules:[]},t.push(p));var d={keyword:l,definition:u,custom:!0,code:kd,implements:u.implements};p.rules.push(d),t.custom[l]=d}return this}function Fd(a){var e=this.RULES.custom[a];return e?e.definition:this.RULES.keywords[a]||!1}function Md(a){var e=this.RULES;delete e.keywords[a],delete e.all[a],delete e.custom[a];for(var t=0;t<e.length;t++)for(var s=e[t].rules,r=0;r<s.length;r++)if(s[r].keyword==a){s.splice(r,1);break}return this}function ms(a,e){ms.errors=null;var t=this._validateKeyword=this._validateKeyword||this.compile(Ld,!0);if(t(a))return!0;if(ms.errors=t.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(t.errors));return!1}});var li=X((hh,qd)=>{qd.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var yi=X((mh,gi)=>{"use strict";var ui=qn(),Gr=aa(),Ud=zn(),di=es(),zd=os(),Vd=eo(),Hd=Qo(),fi=Ko(),pi=Qr();gi.exports=ge;ge.prototype.validate=Zd;ge.prototype.compile=Xd;ge.prototype.addSchema=Qd;ge.prototype.addMetaSchema=Gd;ge.prototype.validateSchema=Wd;ge.prototype.getSchema=Jd;ge.prototype.removeSchema=ef;ge.prototype.addFormat=cf;ge.prototype.errorsText=lf;ge.prototype._addSchema=rf;ge.prototype._compile=tf;ge.prototype.compileAsync=ei();var fa=ii();ge.prototype.addKeyword=fa.add;ge.prototype.getKeyword=fa.get;ge.prototype.removeKeyword=fa.remove;ge.prototype.validateKeyword=fa.validate;var hi=sa();ge.ValidationError=hi.Validation;ge.MissingRefError=hi.MissingRef;ge.$dataMetaSchema=fi;var da="http://json-schema.org/draft-07/schema",ci=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],Bd=["/properties"];function ge(a){if(!(this instanceof ge))return new ge(a);a=this._opts=pi.copy(a)||{},mf(this),this._schemas={},this._refs={},this._fragments={},this._formats=Vd(a.format),this._cache=a.cache||new Ud,this._loadingSchemas={},this._compilations=[],this.RULES=Hd(),this._getId=af(a),a.loopRequired=a.loopRequired||1/0,a.errorDataPath=="property"&&(a._errorDataPathProperty=!0),a.serialize===void 0&&(a.serialize=zd),this._metaOpts=hf(this),a.formats&&ff(this),a.keywords&&pf(this),uf(this),typeof a.meta=="object"&&this.addMetaSchema(a.meta),a.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),df(this)}function Zd(a,e){var t;if(typeof a=="string"){if(t=this.getSchema(a),!t)throw new Error('no schema with key or ref "'+a+'"')}else{var s=this._addSchema(a);t=s.validate||this._compile(s)}var r=t(e);return t.$async!==!0&&(this.errors=t.errors),r}function Xd(a,e){var t=this._addSchema(a,void 0,e);return t.validate||this._compile(t)}function Qd(a,e,t,s){if(Array.isArray(a)){for(var r=0;r<a.length;r++)this.addSchema(a[r],void 0,t,s);return this}var n=this._getId(a);if(n!==void 0&&typeof n!="string")throw new Error("schema id must be string");return e=Gr.normalizeId(e||n),vi(this,e),this._schemas[e]=this._addSchema(a,t,s,!0),this}function Gd(a,e,t){return this.addSchema(a,e,t,!0),this}function Wd(a,e){var t=a.$schema;if(t!==void 0&&typeof t!="string")throw new Error("$schema must be a string");if(t=t||this._opts.defaultMeta||Kd(this),!t)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var s=this.validate(t,a);if(!s&&e){var r="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(r);else throw new Error(r)}return s}function Kd(a){var e=a._opts.meta;return a._opts.defaultMeta=typeof e=="object"?a._getId(e)||e:a.getSchema(da)?da:void 0,a._opts.defaultMeta}function Jd(a){var e=mi(this,a);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return Yd(this,a)}}function Yd(a,e){var t=Gr.schema.call(a,{schema:{}},e);if(t){var s=t.schema,r=t.root,n=t.baseId,o=ui.call(a,s,r,void 0,n);return a._fragments[e]=new di({ref:e,fragment:!0,schema:s,root:r,baseId:n,validate:o}),o}}function mi(a,e){return e=Gr.normalizeId(e),a._schemas[e]||a._refs[e]||a._fragments[e]}function ef(a){if(a instanceof RegExp)return ua(this,this._schemas,a),ua(this,this._refs,a),this;switch(typeof a){case"undefined":return ua(this,this._schemas),ua(this,this._refs),this._cache.clear(),this;case"string":var e=mi(this,a);return e&&this._cache.del(e.cacheKey),delete this._schemas[a],delete this._refs[a],this;case"object":var t=this._opts.serialize,s=t?t(a):a;this._cache.del(s);var r=this._getId(a);r&&(r=Gr.normalizeId(r),delete this._schemas[r],delete this._refs[r])}return this}function ua(a,e,t){for(var s in e){var r=e[s];!r.meta&&(!t||t.test(s))&&(a._cache.del(r.cacheKey),delete e[s])}}function rf(a,e,t,s){if(typeof a!="object"&&typeof a!="boolean")throw new Error("schema should be object or boolean");var r=this._opts.serialize,n=r?r(a):a,o=this._cache.get(n);if(o)return o;s=s||this._opts.addUsedSchema!==!1;var l=Gr.normalizeId(this._getId(a));l&&s&&vi(this,l);var c=this._opts.validateSchema!==!1&&!e,u;c&&!(u=l&&l==Gr.normalizeId(a.$schema))&&this.validateSchema(a,!0);var p=Gr.ids.call(this,a),m=new di({id:l,schema:a,localRefs:p,cacheKey:n,meta:t});return l[0]!="#"&&s&&(this._refs[l]=m),this._cache.put(n,m),c&&u&&this.validateSchema(a,!0),m}function tf(a,e){if(a.compiling)return a.validate=r,r.schema=a.schema,r.errors=null,r.root=e||r,a.schema.$async===!0&&(r.$async=!0),r;a.compiling=!0;var t;a.meta&&(t=this._opts,this._opts=this._metaOpts);var s;try{s=ui.call(this,a.schema,e,a.localRefs)}catch(n){throw delete a.validate,n}finally{a.compiling=!1,a.meta&&(this._opts=t)}return a.validate=s,a.refs=s.refs,a.refVal=s.refVal,a.root=s.root,s;function r(){var n=a.validate,o=n.apply(this,arguments);return r.errors=n.errors,o}}function af(a){switch(a.schemaId){case"auto":return of;case"id":return sf;default:return nf}}function sf(a){return a.$id&&this.logger.warn("schema $id ignored",a.$id),a.id}function nf(a){return a.id&&this.logger.warn("schema id ignored",a.id),a.$id}function of(a){if(a.$id&&a.id&&a.$id!=a.id)throw new Error("schema $id is different from id");return a.$id||a.id}function lf(a,e){if(a=a||this.errors,!a)return"No errors";e=e||{};for(var t=e.separator===void 0?", ":e.separator,s=e.dataVar===void 0?"data":e.dataVar,r="",n=0;n<a.length;n++){var o=a[n];o&&(r+=s+o.dataPath+" "+o.message+t)}return r.slice(0,-t.length)}function cf(a,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[a]=e,this}function uf(a){var e;if(a._opts.$data&&(e=li(),a.addMetaSchema(e,e.$id,!0)),a._opts.meta!==!1){var t=hs();a._opts.$data&&(t=fi(t,Bd)),a.addMetaSchema(t,da,!0),a._refs["http://json-schema.org/schema"]=da}}function df(a){var e=a._opts.schemas;if(e)if(Array.isArray(e))a.addSchema(e);else for(var t in e)a.addSchema(e[t],t)}function ff(a){for(var e in a._opts.formats){var t=a._opts.formats[e];a.addFormat(e,t)}}function pf(a){for(var e in a._opts.keywords){var t=a._opts.keywords[e];a.addKeyword(e,t)}}function vi(a,e){if(a._schemas[e]||a._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function hf(a){for(var e=pi.copy(a._opts),t=0;t<ci.length;t++)delete e[ci[t]];return e}function mf(a){var e=a._opts.logger;if(e===!1)a.logger={log:vs,warn:vs,error:vs};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");a.logger=e}}function vs(){}});var i={};wl(i,{BRAND:()=>tc,DIRTY:()=>Dr,EMPTY_PATH:()=>Cl,INVALID:()=>B,NEVER:()=>qc,OK:()=>Oe,ParseStatus:()=>Re,Schema:()=>W,ZodAny:()=>br,ZodArray:()=>vr,ZodBigInt:()=>Cr,ZodBoolean:()=>kr,ZodBranded:()=>bt,ZodCatch:()=>Zr,ZodDate:()=>Lr,ZodDefault:()=>Br,ZodDiscriminatedUnion:()=>jt,ZodEffects:()=>He,ZodEnum:()=>Vr,ZodError:()=>$e,ZodFirstPartyTypeKind:()=>w,ZodFunction:()=>Mt,ZodIntersection:()=>qr,ZodIssueCode:()=>P,ZodLazy:()=>Ur,ZodLiteral:()=>zr,ZodMap:()=>ct,ZodNaN:()=>dt,ZodNativeEnum:()=>Hr,ZodNever:()=>Qe,ZodNull:()=>Fr,ZodNullable:()=>nr,ZodNumber:()=>$r,ZodObject:()=>Ce,ZodOptional:()=>ze,ZodParsedType:()=>k,ZodPipeline:()=>St,ZodPromise:()=>Sr,ZodReadonly:()=>Xr,ZodRecord:()=>Ft,ZodSchema:()=>W,ZodSet:()=>ut,ZodString:()=>Er,ZodSymbol:()=>it,ZodTransformer:()=>He,ZodTuple:()=>sr,ZodType:()=>W,ZodUndefined:()=>jr,ZodUnion:()=>Mr,ZodUnknown:()=>mr,ZodVoid:()=>lt,addIssueToContext:()=>C,any:()=>dc,array:()=>mc,bigint:()=>oc,boolean:()=>Ws,coerce:()=>Mc,custom:()=>Xs,date:()=>ic,datetimeRegex:()=>Bs,defaultErrorMap:()=>pr,discriminatedUnion:()=>_c,effect:()=>Nc,enum:()=>wc,function:()=>Pc,getErrorMap:()=>st,getParsedType:()=>ar,instanceof:()=>sc,intersection:()=>Ec,isAborted:()=>kt,isAsync:()=>nt,isDirty:()=>Lt,isValid:()=>_r,late:()=>ac,lazy:()=>Tc,literal:()=>Oc,makeIssue:()=>Et,map:()=>xc,nan:()=>nc,nativeEnum:()=>Ic,never:()=>pc,null:()=>uc,nullable:()=>$c,number:()=>Gs,object:()=>vc,objectUtil:()=>Aa,oboolean:()=>Fc,onumber:()=>jc,optional:()=>Dc,ostring:()=>Lc,pipeline:()=>kc,preprocess:()=>Cc,promise:()=>Ac,quotelessJson:()=>Nl,record:()=>Sc,set:()=>Rc,setErrorMap:()=>$l,strictObject:()=>gc,string:()=>Qs,symbol:()=>lc,transformer:()=>Nc,tuple:()=>bc,undefined:()=>cc,union:()=>yc,unknown:()=>fc,util:()=>Y,void:()=>hc});var Y;(function(a){a.assertEqual=r=>{};function e(r){}a.assertIs=e;function t(r){throw new Error}a.assertNever=t,a.arrayToEnum=r=>{let n={};for(let o of r)n[o]=o;return n},a.getValidEnumValues=r=>{let n=a.objectKeys(r).filter(l=>typeof r[r[l]]!="number"),o={};for(let l of n)o[l]=r[l];return a.objectValues(o)},a.objectValues=r=>a.objectKeys(r).map(function(n){return r[n]}),a.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{let n=[];for(let o in r)Object.prototype.hasOwnProperty.call(r,o)&&n.push(o);return n},a.find=(r,n)=>{for(let o of r)if(n(o))return o},a.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function s(r,n=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}a.joinValues=s,a.jsonStringifyReplacer=(r,n)=>typeof n=="bigint"?n.toString():n})(Y||(Y={}));var Aa;(function(a){a.mergeShapes=(e,t)=>({...e,...t})})(Aa||(Aa={}));var k=Y.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ar=a=>{switch(typeof a){case"undefined":return k.undefined;case"string":return k.string;case"number":return Number.isNaN(a)?k.nan:k.number;case"boolean":return k.boolean;case"function":return k.function;case"bigint":return k.bigint;case"symbol":return k.symbol;case"object":return Array.isArray(a)?k.array:a===null?k.null:a.then&&typeof a.then=="function"&&a.catch&&typeof a.catch=="function"?k.promise:typeof Map<"u"&&a instanceof Map?k.map:typeof Set<"u"&&a instanceof Set?k.set:typeof Date<"u"&&a instanceof Date?k.date:k.object;default:return k.unknown}};var P=Y.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Nl=a=>JSON.stringify(a,null,2).replace(/"([^"]+)":/g,"$1:"),$e=class a extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(n){return n.message},s={_errors:[]},r=n=>{for(let o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)s._errors.push(t(o));else{let l=s,c=0;for(;c<o.path.length;){let u=o.path[c];c===o.path.length-1?(l[u]=l[u]||{_errors:[]},l[u]._errors.push(t(o))):l[u]=l[u]||{_errors:[]},l=l[u],c++}}};return r(this),s}static assert(e){if(!(e instanceof a))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Y.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},s=[];for(let r of this.issues)if(r.path.length>0){let n=r.path[0];t[n]=t[n]||[],t[n].push(e(r))}else s.push(e(r));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}};$e.create=a=>new $e(a);var Dl=(a,e)=>{let t;switch(a.code){case P.invalid_type:a.received===k.undefined?t="Required":t=`Expected ${a.expected}, received ${a.received}`;break;case P.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(a.expected,Y.jsonStringifyReplacer)}`;break;case P.unrecognized_keys:t=`Unrecognized key(s) in object: ${Y.joinValues(a.keys,", ")}`;break;case P.invalid_union:t="Invalid input";break;case P.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Y.joinValues(a.options)}`;break;case P.invalid_enum_value:t=`Invalid enum value. Expected ${Y.joinValues(a.options)}, received '${a.received}'`;break;case P.invalid_arguments:t="Invalid function arguments";break;case P.invalid_return_type:t="Invalid function return type";break;case P.invalid_date:t="Invalid date";break;case P.invalid_string:typeof a.validation=="object"?"includes"in a.validation?(t=`Invalid input: must include "${a.validation.includes}"`,typeof a.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?t=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?t=`Invalid input: must end with "${a.validation.endsWith}"`:Y.assertNever(a.validation):a.validation!=="regex"?t=`Invalid ${a.validation}`:t="Invalid";break;case P.too_small:a.type==="array"?t=`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:a.type==="string"?t=`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:a.type==="number"?t=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="bigint"?t=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="date"?t=`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:t="Invalid input";break;case P.too_big:a.type==="array"?t=`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:a.type==="string"?t=`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:a.type==="number"?t=`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="bigint"?t=`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="date"?t=`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:t="Invalid input";break;case P.custom:t="Invalid input";break;case P.invalid_intersection_types:t="Intersection results could not be merged";break;case P.not_multiple_of:t=`Number must be a multiple of ${a.multipleOf}`;break;case P.not_finite:t="Number must be finite";break;default:t=e.defaultError,Y.assertNever(a)}return{message:t}},pr=Dl;var qs=pr;function $l(a){qs=a}function st(){return qs}var Et=a=>{let{data:e,path:t,errorMaps:s,issueData:r}=a,n=[...t,...r.path||[]],o={...r,path:n};if(r.message!==void 0)return{...r,path:n,message:r.message};let l="",c=s.filter(u=>!!u).slice().reverse();for(let u of c)l=u(o,{data:e,defaultError:l}).message;return{...r,path:n,message:l}},Cl=[];function C(a,e){let t=st(),s=Et({issueData:e,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,t,t===pr?void 0:pr].filter(r=>!!r)});a.common.issues.push(s)}var Re=class a{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let s=[];for(let r of t){if(r.status==="aborted")return B;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){let s=[];for(let r of t){let n=await r.key,o=await r.value;s.push({key:n,value:o})}return a.mergeObjectSync(e,s)}static mergeObjectSync(e,t){let s={};for(let r of t){let{key:n,value:o}=r;if(n.status==="aborted"||o.status==="aborted")return B;n.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(s[n.value]=o.value)}return{status:e.value,value:s}}},B=Object.freeze({status:"aborted"}),Dr=a=>({status:"dirty",value:a}),Oe=a=>({status:"valid",value:a}),kt=a=>a.status==="aborted",Lt=a=>a.status==="dirty",_r=a=>a.status==="valid",nt=a=>typeof Promise<"u"&&a instanceof Promise;var z;(function(a){a.errToObj=e=>typeof e=="string"?{message:e}:e||{},a.toString=e=>typeof e=="string"?e:e?.message})(z||(z={}));var Ve=class{constructor(e,t,s,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Us=(a,e)=>{if(_r(e))return{success:!0,data:e.value};if(!a.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new $e(a.common.issues);return this._error=t,this._error}}};function Q(a){if(!a)return{};let{errorMap:e,invalid_type_error:t,required_error:s,description:r}=a;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,l)=>{let{message:c}=a;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??s??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:r}}var W=class{get description(){return this._def.description}_getType(e){return ar(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ar(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Re,ctx:{common:e.parent.common,data:e.data,parsedType:ar(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(nt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){let s={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ar(e)},r=this._parseSync({data:e,path:s.path,parent:s});return Us(s,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ar(e)};if(!this["~standard"].async)try{let s=this._parseSync({data:e,path:[],parent:t});return _r(s)?{value:s.value}:{issues:t.common.issues}}catch(s){s?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(s=>_r(s)?{value:s.value}:{issues:t.common.issues})}async parseAsync(e,t){let s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){let s={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ar(e)},r=this._parse({data:e,path:s.path,parent:s}),n=await(nt(r)?r:Promise.resolve(r));return Us(s,n)}refine(e,t){let s=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,n)=>{let o=e(r),l=()=>n.addIssue({code:P.custom,...s(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof t=="function"?t(s,r):t),!1))}_refinement(e){return new He({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ze.create(this,this._def)}nullable(){return nr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return vr.create(this)}promise(){return Sr.create(this,this._def)}or(e){return Mr.create([this,e],this._def)}and(e){return qr.create(this,e,this._def)}transform(e){return new He({...Q(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Br({...Q(this._def),innerType:this,defaultValue:t,typeName:w.ZodDefault})}brand(){return new bt({typeName:w.ZodBranded,type:this,...Q(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new Zr({...Q(this._def),innerType:this,catchValue:t,typeName:w.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return St.create(this,e)}readonly(){return Xr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},kl=/^c[^\s-]{8,}$/i,Ll=/^[0-9a-z]+$/,jl=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Fl=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ml=/^[a-z0-9_-]{21}$/i,ql=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ul=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zl=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Vl="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Na,Hl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Bl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Zl=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Xl=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ql=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Gl=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Vs="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Wl=new RegExp(`^${Vs}$`);function Hs(a){let e="[0-5]\\d";a.precision?e=`${e}\\.\\d{${a.precision}}`:a.precision==null&&(e=`${e}(\\.\\d+)?`);let t=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function Kl(a){return new RegExp(`^${Hs(a)}$`)}function Bs(a){let e=`${Vs}T${Hs(a)}`,t=[];return t.push(a.local?"Z?":"Z"),a.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Jl(a,e){return!!((e==="v4"||!e)&&Hl.test(a)||(e==="v6"||!e)&&Zl.test(a))}function Yl(a,e){if(!ql.test(a))return!1;try{let[t]=a.split(".");if(!t)return!1;let s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function ec(a,e){return!!((e==="v4"||!e)&&Bl.test(a)||(e==="v6"||!e)&&Xl.test(a))}var Er=class a extends W{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==k.string){let n=this._getOrReturnCtx(e);return C(n,{code:P.invalid_type,expected:k.string,received:n.parsedType}),B}let s=new Re,r;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(r=this._getOrReturnCtx(e,r),C(r,{code:P.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="max")e.data.length>n.value&&(r=this._getOrReturnCtx(e,r),C(r,{code:P.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="length"){let o=e.data.length>n.value,l=e.data.length<n.value;(o||l)&&(r=this._getOrReturnCtx(e,r),o?C(r,{code:P.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):l&&C(r,{code:P.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),s.dirty())}else if(n.kind==="email")zl.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"email",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="emoji")Na||(Na=new RegExp(Vl,"u")),Na.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"emoji",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="uuid")Fl.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"uuid",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="nanoid")Ml.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"nanoid",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid")kl.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"cuid",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid2")Ll.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"cuid2",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="ulid")jl.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"ulid",code:P.invalid_string,message:n.message}),s.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),C(r,{validation:"url",code:P.invalid_string,message:n.message}),s.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"regex",code:P.invalid_string,message:n.message}),s.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(e,r),C(r,{code:P.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),s.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(r=this._getOrReturnCtx(e,r),C(r,{code:P.invalid_string,validation:{startsWith:n.value},message:n.message}),s.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(r=this._getOrReturnCtx(e,r),C(r,{code:P.invalid_string,validation:{endsWith:n.value},message:n.message}),s.dirty()):n.kind==="datetime"?Bs(n).test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{code:P.invalid_string,validation:"datetime",message:n.message}),s.dirty()):n.kind==="date"?Wl.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{code:P.invalid_string,validation:"date",message:n.message}),s.dirty()):n.kind==="time"?Kl(n).test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{code:P.invalid_string,validation:"time",message:n.message}),s.dirty()):n.kind==="duration"?Ul.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"duration",code:P.invalid_string,message:n.message}),s.dirty()):n.kind==="ip"?Jl(e.data,n.version)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"ip",code:P.invalid_string,message:n.message}),s.dirty()):n.kind==="jwt"?Yl(e.data,n.alg)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"jwt",code:P.invalid_string,message:n.message}),s.dirty()):n.kind==="cidr"?ec(e.data,n.version)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"cidr",code:P.invalid_string,message:n.message}),s.dirty()):n.kind==="base64"?Ql.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"base64",code:P.invalid_string,message:n.message}),s.dirty()):n.kind==="base64url"?Gl.test(e.data)||(r=this._getOrReturnCtx(e,r),C(r,{validation:"base64url",code:P.invalid_string,message:n.message}),s.dirty()):Y.assertNever(n);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(r=>e.test(r),{validation:t,code:P.invalid_string,...z.errToObj(s)})}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...z.errToObj(e)})}url(e){return this._addCheck({kind:"url",...z.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...z.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...z.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...z.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...z.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...z.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...z.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...z.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...z.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...z.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...z.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...z.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...z.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...z.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...z.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...z.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...z.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...z.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...z.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...z.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...z.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...z.errToObj(t)})}nonempty(e){return this.min(1,z.errToObj(e))}trim(){return new a({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new a({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new a({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Er.create=a=>new Er({checks:[],typeName:w.ZodString,coerce:a?.coerce??!1,...Q(a)});function rc(a,e){let t=(a.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=t>s?t:s,n=Number.parseInt(a.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return n%o/10**r}var $r=class a extends W{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==k.number){let n=this._getOrReturnCtx(e);return C(n,{code:P.invalid_type,expected:k.number,received:n.parsedType}),B}let s,r=new Re;for(let n of this._def.checks)n.kind==="int"?Y.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),C(s,{code:P.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),C(s,{code:P.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),C(s,{code:P.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="multipleOf"?rc(e.data,n.value)!==0&&(s=this._getOrReturnCtx(e,s),C(s,{code:P.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),C(s,{code:P.not_finite,message:n.message}),r.dirty()):Y.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,z.toString(t))}gt(e,t){return this.setLimit("min",e,!1,z.toString(t))}lte(e,t){return this.setLimit("max",e,!0,z.toString(t))}lt(e,t){return this.setLimit("max",e,!1,z.toString(t))}setLimit(e,t,s,r){return new a({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:z.toString(r)}]})}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:z.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:z.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:z.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:z.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:z.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Y.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}};$r.create=a=>new $r({checks:[],typeName:w.ZodNumber,coerce:a?.coerce||!1,...Q(a)});var Cr=class a extends W{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==k.bigint)return this._getInvalidInput(e);let s,r=new Re;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),C(s,{code:P.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),C(s,{code:P.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),C(s,{code:P.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):Y.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return C(t,{code:P.invalid_type,expected:k.bigint,received:t.parsedType}),B}gte(e,t){return this.setLimit("min",e,!0,z.toString(t))}gt(e,t){return this.setLimit("min",e,!1,z.toString(t))}lte(e,t){return this.setLimit("max",e,!0,z.toString(t))}lt(e,t){return this.setLimit("max",e,!1,z.toString(t))}setLimit(e,t,s,r){return new a({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:z.toString(r)}]})}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:z.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:z.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:z.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:z.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:z.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Cr.create=a=>new Cr({checks:[],typeName:w.ZodBigInt,coerce:a?.coerce??!1,...Q(a)});var kr=class extends W{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==k.boolean){let s=this._getOrReturnCtx(e);return C(s,{code:P.invalid_type,expected:k.boolean,received:s.parsedType}),B}return Oe(e.data)}};kr.create=a=>new kr({typeName:w.ZodBoolean,coerce:a?.coerce||!1,...Q(a)});var Lr=class a extends W{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==k.date){let n=this._getOrReturnCtx(e);return C(n,{code:P.invalid_type,expected:k.date,received:n.parsedType}),B}if(Number.isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return C(n,{code:P.invalid_date}),B}let s=new Re,r;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),C(r,{code:P.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),s.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),C(r,{code:P.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),s.dirty()):Y.assertNever(n);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new a({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:z.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:z.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};Lr.create=a=>new Lr({checks:[],coerce:a?.coerce||!1,typeName:w.ZodDate,...Q(a)});var it=class extends W{_parse(e){if(this._getType(e)!==k.symbol){let s=this._getOrReturnCtx(e);return C(s,{code:P.invalid_type,expected:k.symbol,received:s.parsedType}),B}return Oe(e.data)}};it.create=a=>new it({typeName:w.ZodSymbol,...Q(a)});var jr=class extends W{_parse(e){if(this._getType(e)!==k.undefined){let s=this._getOrReturnCtx(e);return C(s,{code:P.invalid_type,expected:k.undefined,received:s.parsedType}),B}return Oe(e.data)}};jr.create=a=>new jr({typeName:w.ZodUndefined,...Q(a)});var Fr=class extends W{_parse(e){if(this._getType(e)!==k.null){let s=this._getOrReturnCtx(e);return C(s,{code:P.invalid_type,expected:k.null,received:s.parsedType}),B}return Oe(e.data)}};Fr.create=a=>new Fr({typeName:w.ZodNull,...Q(a)});var br=class extends W{constructor(){super(...arguments),this._any=!0}_parse(e){return Oe(e.data)}};br.create=a=>new br({typeName:w.ZodAny,...Q(a)});var mr=class extends W{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Oe(e.data)}};mr.create=a=>new mr({typeName:w.ZodUnknown,...Q(a)});var Qe=class extends W{_parse(e){let t=this._getOrReturnCtx(e);return C(t,{code:P.invalid_type,expected:k.never,received:t.parsedType}),B}};Qe.create=a=>new Qe({typeName:w.ZodNever,...Q(a)});var lt=class extends W{_parse(e){if(this._getType(e)!==k.undefined){let s=this._getOrReturnCtx(e);return C(s,{code:P.invalid_type,expected:k.void,received:s.parsedType}),B}return Oe(e.data)}};lt.create=a=>new lt({typeName:w.ZodVoid,...Q(a)});var vr=class a extends W{_parse(e){let{ctx:t,status:s}=this._processInputParams(e),r=this._def;if(t.parsedType!==k.array)return C(t,{code:P.invalid_type,expected:k.array,received:t.parsedType}),B;if(r.exactLength!==null){let o=t.data.length>r.exactLength.value,l=t.data.length<r.exactLength.value;(o||l)&&(C(t,{code:o?P.too_big:P.too_small,minimum:l?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(C(t,{code:P.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(C(t,{code:P.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>r.type._parseAsync(new Ve(t,o,t.path,l)))).then(o=>Re.mergeArray(s,o));let n=[...t.data].map((o,l)=>r.type._parseSync(new Ve(t,o,t.path,l)));return Re.mergeArray(s,n)}get element(){return this._def.type}min(e,t){return new a({...this._def,minLength:{value:e,message:z.toString(t)}})}max(e,t){return new a({...this._def,maxLength:{value:e,message:z.toString(t)}})}length(e,t){return new a({...this._def,exactLength:{value:e,message:z.toString(t)}})}nonempty(e){return this.min(1,e)}};vr.create=(a,e)=>new vr({type:a,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...Q(e)});function ot(a){if(a instanceof Ce){let e={};for(let t in a.shape){let s=a.shape[t];e[t]=ze.create(ot(s))}return new Ce({...a._def,shape:()=>e})}else return a instanceof vr?new vr({...a._def,type:ot(a.element)}):a instanceof ze?ze.create(ot(a.unwrap())):a instanceof nr?nr.create(ot(a.unwrap())):a instanceof sr?sr.create(a.items.map(e=>ot(e))):a}var Ce=class a extends W{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=Y.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==k.object){let u=this._getOrReturnCtx(e);return C(u,{code:P.invalid_type,expected:k.object,received:u.parsedType}),B}let{status:s,ctx:r}=this._processInputParams(e),{shape:n,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Qe&&this._def.unknownKeys==="strip"))for(let u in r.data)o.includes(u)||l.push(u);let c=[];for(let u of o){let p=n[u],m=r.data[u];c.push({key:{status:"valid",value:u},value:p._parse(new Ve(r,m,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof Qe){let u=this._def.unknownKeys;if(u==="passthrough")for(let p of l)c.push({key:{status:"valid",value:p},value:{status:"valid",value:r.data[p]}});else if(u==="strict")l.length>0&&(C(r,{code:P.unrecognized_keys,keys:l}),s.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let p of l){let m=r.data[p];c.push({key:{status:"valid",value:p},value:u._parse(new Ve(r,m,r.path,p)),alwaysSet:p in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let u=[];for(let p of c){let m=await p.key,E=await p.value;u.push({key:m,value:E,alwaysSet:p.alwaysSet})}return u}).then(u=>Re.mergeObjectSync(s,u)):Re.mergeObjectSync(s,c)}get shape(){return this._def.shape()}strict(e){return z.errToObj,new a({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{let r=this._def.errorMap?.(t,s).message??s.defaultError;return t.code==="unrecognized_keys"?{message:z.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new a({...this._def,unknownKeys:"strip"})}passthrough(){return new a({...this._def,unknownKeys:"passthrough"})}extend(e){return new a({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new a({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:w.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new a({...this._def,catchall:e})}pick(e){let t={};for(let s of Y.objectKeys(e))e[s]&&this.shape[s]&&(t[s]=this.shape[s]);return new a({...this._def,shape:()=>t})}omit(e){let t={};for(let s of Y.objectKeys(this.shape))e[s]||(t[s]=this.shape[s]);return new a({...this._def,shape:()=>t})}deepPartial(){return ot(this)}partial(e){let t={};for(let s of Y.objectKeys(this.shape)){let r=this.shape[s];e&&!e[s]?t[s]=r:t[s]=r.optional()}return new a({...this._def,shape:()=>t})}required(e){let t={};for(let s of Y.objectKeys(this.shape))if(e&&!e[s])t[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof ze;)n=n._def.innerType;t[s]=n}return new a({...this._def,shape:()=>t})}keyof(){return Zs(Y.objectKeys(this.shape))}};Ce.create=(a,e)=>new Ce({shape:()=>a,unknownKeys:"strip",catchall:Qe.create(),typeName:w.ZodObject,...Q(e)});Ce.strictCreate=(a,e)=>new Ce({shape:()=>a,unknownKeys:"strict",catchall:Qe.create(),typeName:w.ZodObject,...Q(e)});Ce.lazycreate=(a,e)=>new Ce({shape:a,unknownKeys:"strip",catchall:Qe.create(),typeName:w.ZodObject,...Q(e)});var Mr=class extends W{_parse(e){let{ctx:t}=this._processInputParams(e),s=this._def.options;function r(n){for(let l of n)if(l.result.status==="valid")return l.result;for(let l of n)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;let o=n.map(l=>new $e(l.ctx.common.issues));return C(t,{code:P.invalid_union,unionErrors:o}),B}if(t.common.async)return Promise.all(s.map(async n=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await n._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(r);{let n,o=[];for(let c of s){let u={...t,common:{...t.common,issues:[]},parent:null},p=c._parseSync({data:t.data,path:t.path,parent:u});if(p.status==="valid")return p;p.status==="dirty"&&!n&&(n={result:p,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(n)return t.common.issues.push(...n.ctx.common.issues),n.result;let l=o.map(c=>new $e(c));return C(t,{code:P.invalid_union,unionErrors:l}),B}}get options(){return this._def.options}};Mr.create=(a,e)=>new Mr({options:a,typeName:w.ZodUnion,...Q(e)});var hr=a=>a instanceof Ur?hr(a.schema):a instanceof He?hr(a.innerType()):a instanceof zr?[a.value]:a instanceof Vr?a.options:a instanceof Hr?Y.objectValues(a.enum):a instanceof Br?hr(a._def.innerType):a instanceof jr?[void 0]:a instanceof Fr?[null]:a instanceof ze?[void 0,...hr(a.unwrap())]:a instanceof nr?[null,...hr(a.unwrap())]:a instanceof bt||a instanceof Xr?hr(a.unwrap()):a instanceof Zr?hr(a._def.innerType):[],jt=class a extends W{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==k.object)return C(t,{code:P.invalid_type,expected:k.object,received:t.parsedType}),B;let s=this.discriminator,r=t.data[s],n=this.optionsMap.get(r);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(C(t,{code:P.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),B)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){let r=new Map;for(let n of t){let o=hr(n.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let l of o){if(r.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);r.set(l,n)}}return new a({typeName:w.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...Q(s)})}};function Da(a,e){let t=ar(a),s=ar(e);if(a===e)return{valid:!0,data:a};if(t===k.object&&s===k.object){let r=Y.objectKeys(e),n=Y.objectKeys(a).filter(l=>r.indexOf(l)!==-1),o={...a,...e};for(let l of n){let c=Da(a[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===k.array&&s===k.array){if(a.length!==e.length)return{valid:!1};let r=[];for(let n=0;n<a.length;n++){let o=a[n],l=e[n],c=Da(o,l);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}else return t===k.date&&s===k.date&&+a==+e?{valid:!0,data:a}:{valid:!1}}var qr=class extends W{_parse(e){let{status:t,ctx:s}=this._processInputParams(e),r=(n,o)=>{if(kt(n)||kt(o))return B;let l=Da(n.value,o.value);return l.valid?((Lt(n)||Lt(o))&&t.dirty(),{status:t.value,value:l.data}):(C(s,{code:P.invalid_intersection_types}),B)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([n,o])=>r(n,o)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};qr.create=(a,e,t)=>new qr({left:a,right:e,typeName:w.ZodIntersection,...Q(t)});var sr=class a extends W{_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.array)return C(s,{code:P.invalid_type,expected:k.array,received:s.parsedType}),B;if(s.data.length<this._def.items.length)return C(s,{code:P.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),B;!this._def.rest&&s.data.length>this._def.items.length&&(C(s,{code:P.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...s.data].map((o,l)=>{let c=this._def.items[l]||this._def.rest;return c?c._parse(new Ve(s,o,s.path,l)):null}).filter(o=>!!o);return s.common.async?Promise.all(n).then(o=>Re.mergeArray(t,o)):Re.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new a({...this._def,rest:e})}};sr.create=(a,e)=>{if(!Array.isArray(a))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new sr({items:a,typeName:w.ZodTuple,rest:null,...Q(e)})};var Ft=class a extends W{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.object)return C(s,{code:P.invalid_type,expected:k.object,received:s.parsedType}),B;let r=[],n=this._def.keyType,o=this._def.valueType;for(let l in s.data)r.push({key:n._parse(new Ve(s,l,s.path,l)),value:o._parse(new Ve(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?Re.mergeObjectAsync(t,r):Re.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,s){return t instanceof W?new a({keyType:e,valueType:t,typeName:w.ZodRecord,...Q(s)}):new a({keyType:Er.create(),valueType:e,typeName:w.ZodRecord,...Q(t)})}},ct=class extends W{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.map)return C(s,{code:P.invalid_type,expected:k.map,received:s.parsedType}),B;let r=this._def.keyType,n=this._def.valueType,o=[...s.data.entries()].map(([l,c],u)=>({key:r._parse(new Ve(s,l,s.path,[u,"key"])),value:n._parse(new Ve(s,c,s.path,[u,"value"]))}));if(s.common.async){let l=new Map;return Promise.resolve().then(async()=>{for(let c of o){let u=await c.key,p=await c.value;if(u.status==="aborted"||p.status==="aborted")return B;(u.status==="dirty"||p.status==="dirty")&&t.dirty(),l.set(u.value,p.value)}return{status:t.value,value:l}})}else{let l=new Map;for(let c of o){let u=c.key,p=c.value;if(u.status==="aborted"||p.status==="aborted")return B;(u.status==="dirty"||p.status==="dirty")&&t.dirty(),l.set(u.value,p.value)}return{status:t.value,value:l}}}};ct.create=(a,e,t)=>new ct({valueType:e,keyType:a,typeName:w.ZodMap,...Q(t)});var ut=class a extends W{_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.set)return C(s,{code:P.invalid_type,expected:k.set,received:s.parsedType}),B;let r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(C(s,{code:P.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(C(s,{code:P.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let n=this._def.valueType;function o(c){let u=new Set;for(let p of c){if(p.status==="aborted")return B;p.status==="dirty"&&t.dirty(),u.add(p.value)}return{status:t.value,value:u}}let l=[...s.data.values()].map((c,u)=>n._parse(new Ve(s,c,s.path,u)));return s.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new a({...this._def,minSize:{value:e,message:z.toString(t)}})}max(e,t){return new a({...this._def,maxSize:{value:e,message:z.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};ut.create=(a,e)=>new ut({valueType:a,minSize:null,maxSize:null,typeName:w.ZodSet,...Q(e)});var Mt=class a extends W{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==k.function)return C(t,{code:P.invalid_type,expected:k.function,received:t.parsedType}),B;function s(l,c){return Et({data:l,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,st(),pr].filter(u=>!!u),issueData:{code:P.invalid_arguments,argumentsError:c}})}function r(l,c){return Et({data:l,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,st(),pr].filter(u=>!!u),issueData:{code:P.invalid_return_type,returnTypeError:c}})}let n={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Sr){let l=this;return Oe(async function(...c){let u=new $e([]),p=await l._def.args.parseAsync(c,n).catch(d=>{throw u.addIssue(s(c,d)),u}),m=await Reflect.apply(o,this,p);return await l._def.returns._def.type.parseAsync(m,n).catch(d=>{throw u.addIssue(r(m,d)),u})})}else{let l=this;return Oe(function(...c){let u=l._def.args.safeParse(c,n);if(!u.success)throw new $e([s(c,u.error)]);let p=Reflect.apply(o,this,u.data),m=l._def.returns.safeParse(p,n);if(!m.success)throw new $e([r(p,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new a({...this._def,args:sr.create(e).rest(mr.create())})}returns(e){return new a({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new a({args:e||sr.create([]).rest(mr.create()),returns:t||mr.create(),typeName:w.ZodFunction,...Q(s)})}},Ur=class extends W{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Ur.create=(a,e)=>new Ur({getter:a,typeName:w.ZodLazy,...Q(e)});var zr=class extends W{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return C(t,{received:t.data,code:P.invalid_literal,expected:this._def.value}),B}return{status:"valid",value:e.data}}get value(){return this._def.value}};zr.create=(a,e)=>new zr({value:a,typeName:w.ZodLiteral,...Q(e)});function Zs(a,e){return new Vr({values:a,typeName:w.ZodEnum,...Q(e)})}var Vr=class a extends W{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),s=this._def.values;return C(t,{expected:Y.joinValues(s),received:t.parsedType,code:P.invalid_type}),B}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),s=this._def.values;return C(t,{received:t.data,code:P.invalid_enum_value,options:s}),B}return Oe(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return a.create(e,{...this._def,...t})}exclude(e,t=this._def){return a.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}};Vr.create=Zs;var Hr=class extends W{_parse(e){let t=Y.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==k.string&&s.parsedType!==k.number){let r=Y.objectValues(t);return C(s,{expected:Y.joinValues(r),received:s.parsedType,code:P.invalid_type}),B}if(this._cache||(this._cache=new Set(Y.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let r=Y.objectValues(t);return C(s,{received:s.data,code:P.invalid_enum_value,options:r}),B}return Oe(e.data)}get enum(){return this._def.values}};Hr.create=(a,e)=>new Hr({values:a,typeName:w.ZodNativeEnum,...Q(e)});var Sr=class extends W{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==k.promise&&t.common.async===!1)return C(t,{code:P.invalid_type,expected:k.promise,received:t.parsedType}),B;let s=t.parsedType===k.promise?t.data:Promise.resolve(t.data);return Oe(s.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Sr.create=(a,e)=>new Sr({type:a,typeName:w.ZodPromise,...Q(e)});var He=class extends W{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:s}=this._processInputParams(e),r=this._def.effect||null,n={addIssue:o=>{C(s,o),o.fatal?t.abort():t.dirty()},get path(){return s.path}};if(n.addIssue=n.addIssue.bind(n),r.type==="preprocess"){let o=r.transform(s.data,n);if(s.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return B;let c=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return c.status==="aborted"?B:c.status==="dirty"?Dr(c.value):t.value==="dirty"?Dr(c.value):c});{if(t.value==="aborted")return B;let l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?B:l.status==="dirty"?Dr(l.value):t.value==="dirty"?Dr(l.value):l}}if(r.type==="refinement"){let o=l=>{let c=r.refinement(l,n);if(s.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){let l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?B:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?B:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(r.type==="transform")if(s.common.async===!1){let o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!_r(o))return B;let l=r.transform(o.value,n);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>_r(o)?Promise.resolve(r.transform(o.value,n)).then(l=>({status:t.value,value:l})):B);Y.assertNever(r)}};He.create=(a,e,t)=>new He({schema:a,typeName:w.ZodEffects,effect:e,...Q(t)});He.createWithPreprocess=(a,e,t)=>new He({schema:e,effect:{type:"preprocess",transform:a},typeName:w.ZodEffects,...Q(t)});var ze=class extends W{_parse(e){return this._getType(e)===k.undefined?Oe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ze.create=(a,e)=>new ze({innerType:a,typeName:w.ZodOptional,...Q(e)});var nr=class extends W{_parse(e){return this._getType(e)===k.null?Oe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};nr.create=(a,e)=>new nr({innerType:a,typeName:w.ZodNullable,...Q(e)});var Br=class extends W{_parse(e){let{ctx:t}=this._processInputParams(e),s=t.data;return t.parsedType===k.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Br.create=(a,e)=>new Br({innerType:a,typeName:w.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Q(e)});var Zr=class extends W{_parse(e){let{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return nt(r)?r.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new $e(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new $e(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};Zr.create=(a,e)=>new Zr({innerType:a,typeName:w.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Q(e)});var dt=class extends W{_parse(e){if(this._getType(e)!==k.nan){let s=this._getOrReturnCtx(e);return C(s,{code:P.invalid_type,expected:k.nan,received:s.parsedType}),B}return{status:"valid",value:e.data}}};dt.create=a=>new dt({typeName:w.ZodNaN,...Q(a)});var tc=Symbol("zod_brand"),bt=class extends W{_parse(e){let{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}},St=class a extends W{_parse(e){let{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?B:n.status==="dirty"?(t.dirty(),Dr(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?B:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,t){return new a({in:e,out:t,typeName:w.ZodPipeline})}},Xr=class extends W{_parse(e){let t=this._def.innerType._parse(e),s=r=>(_r(r)&&(r.value=Object.freeze(r.value)),r);return nt(t)?t.then(r=>s(r)):s(t)}unwrap(){return this._def.innerType}};Xr.create=(a,e)=>new Xr({innerType:a,typeName:w.ZodReadonly,...Q(e)});function zs(a,e){let t=typeof a=="function"?a(e):typeof a=="string"?{message:a}:a;return typeof t=="string"?{message:t}:t}function Xs(a,e={},t){return a?br.create().superRefine((s,r)=>{let n=a(s);if(n instanceof Promise)return n.then(o=>{if(!o){let l=zs(e,s),c=l.fatal??t??!0;r.addIssue({code:"custom",...l,fatal:c})}});if(!n){let o=zs(e,s),l=o.fatal??t??!0;r.addIssue({code:"custom",...o,fatal:l})}}):br.create()}var ac={object:Ce.lazycreate},w;(function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"})(w||(w={}));var sc=(a,e={message:`Input not instance of ${a.name}`})=>Xs(t=>t instanceof a,e),Qs=Er.create,Gs=$r.create,nc=dt.create,oc=Cr.create,Ws=kr.create,ic=Lr.create,lc=it.create,cc=jr.create,uc=Fr.create,dc=br.create,fc=mr.create,pc=Qe.create,hc=lt.create,mc=vr.create,vc=Ce.create,gc=Ce.strictCreate,yc=Mr.create,_c=jt.create,Ec=qr.create,bc=sr.create,Sc=Ft.create,xc=ct.create,Rc=ut.create,Pc=Mt.create,Tc=Ur.create,Oc=zr.create,wc=Vr.create,Ic=Hr.create,Ac=Sr.create,Nc=He.create,Dc=ze.create,$c=nr.create,Cc=He.createWithPreprocess,kc=St.create,Lc=()=>Qs().optional(),jc=()=>Gs().optional(),Fc=()=>Ws().optional(),Mc={string:a=>Er.create({...a,coerce:!0}),number:a=>$r.create({...a,coerce:!0}),boolean:a=>kr.create({...a,coerce:!0}),bigint:a=>Cr.create({...a,coerce:!0}),date:a=>Lr.create({...a,coerce:!0})};var qc=B;var $a="2025-06-18";var Ks=[$a,"2025-03-26","2024-11-05","2024-10-07"],qt="2.0",Js=i.union([i.string(),i.number().int()]),Ys=i.string(),Uc=i.object({progressToken:i.optional(Js)}).passthrough(),Be=i.object({_meta:i.optional(Uc)}).passthrough(),ke=i.object({method:i.string(),params:i.optional(Be)}),xt=i.object({_meta:i.optional(i.object({}).passthrough())}).passthrough(),or=i.object({method:i.string(),params:i.optional(xt)}),Ze=i.object({_meta:i.optional(i.object({}).passthrough())}).passthrough(),Ut=i.union([i.string(),i.number().int()]),en=i.object({jsonrpc:i.literal(qt),id:Ut}).merge(ke).strict(),rn=a=>en.safeParse(a).success,tn=i.object({jsonrpc:i.literal(qt)}).merge(or).strict(),an=a=>tn.safeParse(a).success,sn=i.object({jsonrpc:i.literal(qt),id:Ut,result:Ze}).strict(),Ca=a=>sn.safeParse(a).success,Ge;(function(a){a[a.ConnectionClosed=-32e3]="ConnectionClosed",a[a.RequestTimeout=-32001]="RequestTimeout",a[a.ParseError=-32700]="ParseError",a[a.InvalidRequest=-32600]="InvalidRequest",a[a.MethodNotFound=-32601]="MethodNotFound",a[a.InvalidParams=-32602]="InvalidParams",a[a.InternalError=-32603]="InternalError"})(Ge||(Ge={}));var nn=i.object({jsonrpc:i.literal(qt),id:Ut,error:i.object({code:i.number().int(),message:i.string(),data:i.optional(i.unknown())})}).strict(),on=a=>nn.safeParse(a).success,ln=i.union([en,tn,sn,nn]),zt=Ze.strict(),Vt=or.extend({method:i.literal("notifications/cancelled"),params:xt.extend({requestId:Ut,reason:i.string().optional()})}),zc=i.object({src:i.string(),mimeType:i.optional(i.string()),sizes:i.optional(i.array(i.string()))}).passthrough(),Rt=i.object({icons:i.array(zc).optional()}).passthrough(),Pt=i.object({name:i.string(),title:i.optional(i.string())}).passthrough(),cn=Pt.extend({version:i.string(),websiteUrl:i.optional(i.string())}).merge(Rt),Vc=i.object({experimental:i.optional(i.object({}).passthrough()),sampling:i.optional(i.object({}).passthrough()),elicitation:i.optional(i.object({}).passthrough()),roots:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough())}).passthrough(),ka=ke.extend({method:i.literal("initialize"),params:Be.extend({protocolVersion:i.string(),capabilities:Vc,clientInfo:cn})});var Hc=i.object({experimental:i.optional(i.object({}).passthrough()),logging:i.optional(i.object({}).passthrough()),completions:i.optional(i.object({}).passthrough()),prompts:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough()),resources:i.optional(i.object({subscribe:i.optional(i.boolean()),listChanged:i.optional(i.boolean())}).passthrough()),tools:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough())}).passthrough(),Bc=Ze.extend({protocolVersion:i.string(),capabilities:Hc,serverInfo:cn,instructions:i.optional(i.string())}),La=or.extend({method:i.literal("notifications/initialized")});var Ht=ke.extend({method:i.literal("ping")}),Zc=i.object({progress:i.number(),total:i.optional(i.number()),message:i.optional(i.string())}).passthrough(),Bt=or.extend({method:i.literal("notifications/progress"),params:xt.merge(Zc).extend({progressToken:Js})}),Zt=ke.extend({params:Be.extend({cursor:i.optional(Ys)}).optional()}),Xt=Ze.extend({nextCursor:i.optional(Ys)}),un=i.object({uri:i.string(),mimeType:i.optional(i.string()),_meta:i.optional(i.object({}).passthrough())}).passthrough(),dn=un.extend({text:i.string()}),ja=i.string().refine(a=>{try{return atob(a),!0}catch{return!1}},{message:"Invalid Base64 string"}),fn=un.extend({blob:ja}),pn=Pt.extend({uri:i.string(),description:i.optional(i.string()),mimeType:i.optional(i.string()),_meta:i.optional(i.object({}).passthrough())}).merge(Rt),Xc=Pt.extend({uriTemplate:i.string(),description:i.optional(i.string()),mimeType:i.optional(i.string()),_meta:i.optional(i.object({}).passthrough())}).merge(Rt),Qc=Zt.extend({method:i.literal("resources/list")}),Gc=Xt.extend({resources:i.array(pn)}),Wc=Zt.extend({method:i.literal("resources/templates/list")}),Kc=Xt.extend({resourceTemplates:i.array(Xc)}),Jc=ke.extend({method:i.literal("resources/read"),params:Be.extend({uri:i.string()})}),Yc=Ze.extend({contents:i.array(i.union([dn,fn]))}),eu=or.extend({method:i.literal("notifications/resources/list_changed")}),ru=ke.extend({method:i.literal("resources/subscribe"),params:Be.extend({uri:i.string()})}),tu=ke.extend({method:i.literal("resources/unsubscribe"),params:Be.extend({uri:i.string()})}),au=or.extend({method:i.literal("notifications/resources/updated"),params:xt.extend({uri:i.string()})}),su=i.object({name:i.string(),description:i.optional(i.string()),required:i.optional(i.boolean())}).passthrough(),nu=Pt.extend({description:i.optional(i.string()),arguments:i.optional(i.array(su)),_meta:i.optional(i.object({}).passthrough())}).merge(Rt),ou=Zt.extend({method:i.literal("prompts/list")}),iu=Xt.extend({prompts:i.array(nu)}),lu=ke.extend({method:i.literal("prompts/get"),params:Be.extend({name:i.string(),arguments:i.optional(i.record(i.string()))})}),Fa=i.object({type:i.literal("text"),text:i.string(),_meta:i.optional(i.object({}).passthrough())}).passthrough(),Ma=i.object({type:i.literal("image"),data:ja,mimeType:i.string(),_meta:i.optional(i.object({}).passthrough())}).passthrough(),qa=i.object({type:i.literal("audio"),data:ja,mimeType:i.string(),_meta:i.optional(i.object({}).passthrough())}).passthrough(),cu=i.object({type:i.literal("resource"),resource:i.union([dn,fn]),_meta:i.optional(i.object({}).passthrough())}).passthrough(),uu=pn.extend({type:i.literal("resource_link")}),hn=i.union([Fa,Ma,qa,uu,cu]),du=i.object({role:i.enum(["user","assistant"]),content:hn}).passthrough(),fu=Ze.extend({description:i.optional(i.string()),messages:i.array(du)}),pu=or.extend({method:i.literal("notifications/prompts/list_changed")}),hu=i.object({title:i.optional(i.string()),readOnlyHint:i.optional(i.boolean()),destructiveHint:i.optional(i.boolean()),idempotentHint:i.optional(i.boolean()),openWorldHint:i.optional(i.boolean())}).passthrough(),mu=Pt.extend({description:i.optional(i.string()),inputSchema:i.object({type:i.literal("object"),properties:i.optional(i.object({}).passthrough()),required:i.optional(i.array(i.string()))}).passthrough(),outputSchema:i.optional(i.object({type:i.literal("object"),properties:i.optional(i.object({}).passthrough()),required:i.optional(i.array(i.string()))}).passthrough()),annotations:i.optional(hu),_meta:i.optional(i.object({}).passthrough())}).merge(Rt),Ua=Zt.extend({method:i.literal("tools/list")}),vu=Xt.extend({tools:i.array(mu)}),mn=Ze.extend({content:i.array(hn).default([]),structuredContent:i.object({}).passthrough().optional(),isError:i.optional(i.boolean())}),mp=mn.or(Ze.extend({toolResult:i.unknown()})),za=ke.extend({method:i.literal("tools/call"),params:Be.extend({name:i.string(),arguments:i.optional(i.record(i.unknown()))})}),gu=or.extend({method:i.literal("notifications/tools/list_changed")}),Tt=i.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),Va=ke.extend({method:i.literal("logging/setLevel"),params:Be.extend({level:Tt})}),yu=or.extend({method:i.literal("notifications/message"),params:xt.extend({level:Tt,logger:i.optional(i.string()),data:i.unknown()})}),_u=i.object({name:i.string().optional()}).passthrough(),Eu=i.object({hints:i.optional(i.array(_u)),costPriority:i.optional(i.number().min(0).max(1)),speedPriority:i.optional(i.number().min(0).max(1)),intelligencePriority:i.optional(i.number().min(0).max(1))}).passthrough(),bu=i.object({role:i.enum(["user","assistant"]),content:i.union([Fa,Ma,qa])}).passthrough(),Su=ke.extend({method:i.literal("sampling/createMessage"),params:Be.extend({messages:i.array(bu),systemPrompt:i.optional(i.string()),includeContext:i.optional(i.enum(["none","thisServer","allServers"])),temperature:i.optional(i.number()),maxTokens:i.number().int(),stopSequences:i.optional(i.array(i.string())),metadata:i.optional(i.object({}).passthrough()),modelPreferences:i.optional(Eu)})}),Ha=Ze.extend({model:i.string(),stopReason:i.optional(i.enum(["endTurn","stopSequence","maxTokens"]).or(i.string())),role:i.enum(["user","assistant"]),content:i.discriminatedUnion("type",[Fa,Ma,qa])}),xu=i.object({type:i.literal("boolean"),title:i.optional(i.string()),description:i.optional(i.string()),default:i.optional(i.boolean())}).passthrough(),Ru=i.object({type:i.literal("string"),title:i.optional(i.string()),description:i.optional(i.string()),minLength:i.optional(i.number()),maxLength:i.optional(i.number()),format:i.optional(i.enum(["email","uri","date","date-time"]))}).passthrough(),Pu=i.object({type:i.enum(["number","integer"]),title:i.optional(i.string()),description:i.optional(i.string()),minimum:i.optional(i.number()),maximum:i.optional(i.number())}).passthrough(),Tu=i.object({type:i.literal("string"),title:i.optional(i.string()),description:i.optional(i.string()),enum:i.array(i.string()),enumNames:i.optional(i.array(i.string()))}).passthrough(),Ou=i.union([xu,Ru,Pu,Tu]),wu=ke.extend({method:i.literal("elicitation/create"),params:Be.extend({message:i.string(),requestedSchema:i.object({type:i.literal("object"),properties:i.record(i.string(),Ou),required:i.optional(i.array(i.string()))}).passthrough()})}),Ba=Ze.extend({action:i.enum(["accept","decline","cancel"]),content:i.optional(i.record(i.string(),i.unknown()))}),Iu=i.object({type:i.literal("ref/resource"),uri:i.string()}).passthrough();var Au=i.object({type:i.literal("ref/prompt"),name:i.string()}).passthrough(),Nu=ke.extend({method:i.literal("completion/complete"),params:Be.extend({ref:i.union([Au,Iu]),argument:i.object({name:i.string(),value:i.string()}).passthrough(),context:i.optional(i.object({arguments:i.optional(i.record(i.string(),i.string()))}))})}),Du=Ze.extend({completion:i.object({values:i.array(i.string()).max(100),total:i.optional(i.number().int()),hasMore:i.optional(i.boolean())}).passthrough()}),$u=i.object({uri:i.string().startsWith("file://"),name:i.optional(i.string()),_meta:i.optional(i.object({}).passthrough())}).passthrough(),Cu=ke.extend({method:i.literal("roots/list")}),Za=Ze.extend({roots:i.array($u)}),ku=or.extend({method:i.literal("notifications/roots/list_changed")}),vp=i.union([Ht,ka,Nu,Va,lu,ou,Qc,Wc,Jc,ru,tu,za,Ua]),gp=i.union([Vt,Bt,La,ku]),yp=i.union([zt,Ha,Ba,Za]),_p=i.union([Ht,Su,wu,Cu]),Ep=i.union([Vt,Bt,yu,au,eu,gu,pu]),bp=i.union([zt,Bc,Du,fu,iu,Gc,Kc,Yc,mn,vu]),We=class extends Error{constructor(e,t,s){super(`MCP error ${e}: ${t}`),this.code=e,this.data=s,this.name="McpError"}};var Lu=6e4,Qt=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(Vt,t=>{let s=this._requestHandlerAbortControllers.get(t.params.requestId);s?.abort(t.params.reason)}),this.setNotificationHandler(Bt,t=>{this._onprogress(t)}),this.setRequestHandler(Ht,t=>({}))}_setupTimeout(e,t,s,r,n=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(r,t),startTime:Date.now(),timeout:t,maxTotalTimeout:s,resetTimeoutOnProgress:n,onTimeout:r})}_resetTimeout(e){let t=this._timeoutInfo.get(e);if(!t)return!1;let s=Date.now()-t.startTime;if(t.maxTotalTimeout&&s>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new We(Ge.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:s});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),!0}_cleanupTimeout(e){let t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var t,s,r;this._transport=e;let n=(t=this.transport)===null||t===void 0?void 0:t.onclose;this._transport.onclose=()=>{n?.(),this._onclose()};let o=(s=this.transport)===null||s===void 0?void 0:s.onerror;this._transport.onerror=c=>{o?.(c),this._onerror(c)};let l=(r=this._transport)===null||r===void 0?void 0:r.onmessage;this._transport.onmessage=(c,u)=>{l?.(c,u),Ca(c)||on(c)?this._onresponse(c):rn(c)?this._onrequest(c,u):an(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var e;let t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let s=new We(Ge.ConnectionClosed,"Connection closed");for(let r of t.values())r(s)}_onerror(e){var t;(t=this.onerror)===null||t===void 0||t.call(this,e)}_onnotification(e){var t;let s=(t=this._notificationHandlers.get(e.method))!==null&&t!==void 0?t:this.fallbackNotificationHandler;s!==void 0&&Promise.resolve().then(()=>s(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)))}_onrequest(e,t){var s,r;let n=(s=this._requestHandlers.get(e.method))!==null&&s!==void 0?s:this.fallbackRequestHandler,o=this._transport;if(n===void 0){o?.send({jsonrpc:"2.0",id:e.id,error:{code:Ge.MethodNotFound,message:"Method not found"}}).catch(u=>this._onerror(new Error(`Failed to send an error response: ${u}`)));return}let l=new AbortController;this._requestHandlerAbortControllers.set(e.id,l);let c={signal:l.signal,sessionId:o?.sessionId,_meta:(r=e.params)===null||r===void 0?void 0:r._meta,sendNotification:u=>this.notification(u,{relatedRequestId:e.id}),sendRequest:(u,p,m)=>this.request(u,p,{...m,relatedRequestId:e.id}),authInfo:t?.authInfo,requestId:e.id,requestInfo:t?.requestInfo};Promise.resolve().then(()=>n(e,c)).then(u=>{if(!l.signal.aborted)return o?.send({result:u,jsonrpc:"2.0",id:e.id})},u=>{var p;if(!l.signal.aborted)return o?.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(u.code)?u.code:Ge.InternalError,message:(p=u.message)!==null&&p!==void 0?p:"Internal error"}})}).catch(u=>this._onerror(new Error(`Failed to send response: ${u}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:t,...s}=e.params,r=Number(t),n=this._progressHandlers.get(r);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let o=this._responseHandlers.get(r),l=this._timeoutInfo.get(r);if(l&&o&&l.resetTimeoutOnProgress)try{this._resetTimeout(r)}catch(c){o(c);return}n(s)}_onresponse(e){let t=Number(e.id),s=this._responseHandlers.get(t);if(s===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),Ca(e))s(e);else{let r=new We(e.error.code,e.error.message,e.error.data);s(r)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,t,s){let{relatedRequestId:r,resumptionToken:n,onresumptiontoken:o}=s??{};return new Promise((l,c)=>{var u,p,m,E,d,g;if(!this._transport){c(new Error("Not connected"));return}((u=this._options)===null||u===void 0?void 0:u.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(p=s?.signal)===null||p===void 0||p.throwIfAborted();let _=this._requestMessageId++,v={...e,jsonrpc:"2.0",id:_};s?.onprogress&&(this._progressHandlers.set(_,s.onprogress),v.params={...e.params,_meta:{...((m=e.params)===null||m===void 0?void 0:m._meta)||{},progressToken:_}});let S=T=>{var A;this._responseHandlers.delete(_),this._progressHandlers.delete(_),this._cleanupTimeout(_),(A=this._transport)===null||A===void 0||A.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:_,reason:String(T)}},{relatedRequestId:r,resumptionToken:n,onresumptiontoken:o}).catch(N=>this._onerror(new Error(`Failed to send cancellation: ${N}`))),c(T)};this._responseHandlers.set(_,T=>{var A;if(!(!((A=s?.signal)===null||A===void 0)&&A.aborted)){if(T instanceof Error)return c(T);try{let N=t.parse(T.result);l(N)}catch(N){c(N)}}}),(E=s?.signal)===null||E===void 0||E.addEventListener("abort",()=>{var T;S((T=s?.signal)===null||T===void 0?void 0:T.reason)});let O=(d=s?.timeout)!==null&&d!==void 0?d:Lu,R=()=>S(new We(Ge.RequestTimeout,"Request timed out",{timeout:O}));this._setupTimeout(_,O,s?.maxTotalTimeout,R,(g=s?.resetTimeoutOnProgress)!==null&&g!==void 0?g:!1),this._transport.send(v,{relatedRequestId:r,resumptionToken:n,onresumptiontoken:o}).catch(T=>{this._cleanupTimeout(_),c(T)})})}async notification(e,t){var s,r;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((r=(s=this._options)===null||s===void 0?void 0:s.debouncedNotificationMethods)!==null&&r!==void 0?r:[]).includes(e.method)&&!e.params&&!t?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var c;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let u={...e,jsonrpc:"2.0"};(c=this._transport)===null||c===void 0||c.send(u,t).catch(p=>this._onerror(p))});return}let l={...e,jsonrpc:"2.0"};await this._transport.send(l,t)}setRequestHandler(e,t){let s=e.shape.method.value;this.assertRequestHandlerCapability(s),this._requestHandlers.set(s,(r,n)=>Promise.resolve(t(e.parse(r),n)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,s=>Promise.resolve(t(e.parse(s))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function vn(a,e){return Object.entries(e).reduce((t,[s,r])=>(r&&typeof r=="object"?t[s]=t[s]?{...t[s],...r}:r:t[s]=r,t),{...a})}var _i=Al(yi(),1),pa=class extends Qt{constructor(e,t){var s;super(t),this._serverInfo=e,this._loggingLevels=new Map,this.LOG_LEVEL_SEVERITY=new Map(Tt.options.map((r,n)=>[r,n])),this.isMessageIgnored=(r,n)=>{let o=this._loggingLevels.get(n);return o?this.LOG_LEVEL_SEVERITY.get(r)<this.LOG_LEVEL_SEVERITY.get(o):!1},this._capabilities=(s=t?.capabilities)!==null&&s!==void 0?s:{},this._instructions=t?.instructions,this.setRequestHandler(ka,r=>this._oninitialize(r)),this.setNotificationHandler(La,()=>{var r;return(r=this.oninitialized)===null||r===void 0?void 0:r.call(this)}),this._capabilities.logging&&this.setRequestHandler(Va,async(r,n)=>{var o;let l=n.sessionId||((o=n.requestInfo)===null||o===void 0?void 0:o.headers["mcp-session-id"])||void 0,{level:c}=r.params,u=Tt.safeParse(c);return u.success&&this._loggingLevels.set(l,u.data),{}})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=vn(this._capabilities,e)}assertCapabilityForMethod(e){var t,s,r;switch(e){case"sampling/createMessage":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"elicitation/create":if(!(!((s=this._clientCapabilities)===null||s===void 0)&&s.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case"roots/list":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let t=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Ks.includes(t)?t:$a,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},zt)}async createMessage(e,t){return this.request({method:"sampling/createMessage",params:e},Ha,t)}async elicitInput(e,t){let s=await this.request({method:"elicitation/create",params:e},Ba,t);if(s.action==="accept"&&s.content)try{let r=new _i.default,n=r.compile(e.requestedSchema);if(!n(s.content))throw new We(Ge.InvalidParams,`Elicitation response content does not match requested schema: ${r.errorsText(n.errors)}`)}catch(r){throw r instanceof We?r:new We(Ge.InternalError,`Error validating elicitation response: ${r}`)}return s}async listRoots(e,t){return this.request({method:"roots/list",params:e},Za,t)}async sendLoggingMessage(e,t){if(this._capabilities.logging&&!this.isMessageIgnored(e.level,t))return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};import bi from"node:process";var ha=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let t=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),vf(t)}clear(){this._buffer=void 0}};function vf(a){return ln.parse(JSON.parse(a))}function Ei(a){return JSON.stringify(a)+`
`}var ma=class{constructor(e=bi.stdin,t=bi.stdout){this._stdin=e,this._stdout=t,this._readBuffer=new ha,this._started=!1,this._ondata=s=>{this._readBuffer.append(s),this.processReadBuffer()},this._onerror=s=>{var r;(r=this.onerror)===null||r===void 0||r.call(this,s)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(var e,t;;)try{let s=this._readBuffer.readMessage();if(s===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,s)}catch(s){(t=this.onerror)===null||t===void 0||t.call(this,s)}}async close(){var e;this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),(e=this.onclose)===null||e===void 0||e.call(this)}send(e){return new Promise(t=>{let s=Ei(e);this._stdout.write(s)?t():this._stdout.once("drain",t)})}};var xi=Symbol("Let zodToJsonSchema decide on which parser to use");var Si={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},Ri=a=>typeof a=="string"?{...Si,name:a}:{...Si,...a};var Pi=a=>{let e=Ri(a),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,flags:{hasReferencedOpenAiAnyType:!1},currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([s,r])=>[r._def,{def:r._def,path:[...e.basePath,e.definitionPath,s],jsonSchema:void 0}]))}};function gs(a,e,t,s){s?.errorMessages&&t&&(a.errorMessage={...a.errorMessage,[e]:t})}function ee(a,e,t,s,r){a[e]=t,gs(a,e,s,r)}var va=(a,e)=>{let t=0;for(;t<a.length&&t<e.length&&a[t]===e[t];t++);return[(a.length-t).toString(),...e.slice(t)].join("/")};function fe(a){if(a.target!=="openAi")return{};let e=[...a.basePath,a.definitionPath,a.openAiAnyTypeName];return a.flags.hasReferencedOpenAiAnyType=!0,{$ref:a.$refStrategy==="relative"?va(e,a.currentPath):e.join("/")}}function Ti(a,e){let t={type:"array"};return a.type?._def&&a.type?._def?.typeName!==w.ZodAny&&(t.items=Z(a.type._def,{...e,currentPath:[...e.currentPath,"items"]})),a.minLength&&ee(t,"minItems",a.minLength.value,a.minLength.message,e),a.maxLength&&ee(t,"maxItems",a.maxLength.value,a.maxLength.message,e),a.exactLength&&(ee(t,"minItems",a.exactLength.value,a.exactLength.message,e),ee(t,"maxItems",a.exactLength.value,a.exactLength.message,e)),t}function Oi(a,e){let t={type:"integer",format:"int64"};if(!a.checks)return t;for(let s of a.checks)switch(s.kind){case"min":e.target==="jsonSchema7"?s.inclusive?ee(t,"minimum",s.value,s.message,e):ee(t,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(t.exclusiveMinimum=!0),ee(t,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?ee(t,"maximum",s.value,s.message,e):ee(t,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(t.exclusiveMaximum=!0),ee(t,"maximum",s.value,s.message,e));break;case"multipleOf":ee(t,"multipleOf",s.value,s.message,e);break}return t}function wi(){return{type:"boolean"}}function ga(a,e){return Z(a.type._def,e)}var Ii=(a,e)=>Z(a.innerType._def,e);function ys(a,e,t){let s=t??e.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((r,n)=>ys(a,e,r))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return gf(a,e)}}var gf=(a,e)=>{let t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(let s of a.checks)switch(s.kind){case"min":ee(t,"minimum",s.value,s.message,e);break;case"max":ee(t,"maximum",s.value,s.message,e);break}return t};function Ai(a,e){return{...Z(a.innerType._def,e),default:a.defaultValue()}}function Ni(a,e){return e.effectStrategy==="input"?Z(a.schema._def,e):fe(e)}function Di(a){return{type:"string",enum:Array.from(a.values)}}var yf=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function $i(a,e){let t=[Z(a.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Z(a.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n),s=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,r=[];return t.forEach(n=>{if(yf(n))r.push(...n.allOf),n.unevaluatedProperties===void 0&&(s=void 0);else{let o=n;if("additionalProperties"in n&&n.additionalProperties===!1){let{additionalProperties:l,...c}=n;o=c}else s=void 0;r.push(o)}}),r.length?{allOf:r,...s}:void 0}function Ci(a,e){let t=typeof a.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(a.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[a.value]}:{type:t==="bigint"?"integer":t,const:a.value}}var _s,Ke={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(_s===void 0&&(_s=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),_s),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ya(a,e){let t={type:"string"};if(a.checks)for(let s of a.checks)switch(s.kind){case"min":ee(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e);break;case"max":ee(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Je(t,"email",s.message,e);break;case"format:idn-email":Je(t,"idn-email",s.message,e);break;case"pattern:zod":Ne(t,Ke.email,s.message,e);break}break;case"url":Je(t,"uri",s.message,e);break;case"uuid":Je(t,"uuid",s.message,e);break;case"regex":Ne(t,s.regex,s.message,e);break;case"cuid":Ne(t,Ke.cuid,s.message,e);break;case"cuid2":Ne(t,Ke.cuid2,s.message,e);break;case"startsWith":Ne(t,RegExp(`^${Es(s.value,e)}`),s.message,e);break;case"endsWith":Ne(t,RegExp(`${Es(s.value,e)}$`),s.message,e);break;case"datetime":Je(t,"date-time",s.message,e);break;case"date":Je(t,"date",s.message,e);break;case"time":Je(t,"time",s.message,e);break;case"duration":Je(t,"duration",s.message,e);break;case"length":ee(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e),ee(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"includes":{Ne(t,RegExp(Es(s.value,e)),s.message,e);break}case"ip":{s.version!=="v6"&&Je(t,"ipv4",s.message,e),s.version!=="v4"&&Je(t,"ipv6",s.message,e);break}case"base64url":Ne(t,Ke.base64url,s.message,e);break;case"jwt":Ne(t,Ke.jwt,s.message,e);break;case"cidr":{s.version!=="v6"&&Ne(t,Ke.ipv4Cidr,s.message,e),s.version!=="v4"&&Ne(t,Ke.ipv6Cidr,s.message,e);break}case"emoji":Ne(t,Ke.emoji(),s.message,e);break;case"ulid":{Ne(t,Ke.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Je(t,"binary",s.message,e);break}case"contentEncoding:base64":{ee(t,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{Ne(t,Ke.base64,s.message,e);break}}break}case"nanoid":Ne(t,Ke.nanoid,s.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return t}function Es(a,e){return e.patternStrategy==="escape"?Ef(a):a}var _f=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Ef(a){let e="";for(let t=0;t<a.length;t++)_f.has(a[t])||(e+="\\"),e+=a[t];return e}function Je(a,e,t,s){a.format||a.anyOf?.some(r=>r.format)?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format,...a.errorMessage&&s.errorMessages&&{errorMessage:{format:a.errorMessage.format}}}),delete a.format,a.errorMessage&&(delete a.errorMessage.format,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.anyOf.push({format:e,...t&&s.errorMessages&&{errorMessage:{format:t}}})):ee(a,"format",e,t,s)}function Ne(a,e,t,s){a.pattern||a.allOf?.some(r=>r.pattern)?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern,...a.errorMessage&&s.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}}}),delete a.pattern,a.errorMessage&&(delete a.errorMessage.pattern,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.allOf.push({pattern:ki(e,s),...t&&s.errorMessages&&{errorMessage:{pattern:t}}})):ee(a,"pattern",ki(e,s),t,s)}function ki(a,e){if(!e.applyRegexFlags||!a.flags)return a.source;let t={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},s=t.i?a.source.toLowerCase():a.source,r="",n=!1,o=!1,l=!1;for(let c=0;c<s.length;c++){if(n){r+=s[c],n=!1;continue}if(t.i){if(o){if(s[c].match(/[a-z]/)){l?(r+=s[c],r+=`${s[c-2]}-${s[c]}`.toUpperCase(),l=!1):s[c+1]==="-"&&s[c+2]?.match(/[a-z]/)?(r+=s[c],l=!0):r+=`${s[c]}${s[c].toUpperCase()}`;continue}}else if(s[c].match(/[a-z]/)){r+=`[${s[c]}${s[c].toUpperCase()}]`;continue}}if(t.m){if(s[c]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(s[c]==="$"){r+=`($|(?=[\r
]))`;continue}}if(t.s&&s[c]==="."){r+=o?`${s[c]}\r
`:`[${s[c]}\r
]`;continue}r+=s[c],s[c]==="\\"?n=!0:o&&s[c]==="]"?o=!1:!o&&s[c]==="["&&(o=!0)}try{new RegExp(r)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return r}function _a(a,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&a.keyType?._def.typeName===w.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((s,r)=>({...s,[r]:Z(a.valueType._def,{...e,currentPath:[...e.currentPath,"properties",r]})??fe(e)}),{}),additionalProperties:e.rejectedAdditionalProperties};let t={type:"object",additionalProperties:Z(a.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(a.keyType?._def.typeName===w.ZodString&&a.keyType._def.checks?.length){let{type:s,...r}=ya(a.keyType._def,e);return{...t,propertyNames:r}}else{if(a.keyType?._def.typeName===w.ZodEnum)return{...t,propertyNames:{enum:a.keyType._def.values}};if(a.keyType?._def.typeName===w.ZodBranded&&a.keyType._def.type._def.typeName===w.ZodString&&a.keyType._def.type._def.checks?.length){let{type:s,...r}=ga(a.keyType._def,e);return{...t,propertyNames:r}}}return t}function Li(a,e){if(e.mapStrategy==="record")return _a(a,e);let t=Z(a.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||fe(e),s=Z(a.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||fe(e);return{type:"array",maxItems:125,items:{type:"array",items:[t,s],minItems:2,maxItems:2}}}function ji(a){let e=a.values,s=Object.keys(a.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),r=Array.from(new Set(s.map(n=>typeof n)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:s}}function Fi(a){return a.target==="openAi"?void 0:{not:fe({...a,currentPath:[...a.currentPath,"not"]})}}function Mi(a){return a.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var wt={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Ui(a,e){if(e.target==="openApi3")return qi(a,e);let t=a.options instanceof Map?Array.from(a.options.values()):a.options;if(t.every(s=>s._def.typeName in wt&&(!s._def.checks||!s._def.checks.length))){let s=t.reduce((r,n)=>{let o=wt[n._def.typeName];return o&&!r.includes(o)?[...r,o]:r},[]);return{type:s.length>1?s:s[0]}}else if(t.every(s=>s._def.typeName==="ZodLiteral"&&!s.description)){let s=t.reduce((r,n)=>{let o=typeof n._def.value;switch(o){case"string":case"number":case"boolean":return[...r,o];case"bigint":return[...r,"integer"];case"object":if(n._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(s.length===t.length){let r=s.filter((n,o,l)=>l.indexOf(n)===o);return{type:r.length>1?r:r[0],enum:t.reduce((n,o)=>n.includes(o._def.value)?n:[...n,o._def.value],[])}}}else if(t.every(s=>s._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((s,r)=>[...s,...r._def.values.filter(n=>!s.includes(n))],[])};return qi(a,e)}var qi=(a,e)=>{let t=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((s,r)=>Z(s._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(s=>!!s&&(!e.strictUnions||typeof s=="object"&&Object.keys(s).length>0));return t.length?{anyOf:t}:void 0};function zi(a,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(a.innerType._def.typeName)&&(!a.innerType._def.checks||!a.innerType._def.checks.length))return e.target==="openApi3"?{type:wt[a.innerType._def.typeName],nullable:!0}:{type:[wt[a.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let s=Z(a.innerType._def,{...e,currentPath:[...e.currentPath]});return s&&"$ref"in s?{allOf:[s],nullable:!0}:s&&{...s,nullable:!0}}let t=Z(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function Vi(a,e){let t={type:"number"};if(!a.checks)return t;for(let s of a.checks)switch(s.kind){case"int":t.type="integer",gs(t,"type",s.message,e);break;case"min":e.target==="jsonSchema7"?s.inclusive?ee(t,"minimum",s.value,s.message,e):ee(t,"exclusiveMinimum",s.value,s.message,e):(s.inclusive||(t.exclusiveMinimum=!0),ee(t,"minimum",s.value,s.message,e));break;case"max":e.target==="jsonSchema7"?s.inclusive?ee(t,"maximum",s.value,s.message,e):ee(t,"exclusiveMaximum",s.value,s.message,e):(s.inclusive||(t.exclusiveMaximum=!0),ee(t,"maximum",s.value,s.message,e));break;case"multipleOf":ee(t,"multipleOf",s.value,s.message,e);break}return t}function Hi(a,e){let t=e.target==="openAi",s={type:"object",properties:{}},r=[],n=a.shape();for(let l in n){let c=n[l];if(c===void 0||c._def===void 0)continue;let u=Sf(c);u&&t&&(c._def.typeName==="ZodOptional"&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);let p=Z(c._def,{...e,currentPath:[...e.currentPath,"properties",l],propertyPath:[...e.currentPath,"properties",l]});p!==void 0&&(s.properties[l]=p,u||r.push(l))}r.length&&(s.required=r);let o=bf(a,e);return o!==void 0&&(s.additionalProperties=o),s}function bf(a,e){if(a.catchall._def.typeName!=="ZodNever")return Z(a.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(a.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function Sf(a){try{return a.isOptional()}catch{return!0}}var Bi=(a,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Z(a.innerType._def,e);let t=Z(a.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:fe(e)},t]}:fe(e)};var Zi=(a,e)=>{if(e.pipeStrategy==="input")return Z(a.in._def,e);if(e.pipeStrategy==="output")return Z(a.out._def,e);let t=Z(a.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),s=Z(a.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,s].filter(r=>r!==void 0)}};function Xi(a,e){return Z(a.type._def,e)}function Qi(a,e){let s={type:"array",uniqueItems:!0,items:Z(a.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return a.minSize&&ee(s,"minItems",a.minSize.value,a.minSize.message,e),a.maxSize&&ee(s,"maxItems",a.maxSize.value,a.maxSize.message,e),s}function Gi(a,e){return a.rest?{type:"array",minItems:a.items.length,items:a.items.map((t,s)=>Z(t._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((t,s)=>s===void 0?t:[...t,s],[]),additionalItems:Z(a.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:a.items.length,maxItems:a.items.length,items:a.items.map((t,s)=>Z(t._def,{...e,currentPath:[...e.currentPath,"items",`${s}`]})).reduce((t,s)=>s===void 0?t:[...t,s],[])}}function Wi(a){return{not:fe(a)}}function Ki(a){return fe(a)}var Ji=(a,e)=>Z(a.innerType._def,e);var Yi=(a,e,t)=>{switch(e){case w.ZodString:return ya(a,t);case w.ZodNumber:return Vi(a,t);case w.ZodObject:return Hi(a,t);case w.ZodBigInt:return Oi(a,t);case w.ZodBoolean:return wi();case w.ZodDate:return ys(a,t);case w.ZodUndefined:return Wi(t);case w.ZodNull:return Mi(t);case w.ZodArray:return Ti(a,t);case w.ZodUnion:case w.ZodDiscriminatedUnion:return Ui(a,t);case w.ZodIntersection:return $i(a,t);case w.ZodTuple:return Gi(a,t);case w.ZodRecord:return _a(a,t);case w.ZodLiteral:return Ci(a,t);case w.ZodEnum:return Di(a);case w.ZodNativeEnum:return ji(a);case w.ZodNullable:return zi(a,t);case w.ZodOptional:return Bi(a,t);case w.ZodMap:return Li(a,t);case w.ZodSet:return Qi(a,t);case w.ZodLazy:return()=>a.getter()._def;case w.ZodPromise:return Xi(a,t);case w.ZodNaN:case w.ZodNever:return Fi(t);case w.ZodEffects:return Ni(a,t);case w.ZodAny:return fe(t);case w.ZodUnknown:return Ki(t);case w.ZodDefault:return Ai(a,t);case w.ZodBranded:return ga(a,t);case w.ZodReadonly:return Ji(a,t);case w.ZodCatch:return Ii(a,t);case w.ZodPipeline:return Zi(a,t);case w.ZodFunction:case w.ZodVoid:case w.ZodSymbol:return;default:return(s=>{})(e)}};function Z(a,e,t=!1){let s=e.seen.get(a);if(e.override){let l=e.override?.(a,e,s,t);if(l!==xi)return l}if(s&&!t){let l=xf(s,e);if(l!==void 0)return l}let r={def:a,path:e.currentPath,jsonSchema:void 0};e.seen.set(a,r);let n=Yi(a,a.typeName,e),o=typeof n=="function"?Z(n(),e):n;if(o&&Rf(a,e,o),e.postProcess){let l=e.postProcess(o,a,e);return r.jsonSchema=o,l}return r.jsonSchema=o,o}var xf=(a,e)=>{switch(e.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:va(e.currentPath,a.path)};case"none":case"seen":return a.path.length<e.currentPath.length&&a.path.every((t,s)=>e.currentPath[s]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),fe(e)):e.$refStrategy==="seen"?fe(e):void 0}},Rf=(a,e,t)=>(a.description&&(t.description=a.description,e.markdownDescription&&(t.markdownDescription=a.description)),t);var bs=(a,e)=>{let t=Pi(e),s=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((c,[u,p])=>({...c,[u]:Z(p._def,{...t,currentPath:[...t.basePath,t.definitionPath,u]},!0)??fe(t)}),{}):void 0,r=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=Z(a._def,r===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,r]},!1)??fe(t),o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(n.title=o),t.flags.hasReferencedOpenAiAnyType&&(s||(s={}),s[t.openAiAnyTypeName]||(s[t.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:t.$refStrategy==="relative"?"1":[...t.basePath,t.definitionPath,t.openAiAnyTypeName].join("/")}}));let l=r===void 0?s?{...n,[t.definitionPath]:s}:n:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...s,[r]:n}};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in l||"oneOf"in l||"allOf"in l||"type"in l&&Array.isArray(l.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),l};import{basename as Nf}from"path";import If from"better-sqlite3";import{join as Ye,dirname as Pf,basename as vg}from"path";import{homedir as el}from"os";import{existsSync as Eg,mkdirSync as Tf}from"fs";import{fileURLToPath as Of}from"url";function wf(){return typeof __dirname<"u"?__dirname:Pf(Of(import.meta.url))}var Sg=wf(),ir=process.env.CLAUDE_MEM_DATA_DIR||Ye(el(),".claude-mem"),Ss=process.env.CLAUDE_CONFIG_DIR||Ye(el(),".claude"),xg=Ye(ir,"archives"),Rg=Ye(ir,"logs"),Pg=Ye(ir,"trash"),Tg=Ye(ir,"backups"),Og=Ye(ir,"settings.json"),Ea=Ye(ir,"claude-mem.db"),wg=Ye(Ss,"settings.json"),Ig=Ye(Ss,"commands"),Ag=Ye(Ss,"CLAUDE.md");function ba(a){Tf(a,{recursive:!0})}var Sa=class{db;constructor(e){e||(ba(ir),e=Ea),this.db=new If(e),this.db.pragma("journal_mode = WAL"),this.ensureFTSTables()}ensureFTSTables(){try{if(this.db.prepare("SELECT name FROM sqlite_master WHERE type='table' AND name LIKE '%_fts'").all().some(s=>s.name==="observations_fts"||s.name==="session_summaries_fts"))return;console.error("[SessionSearch] Creating FTS5 tables..."),this.db.exec(`
        CREATE VIRTUAL TABLE IF NOT EXISTS observations_fts USING fts5(
          title,
          subtitle,
          narrative,
          text,
          facts,
          concepts,
          content='observations',
          content_rowid='id'
        );
      `),this.db.exec(`
        INSERT INTO observations_fts(rowid, title, subtitle, narrative, text, facts, concepts)
        SELECT id, title, subtitle, narrative, text, facts, concepts
        FROM observations;
      `),this.db.exec(`
        CREATE TRIGGER IF NOT EXISTS observations_ai AFTER INSERT ON observations BEGIN
          INSERT INTO observations_fts(rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES (new.id, new.title, new.subtitle, new.narrative, new.text, new.facts, new.concepts);
        END;

        CREATE TRIGGER IF NOT EXISTS observations_ad AFTER DELETE ON observations BEGIN
          INSERT INTO observations_fts(observations_fts, rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES('delete', old.id, old.title, old.subtitle, old.narrative, old.text, old.facts, old.concepts);
        END;

        CREATE TRIGGER IF NOT EXISTS observations_au AFTER UPDATE ON observations BEGIN
          INSERT INTO observations_fts(observations_fts, rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES('delete', old.id, old.title, old.subtitle, old.narrative, old.text, old.facts, old.concepts);
          INSERT INTO observations_fts(rowid, title, subtitle, narrative, text, facts, concepts)
          VALUES (new.id, new.title, new.subtitle, new.narrative, new.text, new.facts, new.concepts);
        END;
      `),this.db.exec(`
        CREATE VIRTUAL TABLE IF NOT EXISTS session_summaries_fts USING fts5(
          request,
          investigated,
          learned,
          completed,
          next_steps,
          notes,
          content='session_summaries',
          content_rowid='id'
        );
      `),this.db.exec(`
        INSERT INTO session_summaries_fts(rowid, request, investigated, learned, completed, next_steps, notes)
        SELECT id, request, investigated, learned, completed, next_steps, notes
        FROM session_summaries;
      `),this.db.exec(`
        CREATE TRIGGER IF NOT EXISTS session_summaries_ai AFTER INSERT ON session_summaries BEGIN
          INSERT INTO session_summaries_fts(rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES (new.id, new.request, new.investigated, new.learned, new.completed, new.next_steps, new.notes);
        END;

        CREATE TRIGGER IF NOT EXISTS session_summaries_ad AFTER DELETE ON session_summaries BEGIN
          INSERT INTO session_summaries_fts(session_summaries_fts, rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES('delete', old.id, old.request, old.investigated, old.learned, old.completed, old.next_steps, old.notes);
        END;

        CREATE TRIGGER IF NOT EXISTS session_summaries_au AFTER UPDATE ON session_summaries BEGIN
          INSERT INTO session_summaries_fts(session_summaries_fts, rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES('delete', old.id, old.request, old.investigated, old.learned, old.completed, old.next_steps, old.notes);
          INSERT INTO session_summaries_fts(rowid, request, investigated, learned, completed, next_steps, notes)
          VALUES (new.id, new.request, new.investigated, new.learned, new.completed, new.next_steps, new.notes);
        END;
      `),console.error("[SessionSearch] FTS5 tables created successfully")}catch(e){console.error("[SessionSearch] FTS migration error:",e.message)}}escapeFTS5(e){return e}buildFilterClause(e,t,s="o"){let r=[];if(e.project&&(r.push(`${s}.project = ?`),t.push(e.project)),e.type)if(Array.isArray(e.type)){let n=e.type.map(()=>"?").join(",");r.push(`${s}.type IN (${n})`),t.push(...e.type)}else r.push(`${s}.type = ?`),t.push(e.type);if(e.dateRange){let{start:n,end:o}=e.dateRange;if(n){let l=typeof n=="number"?n:new Date(n).getTime();r.push(`${s}.created_at_epoch >= ?`),t.push(l)}if(o){let l=typeof o=="number"?o:new Date(o).getTime();r.push(`${s}.created_at_epoch <= ?`),t.push(l)}}if(e.concepts){let n=Array.isArray(e.concepts)?e.concepts:[e.concepts],o=n.map(()=>`EXISTS (SELECT 1 FROM json_each(${s}.concepts) WHERE value = ?)`);o.length>0&&(r.push(`(${o.join(" OR ")})`),t.push(...n))}if(e.files){let n=Array.isArray(e.files)?e.files:[e.files],o=n.map(()=>`(
          EXISTS (SELECT 1 FROM json_each(${s}.files_read) WHERE value LIKE ?)
          OR EXISTS (SELECT 1 FROM json_each(${s}.files_modified) WHERE value LIKE ?)
        )`);o.length>0&&(r.push(`(${o.join(" OR ")})`),n.forEach(l=>{t.push(`%${l}%`,`%${l}%`)}))}return r.length>0?r.join(" AND "):""}buildOrderClause(e="relevance",t=!0,s="observations_fts"){switch(e){case"relevance":return t?`ORDER BY ${s}.rank ASC`:"ORDER BY o.created_at_epoch DESC";case"date_desc":return"ORDER BY o.created_at_epoch DESC";case"date_asc":return"ORDER BY o.created_at_epoch ASC";default:return"ORDER BY o.created_at_epoch DESC"}}searchObservations(e,t={}){let s=[],{limit:r=50,offset:n=0,orderBy:o="relevance",...l}=t,c=this.escapeFTS5(e);s.push(c);let u=this.buildFilterClause(l,s,"o"),p=u?`AND ${u}`:"",m=this.buildOrderClause(o,!0),E=`
      SELECT
        o.*,
        observations_fts.rank as rank
      FROM observations o
      JOIN observations_fts ON o.id = observations_fts.rowid
      WHERE observations_fts MATCH ?
      ${p}
      ${m}
      LIMIT ? OFFSET ?
    `;s.push(r,n);let d=this.db.prepare(E).all(...s);if(d.length>0){let g=Math.min(...d.map(S=>S.rank||0)),v=Math.max(...d.map(S=>S.rank||0))-g||1;d.forEach(S=>{S.rank!==void 0&&(S.score=1-(S.rank-g)/v)})}return d}searchSessions(e,t={}){let s=[],{limit:r=50,offset:n=0,orderBy:o="relevance",...l}=t,c=this.escapeFTS5(e);s.push(c);let u={...l};delete u.type;let p=this.buildFilterClause(u,s,"s"),g=`
      SELECT
        s.*,
        session_summaries_fts.rank as rank
      FROM session_summaries s
      JOIN session_summaries_fts ON s.id = session_summaries_fts.rowid
      WHERE session_summaries_fts MATCH ?
      ${(p?`AND ${p}`:"").replace(/files_read/g,"files_read").replace(/files_modified/g,"files_edited")}
      ${o==="relevance"?"ORDER BY session_summaries_fts.rank ASC":o==="date_asc"?"ORDER BY s.created_at_epoch ASC":"ORDER BY s.created_at_epoch DESC"}
      LIMIT ? OFFSET ?
    `;s.push(r,n);let _=this.db.prepare(g).all(...s);if(_.length>0){let v=Math.min(..._.map(R=>R.rank||0)),O=Math.max(..._.map(R=>R.rank||0))-v||1;_.forEach(R=>{R.rank!==void 0&&(R.score=1-(R.rank-v)/O)})}return _}findByConcept(e,t={}){let s=[],r={...t,concepts:e},o=`
      SELECT o.*
      FROM observations o
      WHERE ${this.buildFilterClause(r,s,"o")}
      ORDER BY o.created_at_epoch DESC
    `;return this.db.prepare(o).all(...s)}findByFile(e,t={}){let s=[],r={...t,files:e},o=`
      SELECT o.*
      FROM observations o
      WHERE ${this.buildFilterClause(r,s,"o")}
      ORDER BY o.created_at_epoch DESC
    `,l=this.db.prepare(o).all(...s),c=[],u={...t};delete u.type;let p=[];if(u.project&&(p.push("s.project = ?"),c.push(u.project)),u.dateRange){let{start:d,end:g}=u.dateRange;if(d){let _=typeof d=="number"?d:new Date(d).getTime();p.push("s.created_at_epoch >= ?"),c.push(_)}if(g){let _=typeof g=="number"?g:new Date(g).getTime();p.push("s.created_at_epoch <= ?"),c.push(_)}}p.push(`(
      EXISTS (SELECT 1 FROM json_each(s.files_read) WHERE value LIKE ?)
      OR EXISTS (SELECT 1 FROM json_each(s.files_edited) WHERE value LIKE ?)
    )`),c.push(`%${e}%`,`%${e}%`);let m=`
      SELECT s.*
      FROM session_summaries s
      WHERE ${p.join(" AND ")}
      ORDER BY s.created_at_epoch DESC
    `,E=this.db.prepare(m).all(...c);return{observations:l,sessions:E}}findByType(e,t={}){let s=[],r={...t,type:e},o=`
      SELECT o.*
      FROM observations o
      WHERE ${this.buildFilterClause(r,s,"o")}
      ORDER BY o.created_at_epoch DESC
    `;return this.db.prepare(o).all(...s)}advancedSearch(e){let{textQuery:t,searchSessions:s=!0,...r}=e,n=[],o=[];if(t)n=this.searchObservations(t,r),s&&(o=this.searchSessions(t,r));else{let l=[],c=this.buildFilterClause(r,l,"o");if(c){let u=`
          SELECT o.*
          FROM observations o
          WHERE ${c}
          ${this.buildOrderClause(r.orderBy,!1)}
          LIMIT ? OFFSET ?
        `;l.push(r.limit||50,r.offset||0),n=this.db.prepare(u).all(...l)}if(s){let u=[],p={...r};delete p.type;let m=this.buildFilterClause(p,u,"s");if(m){let E=`
            SELECT s.*
            FROM session_summaries s
            WHERE ${m}
            ORDER BY s.created_at_epoch DESC
            LIMIT ? OFFSET ?
          `;u.push(r.limit||50,r.offset||0),o=this.db.prepare(E).all(...u)}}}return{observations:n,sessions:o}}close(){this.db.close()}};import Af from"better-sqlite3";var xs=(n=>(n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.WARN=2]="WARN",n[n.ERROR=3]="ERROR",n[n.SILENT=4]="SILENT",n))(xs||{}),Rs=class{level;useColor;constructor(){let e=process.env.CLAUDE_MEM_LOG_LEVEL?.toUpperCase()||"INFO";this.level=xs[e]??1,this.useColor=process.stdout.isTTY??!1}correlationId(e,t){return`obs-${e}-${t}`}sessionId(e){return`session-${e}`}formatData(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="object"){if(e instanceof Error)return this.level===0?`${e.message}
${e.stack}`:e.message;if(Array.isArray(e))return`[${e.length} items]`;let t=Object.keys(e);return t.length===0?"{}":t.length<=3?JSON.stringify(e):`{${t.length} keys: ${t.slice(0,3).join(", ")}...}`}return String(e)}formatTool(e,t){if(!t)return e;try{let s=typeof t=="string"?JSON.parse(t):t;if(e==="Bash"&&s.command){let r=s.command.length>50?s.command.substring(0,50)+"...":s.command;return`${e}(${r})`}if(e==="Read"&&s.file_path){let r=s.file_path.split("/").pop()||s.file_path;return`${e}(${r})`}if(e==="Edit"&&s.file_path){let r=s.file_path.split("/").pop()||s.file_path;return`${e}(${r})`}if(e==="Write"&&s.file_path){let r=s.file_path.split("/").pop()||s.file_path;return`${e}(${r})`}return e}catch{return e}}log(e,t,s,r,n){if(e<this.level)return;let o=new Date().toISOString().replace("T"," ").substring(0,23),l=xs[e].padEnd(5),c=t.padEnd(6),u="";r?.correlationId?u=`[${r.correlationId}] `:r?.sessionId&&(u=`[session-${r.sessionId}] `);let p="";n!=null&&(this.level===0&&typeof n=="object"?p=`
`+JSON.stringify(n,null,2):p=" "+this.formatData(n));let m="";if(r){let{sessionId:d,sdkSessionId:g,correlationId:_,...v}=r;Object.keys(v).length>0&&(m=` {${Object.entries(v).map(([O,R])=>`${O}=${R}`).join(", ")}}`)}let E=`[${o}] [${l}] [${c}] ${u}${s}${m}${p}`;e===3?console.error(E):console.log(E)}debug(e,t,s,r){this.log(0,e,t,s,r)}info(e,t,s,r){this.log(1,e,t,s,r)}warn(e,t,s,r){this.log(2,e,t,s,r)}error(e,t,s,r){this.log(3,e,t,s,r)}dataIn(e,t,s,r){this.info(e,`\u2192 ${t}`,s,r)}dataOut(e,t,s,r){this.info(e,`\u2190 ${t}`,s,r)}success(e,t,s,r){this.info(e,`\u2713 ${t}`,s,r)}failure(e,t,s,r){this.error(e,`\u2717 ${t}`,s,r)}timing(e,t,s,r){this.info(e,`\u23F1 ${t}`,r,{duration:`${s}ms`})}},rl=new Rs;var xa=class{db;constructor(){ba(ir),this.db=new Af(Ea),this.db.pragma("journal_mode = WAL"),this.db.pragma("synchronous = NORMAL"),this.db.pragma("foreign_keys = ON"),this.initializeSchema(),this.ensureWorkerPortColumn(),this.ensurePromptTrackingColumns(),this.removeSessionSummariesUniqueConstraint(),this.addObservationHierarchicalFields(),this.makeObservationsTextNullable()}initializeSchema(){try{this.db.exec(`
        CREATE TABLE IF NOT EXISTS schema_versions (
          id INTEGER PRIMARY KEY,
          version INTEGER UNIQUE NOT NULL,
          applied_at TEXT NOT NULL
        )
      `);let e=this.db.prepare("SELECT version FROM schema_versions ORDER BY version").all();(e.length>0?Math.max(...e.map(s=>s.version)):0)===0&&(console.error("[SessionStore] Initializing fresh database with migration004..."),this.db.exec(`
          CREATE TABLE IF NOT EXISTS sdk_sessions (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            claude_session_id TEXT UNIQUE NOT NULL,
            sdk_session_id TEXT UNIQUE,
            project TEXT NOT NULL,
            user_prompt TEXT,
            started_at TEXT NOT NULL,
            started_at_epoch INTEGER NOT NULL,
            completed_at TEXT,
            completed_at_epoch INTEGER,
            status TEXT CHECK(status IN ('active', 'completed', 'failed')) NOT NULL DEFAULT 'active'
          );

          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_claude_id ON sdk_sessions(claude_session_id);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_sdk_id ON sdk_sessions(sdk_session_id);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_project ON sdk_sessions(project);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_status ON sdk_sessions(status);
          CREATE INDEX IF NOT EXISTS idx_sdk_sessions_started ON sdk_sessions(started_at_epoch DESC);

          CREATE TABLE IF NOT EXISTS observations (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT NOT NULL,
            project TEXT NOT NULL,
            text TEXT NOT NULL,
            type TEXT NOT NULL CHECK(type IN ('decision', 'bugfix', 'feature', 'refactor', 'discovery')),
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          );

          CREATE INDEX IF NOT EXISTS idx_observations_sdk_session ON observations(sdk_session_id);
          CREATE INDEX IF NOT EXISTS idx_observations_project ON observations(project);
          CREATE INDEX IF NOT EXISTS idx_observations_type ON observations(type);
          CREATE INDEX IF NOT EXISTS idx_observations_created ON observations(created_at_epoch DESC);

          CREATE TABLE IF NOT EXISTS session_summaries (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT UNIQUE NOT NULL,
            project TEXT NOT NULL,
            request TEXT,
            investigated TEXT,
            learned TEXT,
            completed TEXT,
            next_steps TEXT,
            files_read TEXT,
            files_edited TEXT,
            notes TEXT,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          );

          CREATE INDEX IF NOT EXISTS idx_session_summaries_sdk_session ON session_summaries(sdk_session_id);
          CREATE INDEX IF NOT EXISTS idx_session_summaries_project ON session_summaries(project);
          CREATE INDEX IF NOT EXISTS idx_session_summaries_created ON session_summaries(created_at_epoch DESC);
        `),this.db.prepare("INSERT INTO schema_versions (version, applied_at) VALUES (?, ?)").run(4,new Date().toISOString()),console.error("[SessionStore] Migration004 applied successfully"))}catch(e){throw console.error("[SessionStore] Schema initialization error:",e.message),e}}ensureWorkerPortColumn(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(5))return;this.db.pragma("table_info(sdk_sessions)").some(r=>r.name==="worker_port")||(this.db.exec("ALTER TABLE sdk_sessions ADD COLUMN worker_port INTEGER"),console.error("[SessionStore] Added worker_port column to sdk_sessions table")),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(5,new Date().toISOString())}catch(e){console.error("[SessionStore] Migration error:",e.message)}}ensurePromptTrackingColumns(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(6))return;this.db.pragma("table_info(sdk_sessions)").some(c=>c.name==="prompt_counter")||(this.db.exec("ALTER TABLE sdk_sessions ADD COLUMN prompt_counter INTEGER DEFAULT 0"),console.error("[SessionStore] Added prompt_counter column to sdk_sessions table")),this.db.pragma("table_info(observations)").some(c=>c.name==="prompt_number")||(this.db.exec("ALTER TABLE observations ADD COLUMN prompt_number INTEGER"),console.error("[SessionStore] Added prompt_number column to observations table")),this.db.pragma("table_info(session_summaries)").some(c=>c.name==="prompt_number")||(this.db.exec("ALTER TABLE session_summaries ADD COLUMN prompt_number INTEGER"),console.error("[SessionStore] Added prompt_number column to session_summaries table")),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(6,new Date().toISOString())}catch(e){console.error("[SessionStore] Prompt tracking migration error:",e.message)}}removeSessionSummariesUniqueConstraint(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(7))return;if(!this.db.pragma("index_list(session_summaries)").some(r=>r.unique===1)){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(7,new Date().toISOString());return}console.error("[SessionStore] Removing UNIQUE constraint from session_summaries.sdk_session_id..."),this.db.exec("BEGIN TRANSACTION");try{this.db.exec(`
          CREATE TABLE session_summaries_new (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT NOT NULL,
            project TEXT NOT NULL,
            request TEXT,
            investigated TEXT,
            learned TEXT,
            completed TEXT,
            next_steps TEXT,
            files_read TEXT,
            files_edited TEXT,
            notes TEXT,
            prompt_number INTEGER,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          )
        `),this.db.exec(`
          INSERT INTO session_summaries_new
          SELECT id, sdk_session_id, project, request, investigated, learned,
                 completed, next_steps, files_read, files_edited, notes,
                 prompt_number, created_at, created_at_epoch
          FROM session_summaries
        `),this.db.exec("DROP TABLE session_summaries"),this.db.exec("ALTER TABLE session_summaries_new RENAME TO session_summaries"),this.db.exec(`
          CREATE INDEX idx_session_summaries_sdk_session ON session_summaries(sdk_session_id);
          CREATE INDEX idx_session_summaries_project ON session_summaries(project);
          CREATE INDEX idx_session_summaries_created ON session_summaries(created_at_epoch DESC);
        `),this.db.exec("COMMIT"),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(7,new Date().toISOString()),console.error("[SessionStore] Successfully removed UNIQUE constraint from session_summaries.sdk_session_id")}catch(r){throw this.db.exec("ROLLBACK"),r}}catch(e){console.error("[SessionStore] Migration error (remove UNIQUE constraint):",e.message)}}addObservationHierarchicalFields(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(8))return;if(this.db.pragma("table_info(observations)").some(r=>r.name==="title")){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(8,new Date().toISOString());return}console.error("[SessionStore] Adding hierarchical fields to observations table..."),this.db.exec(`
        ALTER TABLE observations ADD COLUMN title TEXT;
        ALTER TABLE observations ADD COLUMN subtitle TEXT;
        ALTER TABLE observations ADD COLUMN facts TEXT;
        ALTER TABLE observations ADD COLUMN narrative TEXT;
        ALTER TABLE observations ADD COLUMN concepts TEXT;
        ALTER TABLE observations ADD COLUMN files_read TEXT;
        ALTER TABLE observations ADD COLUMN files_modified TEXT;
      `),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(8,new Date().toISOString()),console.error("[SessionStore] Successfully added hierarchical fields to observations table")}catch(e){console.error("[SessionStore] Migration error (add hierarchical fields):",e.message)}}makeObservationsTextNullable(){try{if(this.db.prepare("SELECT version FROM schema_versions WHERE version = ?").get(9))return;let s=this.db.pragma("table_info(observations)").find(r=>r.name==="text");if(!s||s.notnull===0){this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(9,new Date().toISOString());return}console.error("[SessionStore] Making observations.text nullable..."),this.db.exec("BEGIN TRANSACTION");try{this.db.exec(`
          CREATE TABLE observations_new (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            sdk_session_id TEXT NOT NULL,
            project TEXT NOT NULL,
            text TEXT,
            type TEXT NOT NULL CHECK(type IN ('decision', 'bugfix', 'feature', 'refactor', 'discovery', 'change')),
            title TEXT,
            subtitle TEXT,
            facts TEXT,
            narrative TEXT,
            concepts TEXT,
            files_read TEXT,
            files_modified TEXT,
            prompt_number INTEGER,
            created_at TEXT NOT NULL,
            created_at_epoch INTEGER NOT NULL,
            FOREIGN KEY(sdk_session_id) REFERENCES sdk_sessions(sdk_session_id) ON DELETE CASCADE
          )
        `),this.db.exec(`
          INSERT INTO observations_new
          SELECT id, sdk_session_id, project, text, type, title, subtitle, facts,
                 narrative, concepts, files_read, files_modified, prompt_number,
                 created_at, created_at_epoch
          FROM observations
        `),this.db.exec("DROP TABLE observations"),this.db.exec("ALTER TABLE observations_new RENAME TO observations"),this.db.exec(`
          CREATE INDEX idx_observations_sdk_session ON observations(sdk_session_id);
          CREATE INDEX idx_observations_project ON observations(project);
          CREATE INDEX idx_observations_type ON observations(type);
          CREATE INDEX idx_observations_created ON observations(created_at_epoch DESC);
        `),this.db.exec("COMMIT"),this.db.prepare("INSERT OR IGNORE INTO schema_versions (version, applied_at) VALUES (?, ?)").run(9,new Date().toISOString()),console.error("[SessionStore] Successfully made observations.text nullable")}catch(r){throw this.db.exec("ROLLBACK"),r}}catch(e){console.error("[SessionStore] Migration error (make text nullable):",e.message)}}getRecentSummaries(e,t=10){return this.db.prepare(`
      SELECT
        request, investigated, learned, completed, next_steps,
        files_read, files_edited, notes, prompt_number, created_at
      FROM session_summaries
      WHERE project = ?
      ORDER BY created_at_epoch DESC
      LIMIT ?
    `).all(e,t)}getRecentObservations(e,t=20){return this.db.prepare(`
      SELECT type, text, prompt_number, created_at
      FROM observations
      WHERE project = ?
      ORDER BY created_at_epoch DESC
      LIMIT ?
    `).all(e,t)}getRecentSessionsWithStatus(e,t=3){return this.db.prepare(`
      SELECT * FROM (
        SELECT
          s.sdk_session_id,
          s.status,
          s.started_at,
          s.started_at_epoch,
          s.user_prompt,
          CASE WHEN sum.sdk_session_id IS NOT NULL THEN 1 ELSE 0 END as has_summary
        FROM sdk_sessions s
        LEFT JOIN session_summaries sum ON s.sdk_session_id = sum.sdk_session_id
        WHERE s.project = ? AND s.sdk_session_id IS NOT NULL
        GROUP BY s.sdk_session_id
        ORDER BY s.started_at_epoch DESC
        LIMIT ?
      )
      ORDER BY started_at_epoch ASC
    `).all(e,t)}getObservationsForSession(e){return this.db.prepare(`
      SELECT title, subtitle, type, prompt_number
      FROM observations
      WHERE sdk_session_id = ?
      ORDER BY created_at_epoch ASC
    `).all(e)}getSummaryForSession(e){return this.db.prepare(`
      SELECT
        request, investigated, learned, completed, next_steps,
        files_read, files_edited, notes, prompt_number, created_at
      FROM session_summaries
      WHERE sdk_session_id = ?
      ORDER BY created_at_epoch DESC
      LIMIT 1
    `).get(e)||null}getSessionById(e){return this.db.prepare(`
      SELECT id, sdk_session_id, project, user_prompt
      FROM sdk_sessions
      WHERE id = ?
      LIMIT 1
    `).get(e)||null}findActiveSDKSession(e){return this.db.prepare(`
      SELECT id, sdk_session_id, project, worker_port
      FROM sdk_sessions
      WHERE claude_session_id = ? AND status = 'active'
      LIMIT 1
    `).get(e)||null}findAnySDKSession(e){return this.db.prepare(`
      SELECT id
      FROM sdk_sessions
      WHERE claude_session_id = ?
      LIMIT 1
    `).get(e)||null}reactivateSession(e,t){this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'active', user_prompt = ?, worker_port = NULL
      WHERE id = ?
    `).run(t,e)}incrementPromptCounter(e){return this.db.prepare(`
      UPDATE sdk_sessions
      SET prompt_counter = COALESCE(prompt_counter, 0) + 1
      WHERE id = ?
    `).run(e),this.db.prepare(`
      SELECT prompt_counter FROM sdk_sessions WHERE id = ?
    `).get(e)?.prompt_counter||1}getPromptCounter(e){return this.db.prepare(`
      SELECT prompt_counter FROM sdk_sessions WHERE id = ?
    `).get(e)?.prompt_counter||0}createSDKSession(e,t,s){let r=new Date,n=r.getTime();return this.db.prepare(`
      INSERT INTO sdk_sessions
      (claude_session_id, project, user_prompt, started_at, started_at_epoch, status)
      VALUES (?, ?, ?, ?, ?, 'active')
    `).run(e,t,s,r.toISOString(),n).lastInsertRowid}updateSDKSessionId(e,t){return this.db.prepare(`
      UPDATE sdk_sessions
      SET sdk_session_id = ?
      WHERE id = ? AND sdk_session_id IS NULL
    `).run(t,e).changes===0?(rl.debug("DB","sdk_session_id already set, skipping update",{sessionId:e,sdkSessionId:t}),!1):!0}setWorkerPort(e,t){this.db.prepare(`
      UPDATE sdk_sessions
      SET worker_port = ?
      WHERE id = ?
    `).run(t,e)}getWorkerPort(e){return this.db.prepare(`
      SELECT worker_port
      FROM sdk_sessions
      WHERE id = ?
      LIMIT 1
    `).get(e)?.worker_port||null}storeObservation(e,t,s,r){let n=new Date,o=n.getTime();this.db.prepare(`
      INSERT INTO observations
      (sdk_session_id, project, type, title, subtitle, facts, narrative, concepts,
       files_read, files_modified, prompt_number, created_at, created_at_epoch)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `).run(e,t,s.type,s.title,s.subtitle,JSON.stringify(s.facts),s.narrative,JSON.stringify(s.concepts),JSON.stringify(s.files_read),JSON.stringify(s.files_modified),r||null,n.toISOString(),o)}storeSummary(e,t,s,r){let n=new Date,o=n.getTime();this.db.prepare(`
      INSERT INTO session_summaries
      (sdk_session_id, project, request, investigated, learned, completed,
       next_steps, notes, prompt_number, created_at, created_at_epoch)
      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    `).run(e,t,s.request,s.investigated,s.learned,s.completed,s.next_steps,s.notes,r||null,n.toISOString(),o)}markSessionCompleted(e){let t=new Date,s=t.getTime();this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'completed', completed_at = ?, completed_at_epoch = ?
      WHERE id = ?
    `).run(t.toISOString(),s,e)}markSessionFailed(e){let t=new Date,s=t.getTime();this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'failed', completed_at = ?, completed_at_epoch = ?
      WHERE id = ?
    `).run(t.toISOString(),s,e)}cleanupOrphanedSessions(){let e=new Date,t=e.getTime();return this.db.prepare(`
      UPDATE sdk_sessions
      SET status = 'failed', completed_at = ?, completed_at_epoch = ?
      WHERE status = 'active'
    `).run(e.toISOString(),t).changes}close(){this.db.close()}};var Wr,Ra;try{Wr=new Sa,Ra=new xa}catch(a){console.error("[search-server] Failed to initialize search:",a.message),process.exit(1)}function ft(){return`
---
\u{1F4A1} Search Tips:
\u2022 To see full details: Add format: "full" to your search
\u2022 To narrow results: Use filters like type, dateRange, concepts, or files
\u2022 To search by concept: Use find_by_concept tool
\u2022 To browse by type: Use find_by_type with ["decision", "feature", etc.]
\u2022 To sort by date: Use orderBy: "date_desc" or "date_asc"`}function It(a,e){let t=a.title||`Observation #${a.id}`,s=new Date(a.created_at_epoch).toLocaleString(),r=a.type?`[${a.type}]`:"";return`${e+1}. ${r} ${t}
   Date: ${s}
   Source: claude-mem://observation/${a.id}`}function Ps(a,e){let t=a.request||`Session ${a.sdk_session_id.substring(0,8)}`,s=new Date(a.created_at_epoch).toLocaleString();return`${e+1}. ${t}
   Date: ${s}
   Source: claude-mem://session/${a.sdk_session_id}`}function At(a,e){let t=a.title||`Observation #${a.id}`,s=[];s.push(`## ${t}`),s.push(`*Source: claude-mem://observation/${a.id}*`),s.push(""),a.subtitle&&(s.push(`**${a.subtitle}**`),s.push("")),a.narrative&&(s.push(a.narrative),s.push("")),a.text&&(s.push(a.text),s.push(""));let r=[];if(r.push(`Type: ${a.type}`),a.facts)try{let o=JSON.parse(a.facts);o.length>0&&r.push(`Facts: ${o.join("; ")}`)}catch{}if(a.concepts)try{let o=JSON.parse(a.concepts);o.length>0&&r.push(`Concepts: ${o.join(", ")}`)}catch{}if(a.files_read||a.files_modified){let o=[];if(a.files_read)try{o.push(...JSON.parse(a.files_read))}catch{}if(a.files_modified)try{o.push(...JSON.parse(a.files_modified))}catch{}o.length>0&&r.push(`Files: ${[...new Set(o)].join(", ")}`)}r.length>0&&(s.push("---"),s.push(r.join(" | ")));let n=new Date(a.created_at_epoch).toLocaleString();return s.push(""),s.push("---"),s.push(`Date: ${n}`),s.join(`
`)}function Ts(a,e){let t=a.request||`Session ${a.sdk_session_id.substring(0,8)}`,s=[];s.push(`## ${t}`),s.push(`*Source: claude-mem://session/${a.sdk_session_id}*`),s.push(""),a.completed&&(s.push(`**Completed:** ${a.completed}`),s.push("")),a.learned&&(s.push(`**Learned:** ${a.learned}`),s.push("")),a.investigated&&(s.push(`**Investigated:** ${a.investigated}`),s.push("")),a.next_steps&&(s.push(`**Next Steps:** ${a.next_steps}`),s.push("")),a.notes&&(s.push(`**Notes:** ${a.notes}`),s.push(""));let r=[];if(a.files_read||a.files_edited){let o=[];if(a.files_read)try{o.push(...JSON.parse(a.files_read))}catch{}if(a.files_edited)try{o.push(...JSON.parse(a.files_edited))}catch{}o.length>0&&r.push(`Files: ${[...new Set(o)].join(", ")}`)}let n=new Date(a.created_at_epoch).toLocaleDateString();return r.push(`Date: ${n}`),r.length>0&&(s.push("---"),s.push(r.join(" | "))),s.join(`
`)}var tl=i.object({project:i.string().optional().describe("Filter by project name"),type:i.union([i.enum(["decision","bugfix","feature","refactor","discovery","change"]),i.array(i.enum(["decision","bugfix","feature","refactor","discovery","change"]))]).optional().describe("Filter by observation type"),concepts:i.union([i.string(),i.array(i.string())]).optional().describe("Filter by concept tags"),files:i.union([i.string(),i.array(i.string())]).optional().describe("Filter by file paths (partial match)"),dateRange:i.object({start:i.union([i.string(),i.number()]).optional().describe("Start date (ISO string or epoch)"),end:i.union([i.string(),i.number()]).optional().describe("End date (ISO string or epoch)")}).optional().describe("Filter by date range"),limit:i.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:i.number().min(0).default(0).describe("Number of results to skip"),orderBy:i.enum(["relevance","date_desc","date_asc"]).default("relevance").describe("Sort order")}),al=[{name:"search_observations",description:"Search observations using full-text search across titles, narratives, facts, and concepts",inputSchema:i.object({query:i.string().describe("Search query for FTS5 full-text search"),format:i.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default), "full" for complete details'),...tl.shape}),handler:async a=>{try{let{query:e,format:t="index",...s}=a,r=Wr.searchObservations(e,s);if(r.length===0)return{content:[{type:"text",text:`No observations found matching "${e}"`}]};let n;if(t==="index"){let o=`Found ${r.length} observation(s) matching "${e}":

`,l=r.map((c,u)=>It(c,u));n=o+l.join(`

`)+ft()}else n=r.map((l,c)=>At(l,c)).join(`

---

`);return{content:[{type:"text",text:n}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"search_sessions",description:"Search session summaries using full-text search across requests, completions, learnings, and notes",inputSchema:i.object({query:i.string().describe("Search query for FTS5 full-text search"),format:i.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default), "full" for complete details'),project:i.string().optional().describe("Filter by project name"),dateRange:i.object({start:i.union([i.string(),i.number()]).optional(),end:i.union([i.string(),i.number()]).optional()}).optional().describe("Filter by date range"),limit:i.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:i.number().min(0).default(0).describe("Number of results to skip"),orderBy:i.enum(["relevance","date_desc","date_asc"]).default("relevance").describe("Sort order")}),handler:async a=>{try{let{query:e,format:t="index",...s}=a,r=Wr.searchSessions(e,s);if(r.length===0)return{content:[{type:"text",text:`No sessions found matching "${e}"`}]};let n;if(t==="index"){let o=`Found ${r.length} session(s) matching "${e}":

`,l=r.map((c,u)=>Ps(c,u));n=o+l.join(`

`)+ft()}else n=r.map((l,c)=>Ts(l,c)).join(`

---

`);return{content:[{type:"text",text:n}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"find_by_concept",description:"Find observations tagged with a specific concept",inputSchema:i.object({concept:i.string().describe("Concept tag to search for"),format:i.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default), "full" for complete details'),project:i.string().optional().describe("Filter by project name"),dateRange:i.object({start:i.union([i.string(),i.number()]).optional(),end:i.union([i.string(),i.number()]).optional()}).optional().describe("Filter by date range"),limit:i.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:i.number().min(0).default(0).describe("Number of results to skip"),orderBy:i.enum(["relevance","date_desc","date_asc"]).default("date_desc").describe("Sort order")}),handler:async a=>{try{let{concept:e,format:t="index",...s}=a,r=Wr.findByConcept(e,s);if(r.length===0)return{content:[{type:"text",text:`No observations found with concept "${e}"`}]};let n;if(t==="index"){let o=`Found ${r.length} observation(s) with concept "${e}":

`,l=r.map((c,u)=>It(c,u));n=o+l.join(`

`)+ft()}else n=r.map((l,c)=>At(l,c)).join(`

---

`);return{content:[{type:"text",text:n}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"find_by_file",description:"Find observations and sessions that reference a specific file path",inputSchema:i.object({filePath:i.string().describe("File path to search for (supports partial matching)"),format:i.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default), "full" for complete details'),project:i.string().optional().describe("Filter by project name"),dateRange:i.object({start:i.union([i.string(),i.number()]).optional(),end:i.union([i.string(),i.number()]).optional()}).optional().describe("Filter by date range"),limit:i.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:i.number().min(0).default(0).describe("Number of results to skip"),orderBy:i.enum(["relevance","date_desc","date_asc"]).default("date_desc").describe("Sort order")}),handler:async a=>{try{let{filePath:e,format:t="index",...s}=a,r=Wr.findByFile(e,s),n=r.observations.length+r.sessions.length;if(n===0)return{content:[{type:"text",text:`No results found for file "${e}"`}]};let o;if(t==="index"){let l=`Found ${n} result(s) for file "${e}":

`,c=[];r.observations.forEach((u,p)=>{c.push(It(u,p))}),r.sessions.forEach((u,p)=>{c.push(Ps(u,p+r.observations.length))}),o=l+c.join(`

`)+ft()}else{let l=[];r.observations.forEach((c,u)=>{l.push(At(c,u))}),r.sessions.forEach((c,u)=>{l.push(Ts(c,u+r.observations.length))}),o=l.join(`

---

`)}return{content:[{type:"text",text:o}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"find_by_type",description:"Find observations of a specific type (decision, bugfix, feature, refactor, discovery, change)",inputSchema:i.object({type:i.union([i.enum(["decision","bugfix","feature","refactor","discovery","change"]),i.array(i.enum(["decision","bugfix","feature","refactor","discovery","change"]))]).describe("Observation type(s) to filter by"),format:i.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default), "full" for complete details'),project:i.string().optional().describe("Filter by project name"),dateRange:i.object({start:i.union([i.string(),i.number()]).optional(),end:i.union([i.string(),i.number()]).optional()}).optional().describe("Filter by date range"),limit:i.number().min(1).max(100).default(20).describe("Maximum number of results"),offset:i.number().min(0).default(0).describe("Number of results to skip"),orderBy:i.enum(["relevance","date_desc","date_asc"]).default("date_desc").describe("Sort order")}),handler:async a=>{try{let{type:e,format:t="index",...s}=a,r=Wr.findByType(e,s);if(r.length===0)return{content:[{type:"text",text:`No observations found with type "${Array.isArray(e)?e.join(", "):e}"`}]};let n=Array.isArray(e)?e.join(", "):e,o;if(t==="index"){let l=`Found ${r.length} observation(s) with type "${n}":

`,c=r.map((u,p)=>It(u,p));o=l+c.join(`

`)+ft()}else o=r.map((c,u)=>At(c,u)).join(`

---

`);return{content:[{type:"text",text:o}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}},{name:"get_recent_context",description:"Get recent session context including summaries and observations for a project",inputSchema:i.object({project:i.string().optional().describe("Project name (defaults to current working directory basename)"),limit:i.number().min(1).max(10).default(3).describe("Number of recent sessions to retrieve")}),handler:async a=>{try{let e=a.project||Nf(process.cwd()),t=a.limit||3,s=Ra.getRecentSessionsWithStatus(e,t);if(s.length===0)return{content:[{type:"text",text:`# Recent Session Context

No previous sessions found for project "${e}".`}]};let r=[];r.push("# Recent Session Context"),r.push(""),r.push(`Showing last ${s.length} session(s) for **${e}**:`),r.push("");for(let n of s)if(n.sdk_session_id){if(r.push("---"),r.push(""),n.has_summary){let o=Ra.getSummaryForSession(n.sdk_session_id);if(o){let l=o.prompt_number?` (Prompt #${o.prompt_number})`:"";if(r.push(`**Summary${l}**`),r.push(""),o.request&&r.push(`**Request:** ${o.request}`),o.completed&&r.push(`**Completed:** ${o.completed}`),o.learned&&r.push(`**Learned:** ${o.learned}`),o.next_steps&&r.push(`**Next Steps:** ${o.next_steps}`),o.files_read)try{let u=JSON.parse(o.files_read);Array.isArray(u)&&u.length>0&&r.push(`**Files Read:** ${u.join(", ")}`)}catch{o.files_read.trim()&&r.push(`**Files Read:** ${o.files_read}`)}if(o.files_edited)try{let u=JSON.parse(o.files_edited);Array.isArray(u)&&u.length>0&&r.push(`**Files Edited:** ${u.join(", ")}`)}catch{o.files_edited.trim()&&r.push(`**Files Edited:** ${o.files_edited}`)}let c=new Date(o.created_at).toLocaleString();r.push(`**Date:** ${c}`)}}else if(n.status==="active"){r.push("**In Progress**"),r.push(""),n.user_prompt&&r.push(`**Request:** ${n.user_prompt}`);let o=Ra.getObservationsForSession(n.sdk_session_id);if(o.length>0){r.push(""),r.push(`**Observations (${o.length}):**`);for(let c of o)r.push(`- ${c.title}`)}else r.push(""),r.push("*No observations yet*");r.push(""),r.push("**Status:** Active - summary pending");let l=new Date(n.started_at).toLocaleString();r.push(`**Date:** ${l}`)}else{r.push(`**${n.status.charAt(0).toUpperCase()+n.status.slice(1)}**`),r.push(""),n.user_prompt&&r.push(`**Request:** ${n.user_prompt}`),r.push(""),r.push(`**Status:** ${n.status} - no summary available`);let o=new Date(n.started_at).toLocaleString();r.push(`**Date:** ${o}`)}r.push("")}return{content:[{type:"text",text:r.join(`
`)}]}}catch(e){return{content:[{type:"text",text:`Failed to get recent context: ${e.message}`}],isError:!0}}}},{name:"advanced_search",description:"Advanced search combining full-text search with structured filters across both observations and sessions",inputSchema:i.object({textQuery:i.string().optional().describe("Optional text query for FTS5 search"),format:i.enum(["index","full"]).default("index").describe('Output format: "index" for titles/dates only (default), "full" for complete details'),searchSessions:i.boolean().default(!0).describe("Include session summaries in results"),...tl.shape}),handler:async a=>{try{let{format:e="index",...t}=a,s=Wr.advancedSearch(t),r=s.observations.length+s.sessions.length;if(r===0)return{content:[{type:"text",text:"No results found matching the search criteria"}]};let n;if(e==="index"){let o=`Found ${r} result(s) matching search criteria:

`,l=[];s.observations.forEach((c,u)=>{l.push(It(c,u))}),s.sessions.forEach((c,u)=>{l.push(Ps(c,u+s.observations.length))}),n=o+l.join(`

`)+ft()}else{let o=[];s.observations.forEach((l,c)=>{o.push(At(l,c))}),s.sessions.forEach((l,c)=>{o.push(Ts(l,c+s.observations.length))}),n=o.join(`

---

`)}return{content:[{type:"text",text:n}]}}catch(e){return{content:[{type:"text",text:`Search failed: ${e.message}`}],isError:!0}}}}],Os=new pa({name:"claude-mem-search",version:"1.0.0"},{capabilities:{tools:{}}});Os.setRequestHandler(Ua,async()=>({tools:al.map(a=>({name:a.name,description:a.description,inputSchema:bs(a.inputSchema)}))}));Os.setRequestHandler(za,async a=>{let e=al.find(t=>t.name===a.params.name);if(!e)throw new Error(`Unknown tool: ${a.params.name}`);try{return await e.handler(a.params.arguments||{})}catch(t){return{content:[{type:"text",text:`Tool execution failed: ${t.message}`}],isError:!0}}});async function Df(){let a=new ma;await Os.connect(a),console.error("[search-server] Claude-mem search server started")}Df().catch(a=>{console.error("[search-server] Fatal error:",a),process.exit(1)});
/*! Bundled license information:

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)
*/
